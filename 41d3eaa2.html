<!DOCTYPE html><html lang="zh-CN"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=2"><meta name="theme-color" content="#222"><meta name="generator" content="Hexo 5.1.1"><link rel="apple-touch-icon" sizes="180x180" href="/images/56x56logo.png"><link rel="icon" type="image/png" sizes="32x32" href="/images/56x56logo.png"><link rel="icon" type="image/png" sizes="16x16" href="/favicon.ico"><link rel="mask-icon" href="/images/400x400logo.png" color="#222"><meta http-equiv="Cache-Control" content="no-transform"><meta http-equiv="Cache-Control" content="no-siteapp"><link rel="stylesheet" href="/css/main.css"><link rel="stylesheet" href="//cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.14.0/css/all.min.css"><link rel="stylesheet" href="//cdn.jsdelivr.net/npm/animate.css@3.1.1/animate.min.css"><script class="hexo-configurations">var NexT=window.NexT||{},CONFIG={hostname:"www.diandian100.cn",root:"/",scheme:"Gemini",version:"8.0.0",exturl:!0,sidebar:{position:"left",display:"always",padding:18,offset:12},copycode:!0,bookmark:{enable:!1,color:"#222",save:"auto"},fancybox:!1,mediumzoom:!0,lazyload:!0,pangu:!1,comments:{style:"tabs",active:null,storage:!0,lazyload:!1,nav:null},motion:{enable:!0,async:!1,transition:{post_block:"fadeIn",post_header:"fadeInDown",post_body:"fadeInDown",coll_header:"fadeInLeft",sidebar:"fadeInUp"}},prism:!1,i18n:{placeholder:"搜索...",empty:"没有找到任何搜索结果：${query}",hits_time:"找到 ${hits} 个搜索结果（用时 ${time} 毫秒）",hits:"找到 ${hits} 个搜索结果"},path:"search.xml",localsearch:{enable:!0,trigger:"auto",top_n_per_article:1,unescape:!1,preload:!1}}</script><meta name="description" content="会话（Session）跟踪是Web程序中常用的技术，用来跟踪用户的整个会话。常用的会话跟踪技术是Cookie与Session。Cookie通过在客户端记录信息确定用户身份，Session通过在服务器端记录信息确定用户身份。"><meta property="og:type" content="article"><meta property="og:title" content="Django之cookie与session组件"><meta property="og:url" content="https://www.diandian100.cn/41d3eaa2.html"><meta property="og:site_name" content="点点开发技术分享"><meta property="og:description" content="会话（Session）跟踪是Web程序中常用的技术，用来跟踪用户的整个会话。常用的会话跟踪技术是Cookie与Session。Cookie通过在客户端记录信息确定用户身份，Session通过在服务器端记录信息确定用户身份。"><meta property="og:locale" content="zh_CN"><meta property="og:image" content="https://20200324picgo-1251846158.cos.ap-shanghai.myqcloud.com/img/20200426145505.png"><meta property="og:image" content="https://20200324picgo-1251846158.cos.ap-shanghai.myqcloud.com/img/20200426150056.png"><meta property="article:published_time" content="2020-04-22T06:05:10.000Z"><meta property="article:modified_time" content="2020-09-04T01:00:24.000Z"><meta property="article:author" content="托小尼"><meta property="article:tag" content="Django之cookie与session组件"><meta property="article:tag" content="Django cookie"><meta property="article:tag" content="Django session"><meta property="article:tag" content="会话"><meta property="article:tag" content="会话跟踪"><meta property="article:tag" content="会话基数"><meta property="article:tag" content="cookie"><meta property="article:tag" content="session"><meta property="article:tag" content="set_cookie"><meta property="article:tag" content="delete_cookie"><meta property="article:tag" content="设置cookie"><meta property="article:tag" content="删除cookie"><meta property="article:tag" content="设置session"><meta property="article:tag" content="删除session"><meta name="twitter:card" content="summary"><meta name="twitter:image" content="https://20200324picgo-1251846158.cos.ap-shanghai.myqcloud.com/img/20200426145505.png"><link rel="canonical" href="https://www.diandian100.cn/41d3eaa2.html"><script class="page-configurations">CONFIG.page={sidebar:"",isHome:!1,isPost:!0,lang:"zh-CN"}</script><title>Django之cookie与session组件 | 点点开发技术分享</title><script>var _hmt=_hmt||[];!function(){var e=document.createElement("script");e.src="https://hm.baidu.com/hm.js?3b57832214417f66931e694d19fd60b9";var t=document.getElementsByTagName("script")[0];t.parentNode.insertBefore(e,t)}()</script><noscript><style>body{margin-top:2rem}.use-motion .collection-header,.use-motion .comments,.use-motion .menu-item,.use-motion .pagination,.use-motion .post-block,.use-motion .post-body,.use-motion .post-header,.use-motion .sidebar{visibility:visible}.use-motion .footer,.use-motion .header,.use-motion .site-brand-container .toggle{opacity:initial}.use-motion .custom-logo-image,.use-motion .site-subtitle,.use-motion .site-title{opacity:initial;top:initial}.use-motion .logo-line{transform:scaleX(1)}.search-pop-overlay,.sidebar-nav{display:none}.sidebar-panel{display:block}</style></noscript></head><body itemscope itemtype="http://schema.org/WebPage" class="use-motion"><div class="headband"></div><main class="main"><header class="header" itemscope itemtype="http://schema.org/WPHeader"><div class="header-inner"><div class="site-brand-container"><div class="site-nav-toggle"><div class="toggle" aria-label="切换导航栏"><span class="toggle-line"></span> <span class="toggle-line"></span> <span class="toggle-line"></span></div></div><div class="site-meta"><a href="/" class="brand" rel="start"><i class="logo-line"></i><h1 class="site-title">点点开发技术分享</h1><i class="logo-line"></i></a><p class="site-subtitle" itemprop="description">记录个人日常开发笔记与技巧</p></div><div class="site-nav-right"><div class="toggle popup-trigger"><i class="fa fa-search fa-fw fa-lg"></i></div></div></div><nav class="site-nav"><ul class="main-menu menu"><li class="menu-item menu-item-home"><a href="/" rel="section"><i class="fa fa-home fa-fw"></i>首页</a></li><li class="menu-item menu-item-tags"><a href="/tags/" rel="section"><i class="fa fa-tags fa-fw"></i>标签</a></li><li class="menu-item menu-item-archives"><a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>归档</a></li><li class="menu-item menu-item-development"><a href="/categories/rd/" rel="section"><i class="fa fa-code fa-fw"></i>开发</a></li><li class="menu-item menu-item-frontend"><a href="/categories/fe/" rel="section"><i class="fab fa-html5 fa-fw"></i>前端</a></li><li class="menu-item menu-item-database"><a href="/categories/db/" rel="section"><i class="fa fa-database fa-fw"></i>数据库</a></li><li class="menu-item menu-item-os"><a href="/categories/os/" rel="section"><i class="fab fa-linux fa-fw"></i>系统</a></li><li class="menu-item menu-item-other"><a href="/categories/other/" rel="section"><i class="far fa-paper-plane fa-fw"></i>其他</a></li><li class="menu-item menu-item-search"><a role="button" class="popup-trigger"><i class="fa fa-search fa-fw"></i>搜索</a></li></ul></nav><div class="search-pop-overlay"><div class="popup search-popup"><div class="search-header"><span class="search-icon"><i class="fa fa-search"></i></span><div class="search-input-container"><input autocomplete="off" autocapitalize="off" maxlength="80" placeholder="搜索..." spellcheck="false" type="search" class="search-input"></div><span class="popup-btn-close"><i class="fa fa-times-circle"></i></span></div><div class="search-result-container no-result"><div class="search-result-icon"><i class="fa fa-spinner fa-pulse fa-5x"></i></div></div></div></div></div><div class="toggle sidebar-toggle"><span class="toggle-line"></span> <span class="toggle-line"></span> <span class="toggle-line"></span></div><aside class="sidebar"><div class="sidebar-inner sidebar-nav-active sidebar-toc-active"><ul class="sidebar-nav"><li class="sidebar-nav-toc">文章目录</li><li class="sidebar-nav-overview">站点概览</li></ul><section class="post-toc-wrap sidebar-panel"><div class="post-toc animated"><ol class="nav"><li class="nav-item nav-level-2"><a class="nav-link" href="#%E4%BC%9A%E8%AF%9D%E8%B7%9F%E8%B8%AA%E6%8A%80%E6%9C%AF"><span class="nav-number">1.</span> <span class="nav-text">会话跟踪技术</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#1-%E4%BB%80%E4%B9%88%E6%98%AF%E4%BC%9A%E8%AF%9D%E8%B7%9F%E8%B8%AA%E6%8A%80%E6%9C%AF"><span class="nav-number">1.1.</span> <span class="nav-text">1 什么是会话跟踪技术</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#2-%E4%BC%9A%E8%AF%9D%E8%B7%AF%E5%BE%84%E6%8A%80%E6%9C%AF%E4%BD%BF%E7%94%A8Cookie%E6%88%96session%E5%AE%8C%E6%88%90"><span class="nav-number">1.2.</span> <span class="nav-text">2 会话路径技术使用Cookie或session完成</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Cookie"><span class="nav-number">2.</span> <span class="nav-text">Cookie</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E4%BB%80%E4%B9%88%E5%8F%ABCookie"><span class="nav-number">2.1.</span> <span class="nav-text">什么叫Cookie</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Cookie%E8%A7%84%E8%8C%83"><span class="nav-number">2.2.</span> <span class="nav-text">Cookie规范</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Cookie%E4%B8%8EHTTP%E5%A4%B4"><span class="nav-number">2.3.</span> <span class="nav-text">Cookie与HTTP头</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Cookie%E7%9A%84%E8%A6%86%E7%9B%96"><span class="nav-number">2.4.</span> <span class="nav-text">Cookie的覆盖</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#django%E4%B8%AD%E7%9A%84cookie%E8%AF%AD%E6%B3%95"><span class="nav-number">2.5.</span> <span class="nav-text">django中的cookie语法</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E8%AE%BE%E7%BD%AEcookie"><span class="nav-number">2.5.1.</span> <span class="nav-text">设置cookie</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E8%8E%B7%E5%8F%96cookie"><span class="nav-number">2.5.2.</span> <span class="nav-text">获取cookie</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%88%A0%E9%99%A4cookie"><span class="nav-number">2.5.3.</span> <span class="nav-text">删除cookie</span></a></li></ol></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#session"><span class="nav-number">3.</span> <span class="nav-text">session</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E8%AF%AD%E6%B3%95"><span class="nav-number">3.0.1.</span> <span class="nav-text">语法</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E9%85%8D%E7%BD%AE"><span class="nav-number">3.0.2.</span> <span class="nav-text">配置</span></a></li></ol></li></ol></div></section><section class="site-overview-wrap sidebar-panel"><div class="site-author animated" itemprop="author" itemscope itemtype="http://schema.org/Person"><img class="site-author-image" itemprop="image" alt="托小尼" src="/images/avatar.jpg"><p class="site-author-name" itemprop="name">托小尼</p><div class="site-description" itemprop="description"></div></div><div class="site-state-wrap animated"><nav class="site-state"><div class="site-state-item site-state-posts"><a href="/archives/"><span class="site-state-item-count">192</span> <span class="site-state-item-name">日志</span></a></div><div class="site-state-item site-state-categories"><a href="/categories/"><span class="site-state-item-count">30</span> <span class="site-state-item-name">分类</span></a></div><div class="site-state-item site-state-tags"><a href="/tags/"><span class="site-state-item-count">1195</span> <span class="site-state-item-name">标签</span></a></div></nav></div><div class="links-of-author animated"><span class="links-of-author-item"><span class="exturl" data-url="aHR0cDovL3dwYS5xcS5jb20vbXNncmQ/dj0zJnVpbj02NDY1NDc5ODkmc2l0ZT1xcSZtZW51PXllcw==" title="QQ → http:&#x2F;&#x2F;wpa.qq.com&#x2F;msgrd?v&#x3D;3&amp;uin&#x3D;646547989&amp;site&#x3D;qq&amp;menu&#x3D;yes"><i class="fab fa-qq fa-fw"></i>QQ</span> </span><span class="links-of-author-item"><span class="exturl" data-url="bWFpbHRvOnRvbnl5dUB2aXAucXEuY29t" title="E-Mail → mailto:tonyyu@vip.qq.com"><i class="fa fa-envelope fa-fw"></i>E-Mail</span></span></div></section></div></aside><div class="sidebar-dimmer"></div></header><div class="back-to-top"><i class="fa fa-arrow-up"></i> <span>0%</span></div><div class="reading-progress-bar"></div><span class="exturl github-corner" data-url="aHR0cHM6Ly9naXRodWIuY29tL3Rvbnl1MjAxOQ==" title="关注我" aria-label="关注我"><svg width="80" height="80" viewBox="0 0 250 250" aria-hidden="true"><path d="M0,0 L115,115 L130,115 L142,142 L250,250 L250,0 Z"></path><path d="M128.3,109.0 C113.8,99.7 119.0,89.6 119.0,89.6 C122.0,82.7 120.5,78.6 120.5,78.6 C119.2,72.0 123.4,76.3 123.4,76.3 C127.3,80.9 125.5,87.3 125.5,87.3 C122.9,97.6 130.6,101.9 134.4,103.2" fill="currentColor" style="transform-origin:130px 106px" class="octo-arm"></path><path d="M115.0,115.0 C114.9,115.1 118.7,116.5 119.8,115.4 L133.7,101.6 C136.9,99.2 139.9,98.4 142.2,98.6 C133.8,88.0 127.5,74.4 143.8,58.0 C148.5,53.4 154.0,51.2 159.7,51.0 C160.3,49.4 163.2,43.6 171.4,40.1 C171.4,40.1 176.1,42.5 178.8,56.2 C183.1,58.6 187.2,61.8 190.9,65.4 C194.5,69.0 197.7,73.2 200.1,77.6 C213.8,80.2 216.3,84.9 216.3,84.9 C212.7,93.1 206.9,96.0 205.4,96.6 C205.1,102.4 203.0,107.8 198.3,112.5 C181.9,128.9 168.3,122.5 157.7,114.1 C157.9,116.9 156.7,120.9 152.7,124.9 L141.0,136.5 C139.8,137.7 141.6,141.9 141.8,141.8 Z" fill="currentColor" class="octo-body"></path></svg></span><noscript><div class="noscript-warning">Theme NexT works best with JavaScript enabled</div></noscript><div class="main-inner post posts-expand"><article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN"><link itemprop="mainEntityOfPage" href="https://www.diandian100.cn/41d3eaa2.html"><span hidden itemprop="author" itemscope itemtype="http://schema.org/Person"><meta itemprop="image" content="/images/avatar.jpg"><meta itemprop="name" content="托小尼"><meta itemprop="description" content=""></span><span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization"><meta itemprop="name" content="点点开发技术分享"></span><header class="post-header"><h1 class="post-title" itemprop="name headline">Django之cookie与session组件</h1><div class="post-meta-container"><div class="post-meta"><span class="post-meta-item"><span class="post-meta-item-icon"><i class="far fa-calendar"></i> </span><span class="post-meta-item-text">发表于</span> <time title="创建时间：2020-04-22 14:05:10" itemprop="dateCreated datePublished" datetime="2020-04-22T14:05:10+08:00">2020-04-22</time> </span><span class="post-meta-item"><span class="post-meta-item-icon"><i class="far fa-calendar-check"></i> </span><span class="post-meta-item-text">更新于</span> <time title="修改时间：2020-09-04 09:00:24" itemprop="dateModified" datetime="2020-09-04T09:00:24+08:00">2020-09-04</time> </span><span class="post-meta-item"><span class="post-meta-item-icon"><i class="far fa-folder"></i> </span><span class="post-meta-item-text">分类于</span> <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/rd/" itemprop="url" rel="index"><span itemprop="name">rd</span></a> </span>， <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/rd/python/" itemprop="url" rel="index"><span itemprop="name">python</span></a> </span>， <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/rd/python/django/" itemprop="url" rel="index"><span itemprop="name">django</span></a> </span></span><span class="post-meta-item"><span class="post-meta-item-icon"><i class="far fa-comment"></i> </span><span class="post-meta-item-text">Changyan：</span> <a title="changyan" href="/41d3eaa2.html#SOHUCS" itemprop="discussionUrl"><span id="changyan_count_unit" class="post-comments-count hc-comment-count" data-xid="41d3eaa2.html" itemprop="commentCount"></span></a></span></div><div class="post-meta"><span class="post-meta-item" title="本文字数"><span class="post-meta-item-icon"><i class="far fa-file-word"></i> </span><span class="post-meta-item-text">本文字数：</span> <span>4.6k</span> </span><span class="post-meta-item" title="阅读时长"><span class="post-meta-item-icon"><i class="far fa-clock"></i> </span><span class="post-meta-item-text">阅读时长 &asymp;</span> <span>4 分钟</span></span></div></div></header><div class="post-body" itemprop="articleBody"><p>会话（Session）跟踪是Web程序中常用的技术，用来<strong>跟踪用户的整个会话</strong>。常用的会话跟踪技术是Cookie与Session。<strong>Cookie通过在客户端记录信息确定用户身份</strong>，<strong>Session通过在服务器端记录信息确定用户身份</strong>。</p><a id="more"></a><h2 id="会话跟踪技术"><a href="#会话跟踪技术" class="headerlink" title="会话跟踪技术"></a>会话跟踪技术</h2><h3 id="1-什么是会话跟踪技术"><a href="#1-什么是会话跟踪技术" class="headerlink" title="1 什么是会话跟踪技术"></a>1 什么是会话跟踪技术</h3><p>我们需要先了解一下什么是会话！可以把会话理解为客户端与服务器之间的一次会晤，在一次会晤中可能会包含多次请求和响应。例如你给10086打个电话，你就是客户端，而10086服务人员就是服务器了。从双方接通电话那一刻起，会话就开始了，到某一方挂断电话表示会话结束。在通话过程中，你会向10086发出多个请求，那么这多个请求都在一个会话中。<br>在JavaWeb中，客户向某一服务器发出第一个请求开始，会话就开始了，直到客户关闭了浏览器会话结束。</p><p>在一个会话的多个请求中共享数据，这就是会话跟踪技术。例如在一个会话中的请求如下：  请求银行主页；</p><ul><li>请求登录（请求参数是用户名和密码）；</li><li>请求转账（请求参数与转账相关的数据）；</li><li>请求信誉卡还款（请求参数与还款相关的数据）。</li></ul><p>在这上会话中当前用户信息必须在这个会话中共享的，因为登录的是张三，那么在转账和还款时一定是相对张三的转账和还款！这就说明我们必须在一个会话过程中有共享数据的能力。</p><h3 id="2-会话路径技术使用Cookie或session完成"><a href="#2-会话路径技术使用Cookie或session完成" class="headerlink" title="2 会话路径技术使用Cookie或session完成"></a>2 会话路径技术使用Cookie或session完成</h3><p>我们知道HTTP协议是无状态协议，也就是说每个请求都是独立的！无法记录前一次请求的状态。但HTTP协议中可以使用Cookie来完成会话跟踪！在Web开发中，使用session来完成会话跟踪，session底层依赖Cookie技术。</p><h2 id="Cookie"><a href="#Cookie" class="headerlink" title="Cookie"></a>Cookie</h2><h3 id="什么叫Cookie"><a href="#什么叫Cookie" class="headerlink" title="什么叫Cookie"></a>什么叫Cookie</h3><p>Cookie翻译成中文是小甜点，小饼干的意思。在HTTP中它表示服务器送给客户端浏览器的小甜点。其实Cookie是key-value结构，类似于一个python中的字典。随着服务器端的响应发送给客户端浏览器。然后客户端浏览器会把Cookie保存起来，当下一次再访问服务器时把Cookie再发送给服务器。 Cookie是由服务器创建，然后通过响应发送给客户端的一个键值对。客户端会保存Cookie，并会标注出Cookie的来源（哪个服务器的Cookie）。当客户端向服务器发出请求时会把所有这个服务器Cookie包含在请求中发送给服务器，这样服务器就可以识别客户端了！</p><p><img data-src="https://20200324picgo-1251846158.cos.ap-shanghai.myqcloud.com/img/20200426145505.png" alt="img"></p><h3 id="Cookie规范"><a href="#Cookie规范" class="headerlink" title="Cookie规范"></a>Cookie规范</h3><ul><li>Cookie大小上限为4KB；</li><li>一个服务器最多在客户端浏览器上保存20个Cookie；</li><li>一个浏览器最多保存300个Cookie；</li></ul><p>上面的数据只是HTTP的Cookie规范，但在浏览器大战的今天，一些浏览器为了打败对手，为了展现自己的能力起见，可能对Cookie规范“扩展”了一些，例如每个Cookie的大小为8KB，最多可保存500个Cookie等！但也不会出现把你硬盘占满的可能！<br>注意，不同浏览器之间是不共享Cookie的。也就是说在你使用IE访问服务器时，服务器会把Cookie发给IE，然后由IE保存起来，当你在使用FireFox访问服务器时，不可能把IE保存的Cookie发送给服务器。</p><h3 id="Cookie与HTTP头"><a href="#Cookie与HTTP头" class="headerlink" title="Cookie与HTTP头"></a>Cookie与HTTP头</h3><p>Cookie是通过HTTP请求和响应头在客户端和服务器端传递的：</p><ul><li>Cookie：请求头，客户端发送给服务器端；</li><li>格式：Cookie: a=A; b=B; c=C。即多个Cookie用分号离开；  Set-Cookie：响应头，服务器端发送给客户端；</li><li>一个Cookie对象一个Set-Cookie： Set-Cookie: a=A Set-Cookie: b=B Set-Cookie: c=C</li></ul><h3 id="Cookie的覆盖"><a href="#Cookie的覆盖" class="headerlink" title="Cookie的覆盖"></a>Cookie的覆盖</h3><p>如果服务器端发送重复的Cookie那么会覆盖原有的Cookie，例如客户端的第一个请求服务器端发送的Cookie是：Set-Cookie: a=A；第二请求服务器端发送的是：Set-Cookie: a=AA，那么客户端只留下一个Cookie，即：a=AA。</p><h3 id="django中的cookie语法"><a href="#django中的cookie语法" class="headerlink" title="django中的cookie语法"></a>django中的cookie语法</h3><h4 id="设置cookie"><a href="#设置cookie" class="headerlink" title="设置cookie"></a>设置cookie</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">rep &#x3D; HttpResponse(...) 或 rep ＝ render(request, ...) 或 rep ＝ redirect()</span><br><span class="line">  </span><br><span class="line">rep.set_cookie(key,value,...)</span><br><span class="line">rep.set_signed_cookie(key,value,salt&#x3D;&#39;加密盐&#39;,...)</span><br></pre></td></tr></table></figure><p>完整视图设置cookie：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">def hello(request):</span><br><span class="line">    print(&#39;当前连接&#39;, reverse(&quot;wechat:hello&quot;))</span><br><span class="line">    res &#x3D; HttpResponse(&#39;我是wechat应用中的hello视图&#39;)</span><br><span class="line">    res.set_cookie(&#39;visas&#39;, &#39;fff&#39;)</span><br><span class="line">    res.set_signed_cookie(&#39;haa&#39;, &#39;heihei&#39;,salt&#x3D;&#39;abc&#39;)</span><br><span class="line">    return res</span><br></pre></td></tr></table></figure><p>set_cookie参数</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">key,                 键</span><br><span class="line">value&#x3D;&#39;&#39;,            值</span><br><span class="line">max_age&#x3D;None,        超长时间；cookie需要延续的时间（以秒为单位）；如果参数是\ None&#96;&#96; ，这个cookie会延续到浏览器关闭为止。</span><br><span class="line">expires&#x3D;None,        超长时间       　　　　　　　　　　　　　　　　　　　　　　　　　　expires默认None ,cookie失效的实际日期&#x2F;时间。     　　　　　　　　　　　　　　　　　　　　　　　　　　　　</span><br><span class="line">path&#x3D;&#39;&#x2F;&#39;,           Cookie生效的路径，浏览器只会把cookie回传给带有该路径的页面，这样可以避免将；cookie传给站点中的其他的应用。；&#x2F; 表示根路径，特殊的：根路径的cookie可以被任何url的页面访问</span><br><span class="line">domain&#x3D;None,         Cookie生效的域名；你可用这个参数来构造一个跨站cookie。</span><br><span class="line">                     如， domain&#x3D;&quot;.example.com&quot;</span><br><span class="line">                     所构造的cookie对下面这些站点都是可读的：</span><br><span class="line">                     www.example.com 、 www2.example.com </span><br><span class="line">        　　　　　　　　和an.other.sub.domain.example.com 。</span><br><span class="line">                     如果该参数设置为 None ，cookie只能由设置它的站点读取。</span><br><span class="line">secure&#x3D;False,        如果设置为 True ，浏览器将通过HTTPS来回传cookie。</span><br><span class="line">httponly&#x3D;False       只能http协议传输，无法被JavaScript获取（不是绝对，底层抓包可以获取到也可以被覆盖）</span><br></pre></td></tr></table></figure><h4 id="获取cookie"><a href="#获取cookie" class="headerlink" title="获取cookie"></a>获取cookie</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">request.COOKIES</span><br></pre></td></tr></table></figure><h4 id="删除cookie"><a href="#删除cookie" class="headerlink" title="删除cookie"></a>删除cookie</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">response.delete_cookie(&quot;cookie_key&quot;,path&#x3D;&quot;&#x2F;&quot;,domain&#x3D;name)</span><br></pre></td></tr></table></figure><h2 id="session"><a href="#session" class="headerlink" title="session"></a>session</h2><p>Session是服务器端技术，利用这个技术，服务器在运行时可以 为每一个用户的浏览器创建一个其独享的session对象，由于 session为用户浏览器独享，所以用户在访问服务器的web资源时 ，可以把各自的数据放在各自的session中，当用户再去访问该服务器中的其它web资源时，其它web资源再从用户各自的session中 取出数据为用户服务。</p><p><img data-src="https://20200324picgo-1251846158.cos.ap-shanghai.myqcloud.com/img/20200426150056.png" alt="img"></p><h4 id="语法"><a href="#语法" class="headerlink" title="语法"></a>语法</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line">1、设置Sessions值</span><br><span class="line">          request.session[&#39;session_name&#39;] &#x3D;&quot;admin&quot;</span><br><span class="line">2、获取Sessions值</span><br><span class="line">          session_name &#x3D; request.session[&quot;session_name&quot;]</span><br><span class="line">3、删除Sessions值</span><br><span class="line">          del request.session[&quot;session_name&quot;]</span><br><span class="line">4、flush()</span><br><span class="line">     删除当前的会话数据并删除会话的Cookie。</span><br><span class="line">     这用于确保前面的会话数据不可以再次被用户的浏览器访问</span><br><span class="line">5、get(key, default&#x3D;None)</span><br><span class="line">  </span><br><span class="line">fav_color &#x3D; request.session.get(&#39;fav_color&#39;, &#39;red&#39;)</span><br><span class="line">  </span><br><span class="line">6、pop(key)</span><br><span class="line">  </span><br><span class="line">fav_color &#x3D; request.session.pop(&#39;fav_color&#39;)</span><br><span class="line">  </span><br><span class="line">7、keys()</span><br><span class="line">  </span><br><span class="line">8、items()</span><br><span class="line">  </span><br><span class="line">9、setdefault()</span><br><span class="line">  </span><br><span class="line">  </span><br><span class="line">10 用户session的随机字符串</span><br><span class="line">        request.session.session_key</span><br><span class="line">   </span><br><span class="line">        # 将所有Session失效日期小于当前日期的数据删除</span><br><span class="line">        request.session.clear_expired()</span><br><span class="line">   </span><br><span class="line">        # 检查 用户session的随机字符串 在数据库中是否</span><br><span class="line">        request.session.exists(&quot;session_key&quot;)</span><br><span class="line">   </span><br><span class="line">        # 删除当前用户的所有Session数据</span><br><span class="line">        request.session.delete(&quot;session_key&quot;)</span><br><span class="line">   </span><br><span class="line">        request.session.set_expiry(value)</span><br><span class="line">            * 如果value是个整数，session会在些秒数后失效。</span><br><span class="line">            * 如果value是个datatime或timedelta，session就会在这个时间后失效。</span><br><span class="line">            * 如果value是0,用户关闭浏览器session就会失效。</span><br><span class="line">            * 如果value是None,session会依赖全局session失效策略。</span><br></pre></td></tr></table></figure><h4 id="配置"><a href="#配置" class="headerlink" title="配置"></a>配置</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">Django默认支持Session，并且默认是将Session数据存储在数据库中，即：django_session 表中。</span><br><span class="line">   </span><br><span class="line">a. 配置 settings.py</span><br><span class="line">   </span><br><span class="line">    SESSION_ENGINE &#x3D; &#39;django.contrib.sessions.backends.db&#39;   # 引擎（默认）</span><br><span class="line">       </span><br><span class="line">    SESSION_COOKIE_NAME ＝ &quot;sessionid&quot;                       # Session的cookie保存在浏览器上时的key，即：sessionid＝随机字符串（默认）</span><br><span class="line">    SESSION_COOKIE_PATH ＝ &quot;&#x2F;&quot;                               # Session的cookie保存的路径（默认）</span><br><span class="line">    SESSION_COOKIE_DOMAIN &#x3D; None                             # Session的cookie保存的域名（默认）</span><br><span class="line">    SESSION_COOKIE_SECURE &#x3D; False                            # 是否Https传输cookie（默认）</span><br><span class="line">    SESSION_COOKIE_HTTPONLY &#x3D; True                           # 是否Session的cookie只支持http传输（默认）</span><br><span class="line">    SESSION_COOKIE_AGE &#x3D; 1209600                             # Session的cookie失效日期（2周）（默认）</span><br><span class="line">    SESSION_EXPIRE_AT_BROWSER_CLOSE &#x3D; False                  # 是否关闭浏览器使得Session过期（默认）</span><br><span class="line">    SESSION_SAVE_EVERY_REQUEST &#x3D; False                       # 是否每次请求都保存Session，默认修改之后才保存（默认）</span><br></pre></td></tr></table></figure></div><footer class="post-footer"><div class="reward-container"><div>打赏个鸡腿</div><button onclick='document.querySelector(".post-reward").classList.toggle("active")'>赞赏</button><div class="post-reward"><div><img src="/images/wechatpay.jpg" alt="托小尼 微信"> <span>微信</span></div><div><img src="/images/alipay.jpg" alt="托小尼 支付宝"> <span>支付宝</span></div></div></div><div class="post-tags"><a href="/tags/Django%E4%B9%8Bcookie%E4%B8%8Esession%E7%BB%84%E4%BB%B6/" rel="tag"><i class="fa fa-tag"></i> Django之cookie与session组件</a> <a href="/tags/Django-cookie/" rel="tag"><i class="fa fa-tag"></i> Django cookie</a> <a href="/tags/Django-session/" rel="tag"><i class="fa fa-tag"></i> Django session</a> <a href="/tags/%E4%BC%9A%E8%AF%9D/" rel="tag"><i class="fa fa-tag"></i> 会话</a> <a href="/tags/%E4%BC%9A%E8%AF%9D%E8%B7%9F%E8%B8%AA/" rel="tag"><i class="fa fa-tag"></i> 会话跟踪</a> <a href="/tags/%E4%BC%9A%E8%AF%9D%E5%9F%BA%E6%95%B0/" rel="tag"><i class="fa fa-tag"></i> 会话基数</a> <a href="/tags/cookie/" rel="tag"><i class="fa fa-tag"></i> cookie</a> <a href="/tags/session/" rel="tag"><i class="fa fa-tag"></i> session</a> <a href="/tags/set-cookie/" rel="tag"><i class="fa fa-tag"></i> set_cookie</a> <a href="/tags/delete-cookie/" rel="tag"><i class="fa fa-tag"></i> delete_cookie</a> <a href="/tags/%E8%AE%BE%E7%BD%AEcookie/" rel="tag"><i class="fa fa-tag"></i> 设置cookie</a> <a href="/tags/%E5%88%A0%E9%99%A4cookie/" rel="tag"><i class="fa fa-tag"></i> 删除cookie</a> <a href="/tags/%E8%AE%BE%E7%BD%AEsession/" rel="tag"><i class="fa fa-tag"></i> 设置session</a> <a href="/tags/%E5%88%A0%E9%99%A4session/" rel="tag"><i class="fa fa-tag"></i> 删除session</a></div><div class="post-nav"><div class="post-nav-item"><a href="/f8dd282d.html" rel="prev" title="Django之forms组件"><i class="fa fa-chevron-left"></i> Django之forms组件</a></div><div class="post-nav-item"><a href="/e2ebcce3.html" rel="next" title="Django之中间件组件">Django之中间件组件 <i class="fa fa-chevron-right"></i></a></div></div></footer></article><div class="comments"><div id="SOHUCS"></div></div><script>window.addEventListener('tabs:register', () => {
    let { activeClass } = CONFIG.comments;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      const activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      const commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }</script></div></main><footer class="footer"><div class="footer-inner"><div class="beian"><span class="exturl" data-url="aHR0cHM6Ly9iZWlhbi5taWl0Lmdvdi5jbg==">豫ICP备17028303号-1 </span><img src="http://www.beian.gov.cn/portal/download" style="display:inline-block"><span class="exturl" data-url="aHR0cDovL3d3dy5iZWlhbi5nb3YuY24vcG9ydGFsL3JlZ2lzdGVyU3lzdGVtSW5mbz9yZWNvcmRjb2RlPTE3MDI4MzAz">豫公网安备 41102402000095号</span></div><div class="copyright">&copy; <span itemprop="copyrightYear">2020</span> <span class="with-love"><i class="fa fa-user"></i> </span><span class="author" itemprop="copyrightHolder">Tony Yu</span></div><div class="wordcount"><span class="post-meta-item"><span class="post-meta-item-icon"><i class="fa fa-chart-line"></i> </span><span title="站点总字数">1.2m</span> </span><span class="post-meta-item"><span class="post-meta-item-icon"><i class="fa fa-coffee"></i> </span><span title="站点阅读时长">17:49</span></span></div></div></footer><script src="//cdn.jsdelivr.net/npm/animejs@3.2.0/lib/anime.min.js"></script><script src="//cdn.jsdelivr.net/npm/medium-zoom@1.0.6/dist/medium-zoom.min.js"></script><script src="//cdn.jsdelivr.net/npm/lozad@1.15.0/dist/lozad.min.js"></script><script src="/js/utils.js"></script><script src="/js/motion.js"></script><script src="/js/next-boot.js"></script><script src="/js/local-search.js"></script><script>NexT.utils.loadComments('#SOHUCS', () => {
    NexT.utils.getScript('https://changyan.sohu.com/upload/changyan.js', () => {
      window.changyan.api.config({
        appid: 'cyu11Umgd',
        conf : '0f296687f6a61e82028fd7c6ddf32ab9'
      });
    });
  });</script><script src="https://assets.changyan.sohu.com/upload/plugins/plugins.count.js"></script></body></html>