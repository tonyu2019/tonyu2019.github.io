<!DOCTYPE html><html lang="zh-CN"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=2"><meta name="theme-color" content="#222"><meta name="generator" content="Hexo 5.1.1"><link rel="apple-touch-icon" sizes="180x180" href="/images/56x56logo.png"><link rel="icon" type="image/png" sizes="32x32" href="/images/56x56logo.png"><link rel="icon" type="image/png" sizes="16x16" href="/favicon.ico"><link rel="mask-icon" href="/images/400x400logo.png" color="#222"><meta http-equiv="Cache-Control" content="no-transform"><meta http-equiv="Cache-Control" content="no-siteapp"><link rel="stylesheet" href="/css/main.css"><link rel="stylesheet" href="//cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.14.0/css/all.min.css"><link rel="stylesheet" href="//cdn.jsdelivr.net/npm/animate.css@3.1.1/animate.min.css"><script class="hexo-configurations">var NexT=window.NexT||{},CONFIG={hostname:"www.diandian100.cn",root:"/",scheme:"Gemini",version:"8.0.0",exturl:!0,sidebar:{position:"left",display:"always",padding:18,offset:12},copycode:!0,bookmark:{enable:!1,color:"#222",save:"auto"},fancybox:!1,mediumzoom:!0,lazyload:!0,pangu:!1,comments:{style:"tabs",active:null,storage:!0,lazyload:!1,nav:null},motion:{enable:!0,async:!1,transition:{post_block:"fadeIn",post_header:"fadeInDown",post_body:"fadeInDown",coll_header:"fadeInLeft",sidebar:"fadeInUp"}},prism:!1,i18n:{placeholder:"搜索...",empty:"没有找到任何搜索结果：${query}",hits_time:"找到 ${hits} 个搜索结果（用时 ${time} 毫秒）",hits:"找到 ${hits} 个搜索结果"},path:"search.xml",localsearch:{enable:!0,trigger:"auto",top_n_per_article:1,unescape:!1,preload:!1}}</script><meta name="description" content="pandas 是基于NumPy 的一种工具，该工具是为了解决数据分析任务而创建的。Pandas 纳入了大量库和一些标准的数据模型，提供了高效地操作大型数据集所需的工具。pandas提供了大量能使我们快速便捷地处理数据的函数和方法。你很快就会发现，它是使Python成为强大而高效的数据分析环境的重要因素之一。"><meta property="og:type" content="article"><meta property="og:title" content="python数据分析之第三方模块Pandas"><meta property="og:url" content="https://www.diandian100.cn/fdb2dd4a.html"><meta property="og:site_name" content="点点开发技术分享"><meta property="og:description" content="pandas 是基于NumPy 的一种工具，该工具是为了解决数据分析任务而创建的。Pandas 纳入了大量库和一些标准的数据模型，提供了高效地操作大型数据集所需的工具。pandas提供了大量能使我们快速便捷地处理数据的函数和方法。你很快就会发现，它是使Python成为强大而高效的数据分析环境的重要因素之一。"><meta property="og:locale" content="zh_CN"><meta property="article:published_time" content="2019-11-21T08:50:48.000Z"><meta property="article:modified_time" content="2020-09-04T01:00:24.000Z"><meta property="article:author" content="托小尼"><meta property="article:tag" content="python学习"><meta property="article:tag" content="数据分析"><meta property="article:tag" content="Pandas"><meta property="article:tag" content="series"><meta property="article:tag" content="dataframe"><meta property="article:tag" content="series切片"><meta property="article:tag" content="series索引"><meta property="article:tag" content="python数据分析"><meta property="article:tag" content="numpy"><meta name="twitter:card" content="summary"><link rel="canonical" href="https://www.diandian100.cn/fdb2dd4a.html"><script class="page-configurations">CONFIG.page={sidebar:"",isHome:!1,isPost:!0,lang:"zh-CN"}</script><title>python数据分析之第三方模块Pandas | 点点开发技术分享</title><script>var _hmt=_hmt||[];!function(){var e=document.createElement("script");e.src="https://hm.baidu.com/hm.js?3b57832214417f66931e694d19fd60b9";var t=document.getElementsByTagName("script")[0];t.parentNode.insertBefore(e,t)}()</script><noscript><style>body{margin-top:2rem}.use-motion .collection-header,.use-motion .comments,.use-motion .menu-item,.use-motion .pagination,.use-motion .post-block,.use-motion .post-body,.use-motion .post-header,.use-motion .sidebar{visibility:visible}.use-motion .footer,.use-motion .header,.use-motion .site-brand-container .toggle{opacity:initial}.use-motion .custom-logo-image,.use-motion .site-subtitle,.use-motion .site-title{opacity:initial;top:initial}.use-motion .logo-line{transform:scaleX(1)}.search-pop-overlay,.sidebar-nav{display:none}.sidebar-panel{display:block}</style></noscript></head><body itemscope itemtype="http://schema.org/WebPage" class="use-motion"><div class="headband"></div><main class="main"><header class="header" itemscope itemtype="http://schema.org/WPHeader"><div class="header-inner"><div class="site-brand-container"><div class="site-nav-toggle"><div class="toggle" aria-label="切换导航栏"><span class="toggle-line"></span> <span class="toggle-line"></span> <span class="toggle-line"></span></div></div><div class="site-meta"><a href="/" class="brand" rel="start"><i class="logo-line"></i><h1 class="site-title">点点开发技术分享</h1><i class="logo-line"></i></a><p class="site-subtitle" itemprop="description">记录个人日常开发笔记与技巧</p></div><div class="site-nav-right"><div class="toggle popup-trigger"><i class="fa fa-search fa-fw fa-lg"></i></div></div></div><nav class="site-nav"><ul class="main-menu menu"><li class="menu-item menu-item-home"><a href="/" rel="section"><i class="fa fa-home fa-fw"></i>首页</a></li><li class="menu-item menu-item-tags"><a href="/tags/" rel="section"><i class="fa fa-tags fa-fw"></i>标签</a></li><li class="menu-item menu-item-archives"><a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>归档</a></li><li class="menu-item menu-item-development"><a href="/categories/rd/" rel="section"><i class="fa fa-code fa-fw"></i>开发</a></li><li class="menu-item menu-item-frontend"><a href="/categories/fe/" rel="section"><i class="fab fa-html5 fa-fw"></i>前端</a></li><li class="menu-item menu-item-database"><a href="/categories/db/" rel="section"><i class="fa fa-database fa-fw"></i>数据库</a></li><li class="menu-item menu-item-os"><a href="/categories/os/" rel="section"><i class="fab fa-linux fa-fw"></i>系统</a></li><li class="menu-item menu-item-other"><a href="/categories/other/" rel="section"><i class="far fa-paper-plane fa-fw"></i>其他</a></li><li class="menu-item menu-item-search"><a role="button" class="popup-trigger"><i class="fa fa-search fa-fw"></i>搜索</a></li></ul></nav><div class="search-pop-overlay"><div class="popup search-popup"><div class="search-header"><span class="search-icon"><i class="fa fa-search"></i></span><div class="search-input-container"><input autocomplete="off" autocapitalize="off" maxlength="80" placeholder="搜索..." spellcheck="false" type="search" class="search-input"></div><span class="popup-btn-close"><i class="fa fa-times-circle"></i></span></div><div class="search-result-container no-result"><div class="search-result-icon"><i class="fa fa-spinner fa-pulse fa-5x"></i></div></div></div></div></div><div class="toggle sidebar-toggle"><span class="toggle-line"></span> <span class="toggle-line"></span> <span class="toggle-line"></span></div><aside class="sidebar"><div class="sidebar-inner sidebar-nav-active sidebar-toc-active"><ul class="sidebar-nav"><li class="sidebar-nav-toc">文章目录</li><li class="sidebar-nav-overview">站点概览</li></ul><section class="post-toc-wrap sidebar-panel"><div class="post-toc animated"><ol class="nav"><li class="nav-item nav-level-2"><a class="nav-link" href="#Series"><span class="nav-number">1.</span> <span class="nav-text">Series</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#Series%E5%88%9B%E5%BB%BA"><span class="nav-number">1.1.</span> <span class="nav-text">Series创建</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%88%97%E8%A1%A8%E5%88%9B%E5%BB%BA"><span class="nav-number">1.1.1.</span> <span class="nav-text">列表创建</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#numpy%E5%88%9B%E5%BB%BA"><span class="nav-number">1.1.2.</span> <span class="nav-text">numpy创建</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%AD%97%E5%85%B8%E5%88%9B%E5%BB%BA"><span class="nav-number">1.1.3.</span> <span class="nav-text">字典创建</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Series%E7%B4%A2%E5%BC%95"><span class="nav-number">1.2.</span> <span class="nav-text">Series索引</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%98%BE%E5%BC%8F%E7%B4%A2%E5%BC%95"><span class="nav-number">1.2.1.</span> <span class="nav-text">显式索引</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E9%9A%90%E5%BC%8F%E7%B4%A2%E5%BC%95"><span class="nav-number">1.2.2.</span> <span class="nav-text">隐式索引</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Series%E5%88%87%E7%89%87"><span class="nav-number">1.3.</span> <span class="nav-text">Series切片</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%98%BE%E5%BC%8F%E7%B4%A2%E5%BC%95%E5%88%87%E7%89%87"><span class="nav-number">1.3.1.</span> <span class="nav-text">显式索引切片</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E9%9A%90%E5%BC%8F%E7%B4%A2%E5%BC%95%E5%88%87%E7%89%87"><span class="nav-number">1.3.2.</span> <span class="nav-text">隐式索引切片</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Series%E5%B1%9E%E6%80%A7%E5%8F%8A%E5%9F%BA%E6%9C%AC%E4%BD%BF%E7%94%A8"><span class="nav-number">1.4.</span> <span class="nav-text">Series属性及基本使用</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E7%B4%A2%E5%BC%95"><span class="nav-number">1.4.1.</span> <span class="nav-text">索引</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%80%BC"><span class="nav-number">1.4.2.</span> <span class="nav-text">值</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#head-n"><span class="nav-number">1.4.3.</span> <span class="nav-text">head(n)</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#tail-n"><span class="nav-number">1.4.4.</span> <span class="nav-text">tail(n)</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#unique"><span class="nav-number">1.4.5.</span> <span class="nav-text">unique()</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Series%E8%BF%90%E7%AE%97"><span class="nav-number">1.4.6.</span> <span class="nav-text">Series运算</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#%E6%95%B0%E5%AD%97%E8%BF%90%E7%AE%97"><span class="nav-number">1.4.6.1.</span> <span class="nav-text">数字运算</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#%E8%AE%A1%E7%AE%97%E5%87%BD%E6%95%B0%E8%BF%90%E7%AE%97"><span class="nav-number">1.4.6.2.</span> <span class="nav-text">计算函数运算</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#%E5%A4%9A%E4%B8%AAseries%E8%BF%90%E7%AE%97"><span class="nav-number">1.4.6.3.</span> <span class="nav-text">多个series运算</span></a></li></ol></li><li class="nav-item nav-level-4"><a class="nav-link" href="#isnull"><span class="nav-number">1.4.7.</span> <span class="nav-text">isnull()</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#notnull"><span class="nav-number">1.4.8.</span> <span class="nav-text">notnull()</span></a></li></ol></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#DataFrame"><span class="nav-number">2.</span> <span class="nav-text">DataFrame</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#Dataframe%E5%88%9B%E5%BB%BA"><span class="nav-number">2.1.</span> <span class="nav-text">Dataframe创建</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E4%BD%BF%E7%94%A8ndarray"><span class="nav-number">2.1.1.</span> <span class="nav-text">使用ndarray</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%AD%97%E5%85%B8%E5%88%9B%E5%BB%BA-1"><span class="nav-number">2.1.2.</span> <span class="nav-text">字典创建</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Dataframe%E5%B1%9E%E6%80%A7"><span class="nav-number">2.2.</span> <span class="nav-text">Dataframe属性</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#values"><span class="nav-number">2.2.1.</span> <span class="nav-text">values</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#columns"><span class="nav-number">2.2.2.</span> <span class="nav-text">columns</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#index"><span class="nav-number">2.2.3.</span> <span class="nav-text">index</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#shape"><span class="nav-number">2.2.4.</span> <span class="nav-text">shape</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#DataFrame%E7%B4%A2%E5%BC%95"><span class="nav-number">2.3.</span> <span class="nav-text">DataFrame索引</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%88%97%E7%B4%A2%E5%BC%95"><span class="nav-number">2.3.1.</span> <span class="nav-text">列索引</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#%E5%AD%97%E5%85%B8%E6%96%B9%E5%BC%8F"><span class="nav-number">2.3.1.1.</span> <span class="nav-text">字典方式</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#%E5%B1%9E%E6%80%A7%E6%96%B9%E5%BC%8F"><span class="nav-number">2.3.1.2.</span> <span class="nav-text">属性方式</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#%E5%8F%96%E5%A4%9A%E5%88%97"><span class="nav-number">2.3.1.3.</span> <span class="nav-text">取多列</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#%E4%BF%AE%E6%94%B9%E5%88%97%E7%B4%A2%E5%BC%95"><span class="nav-number">2.3.1.4.</span> <span class="nav-text">修改列索引</span></a></li></ol></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E8%A1%8C%E7%B4%A2%E5%BC%95"><span class="nav-number">2.3.2.</span> <span class="nav-text">行索引</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#loc"><span class="nav-number">2.3.2.1.</span> <span class="nav-text">loc</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#iloc"><span class="nav-number">2.3.2.2.</span> <span class="nav-text">iloc</span></a></li></ol></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%85%83%E7%B4%A0%E7%B4%A2%E5%BC%95"><span class="nav-number">2.3.3.</span> <span class="nav-text">元素索引</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#loc-1"><span class="nav-number">2.3.3.1.</span> <span class="nav-text">loc</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#iloc-1"><span class="nav-number">2.3.3.2.</span> <span class="nav-text">iloc</span></a></li></ol></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#DataFrame%E5%88%87%E7%89%87"><span class="nav-number">2.4.</span> <span class="nav-text">DataFrame切片</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#%E4%B8%AD%E6%8B%AC%E5%8F%B7%E5%88%87%E7%89%87"><span class="nav-number">2.4.0.1.</span> <span class="nav-text">中括号切片</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#iloc-2"><span class="nav-number">2.4.0.2.</span> <span class="nav-text">iloc</span></a><ol class="nav-child"><li class="nav-item nav-level-6"><a class="nav-link" href="#%E5%8F%AA%E5%88%87%E8%A1%8C"><span class="nav-number">2.4.0.2.1.</span> <span class="nav-text">只切行</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#%E5%8F%AA%E5%88%87%E5%88%97"><span class="nav-number">2.4.0.2.2.</span> <span class="nav-text">只切列</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#%E5%88%87%E8%A1%8C%E5%88%87%E5%88%97"><span class="nav-number">2.4.0.2.3.</span> <span class="nav-text">切行切列</span></a></li></ol></li><li class="nav-item nav-level-5"><a class="nav-link" href="#loc-2"><span class="nav-number">2.4.0.3.</span> <span class="nav-text">loc</span></a><ol class="nav-child"><li class="nav-item nav-level-6"><a class="nav-link" href="#%E5%8F%AA%E5%88%87%E8%A1%8C-1"><span class="nav-number">2.4.0.3.1.</span> <span class="nav-text">只切行</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#%E5%8F%AA%E5%88%87%E5%88%97-1"><span class="nav-number">2.4.0.3.2.</span> <span class="nav-text">只切列</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#%E5%88%87%E8%A1%8C%E5%88%87%E5%88%97-1"><span class="nav-number">2.4.0.3.3.</span> <span class="nav-text">切行切列</span></a></li></ol></li></ol></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#DataFrame%E8%BF%90%E7%AE%97"><span class="nav-number">2.5.</span> <span class="nav-text">DataFrame运算</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#DataFrame%E4%B9%8B%E9%97%B4%E8%BF%90%E7%AE%97"><span class="nav-number">2.5.1.</span> <span class="nav-text">DataFrame之间运算</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%B1%82%E5%B9%B3%E5%9D%87%E5%80%BC"><span class="nav-number">2.5.2.</span> <span class="nav-text">求平均值</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%BC%A0%E4%B8%89%E6%9C%9F%E4%B8%AD%E6%95%B0%E5%AD%A60%E5%88%86"><span class="nav-number">2.5.3.</span> <span class="nav-text">张三期中数学0分</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%9D%8E%E5%9B%9B%E6%9C%9F%E4%B8%AD%E6%89%80%E6%9C%89%E5%8A%A0100"><span class="nav-number">2.5.4.</span> <span class="nav-text">李四期中所有加100</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%9C%9F%E4%B8%AD%E5%85%A8%E9%83%A8%E5%8A%A010"><span class="nav-number">2.5.5.</span> <span class="nav-text">期中全部加10</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%88%A0%E9%99%A4%E9%87%8D%E5%A4%8D%E5%85%83%E7%B4%A0"><span class="nav-number">2.6.</span> <span class="nav-text">删除重复元素</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E4%BD%BF%E7%94%A8drop-duplicates"><span class="nav-number">2.7.</span> <span class="nav-text">使用drop_duplicates</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%98%A0%E5%B0%84"><span class="nav-number">2.8.</span> <span class="nav-text">映射</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#replace-%E5%87%BD%E6%95%B0"><span class="nav-number">2.8.1.</span> <span class="nav-text">replace()函数</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#Series%E6%9B%BF%E6%8D%A2%E6%93%8D%E4%BD%9C"><span class="nav-number">2.8.1.1.</span> <span class="nav-text">Series替换操作</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#DataFrame%E6%9B%BF%E6%8D%A2%E6%93%8D%E4%BD%9C"><span class="nav-number">2.8.1.2.</span> <span class="nav-text">DataFrame替换操作</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#%E7%A4%BA%E4%BE%8B"><span class="nav-number">2.8.1.3.</span> <span class="nav-text">示例</span></a></li></ol></li><li class="nav-item nav-level-4"><a class="nav-link" href="#map-%E5%87%BD%E6%95%B0"><span class="nav-number">2.8.2.</span> <span class="nav-text">map()函数</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#%E7%A4%BA%E4%BE%8B-1"><span class="nav-number">2.8.2.1.</span> <span class="nav-text">示例</span></a><ol class="nav-child"><li class="nav-item nav-level-6"><a class="nav-link" href="#%E5%8E%9F%E5%A7%8B%E6%95%B0%E6%8D%AE"><span class="nav-number">2.8.2.1.1.</span> <span class="nav-text">原始数据</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#%E6%B7%BB%E5%8A%A0%E5%AF%B9%E5%BA%94%E4%B8%AD%E6%96%87%E5%90%8D"><span class="nav-number">2.8.2.1.2.</span> <span class="nav-text">添加对应中文名</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#%E5%A2%9E%E5%8A%A0%E7%A8%8E%E5%90%8E%E5%B7%A5%E8%B5%84"><span class="nav-number">2.8.2.1.3.</span> <span class="nav-text">增加税后工资</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#%E5%8C%BF%E5%90%8D%E5%87%BD%E6%95%B0%E8%AE%A1%E7%AE%97%E5%B7%A5%E8%B5%84"><span class="nav-number">2.8.2.1.4.</span> <span class="nav-text">匿名函数计算工资</span></a></li></ol></li><li class="nav-item nav-level-5"><a class="nav-link" href="#Series-map%E7%A4%BA%E4%BE%8B"><span class="nav-number">2.8.2.2.</span> <span class="nav-text">Series map示例</span></a></li></ol></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%BC%82%E5%B8%B8%E5%80%BC%E8%BF%87%E6%BB%A4"><span class="nav-number">2.8.3.</span> <span class="nav-text">异常值过滤</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#%E5%88%9B%E5%BB%BADataFrame"><span class="nav-number">2.8.3.1.</span> <span class="nav-text">创建DataFrame</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#%E6%A3%80%E6%B5%8B%E5%B9%B3%E5%9D%87%E5%80%BC"><span class="nav-number">2.8.3.2.</span> <span class="nav-text">检测平均值</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#%E8%BF%87%E6%BB%A4%E7%BB%93%E6%9E%9C"><span class="nav-number">2.8.3.3.</span> <span class="nav-text">过滤结果</span></a></li></ol></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E9%9A%8F%E6%9C%BA%E6%8A%BD%E6%A0%B7"><span class="nav-number">2.8.4.</span> <span class="nav-text">随机抽样</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#take"><span class="nav-number">2.8.4.1.</span> <span class="nav-text">take</span></a><ol class="nav-child"><li class="nav-item nav-level-6"><a class="nav-link" href="#%E5%8E%9F%E5%A7%8B%E6%95%B0%E5%88%97"><span class="nav-number">2.8.4.1.1.</span> <span class="nav-text">原始数列</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#%E9%9A%8F%E6%9C%BA%E6%8A%BD%E5%8F%96%E6%8C%87%E5%AE%9A%E8%A1%8C%E6%95%B0%E6%8D%AE"><span class="nav-number">2.8.4.1.2.</span> <span class="nav-text">随机抽取指定行数据</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#%E9%9A%8F%E6%9C%BA%E6%8A%BD%E5%8F%96%E6%8C%87%E5%AE%9A%E5%88%97%E6%95%B0%E6%8D%AE"><span class="nav-number">2.8.4.1.3.</span> <span class="nav-text">随机抽取指定列数据</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#%E9%9A%8F%E6%9C%BA%E6%89%93%E4%B9%B1"><span class="nav-number">2.8.4.1.4.</span> <span class="nav-text">随机打乱</span></a></li></ol></li></ol></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%95%B0%E6%8D%AE%E5%88%86%E7%B1%BB"><span class="nav-number">2.9.</span> <span class="nav-text">数据分类</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%88%86%E7%BB%84"><span class="nav-number">2.9.1.</span> <span class="nav-text">分组</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#%E6%A0%B9%E6%8D%AE%E6%B0%B4%E6%9E%9C%E7%B1%BB%E5%9E%8B%E5%88%86%E7%BB%84"><span class="nav-number">2.9.1.1.</span> <span class="nav-text">根据水果类型分组</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#%E6%8C%89%E9%A2%9C%E8%89%B2%E5%88%86%E7%BB%84"><span class="nav-number">2.9.1.2.</span> <span class="nav-text">按颜色分组</span></a></li></ol></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E8%81%9A%E5%90%88"><span class="nav-number">2.9.2.</span> <span class="nav-text">聚合</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#%E6%AF%8F%E7%A7%8D%E6%B0%B4%E6%9E%9C%E5%B9%B3%E5%9D%87%E5%80%BC"><span class="nav-number">2.9.2.1.</span> <span class="nav-text">每种水果平均值</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#%E6%AF%8F%E7%A7%8D%E6%B0%B4%E6%9E%9C%E5%B9%B3%E5%9D%87%E4%BB%B7%E6%A0%BC"><span class="nav-number">2.9.2.2.</span> <span class="nav-text">每种水果平均价格</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#%E8%8B%B9%E6%9E%9C%E7%9A%84%E5%B9%B3%E5%9D%87%E4%BB%B7%E6%A0%BC"><span class="nav-number">2.9.2.3.</span> <span class="nav-text">苹果的平均价格</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#%E6%B7%BB%E5%8A%A0%E6%AF%8F%E4%B8%AA%E6%B0%B4%E6%9E%9C%E5%B9%B3%E5%9D%87%E4%BB%B7%E6%A0%BC%E5%88%97"><span class="nav-number">2.9.2.4.</span> <span class="nav-text">添加每个水果平均价格列</span></a><ol class="nav-child"><li class="nav-item nav-level-6"><a class="nav-link" href="#%E8%AE%A1%E7%AE%97%E6%AF%8F%E7%A7%8D%E6%B0%B4%E6%9E%9C%E5%9D%87%E4%BB%B7"><span class="nav-number">2.9.2.4.1.</span> <span class="nav-text">计算每种水果均价</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#%E6%AF%8F%E7%A7%8D%E6%B0%B4%E6%9E%9C%E4%BB%B7%E6%A0%BC%E5%B9%B3%E5%9D%87%E4%BB%B7%E8%BD%AC%E6%8D%A2%E6%88%90%E5%AD%97%E5%85%B8"><span class="nav-number">2.9.2.4.2.</span> <span class="nav-text">每种水果价格平均价转换成字典</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#%E4%BD%BF%E7%94%A8map%E6%98%A0%E5%B0%84%E5%90%8E%E6%B7%BB%E5%8A%A0%E5%88%B0%E4%B8%80%E4%B8%AA%E6%96%B0%E5%88%97"><span class="nav-number">2.9.2.4.3.</span> <span class="nav-text">使用map映射后添加到一个新列</span></a></li></ol></li></ol></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E9%AB%98%E7%BA%A7%E6%95%B0%E6%8D%AE%E8%81%9A%E5%90%88"><span class="nav-number">2.9.3.</span> <span class="nav-text">高级数据聚合</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#%E4%BD%BF%E7%94%A8apply%E8%AE%A1%E7%AE%97%E6%AF%8F%E7%A7%8D%E6%B0%B4%E6%9E%9C%E5%B9%B3%E5%9D%87%E4%BB%B7%E6%A0%BC"><span class="nav-number">2.9.3.1.</span> <span class="nav-text">使用apply计算每种水果平均价格</span></a></li></ol></li></ol></li></ol></div></section><section class="site-overview-wrap sidebar-panel"><div class="site-author animated" itemprop="author" itemscope itemtype="http://schema.org/Person"><img class="site-author-image" itemprop="image" alt="托小尼" src="/images/avatar.jpg"><p class="site-author-name" itemprop="name">托小尼</p><div class="site-description" itemprop="description"></div></div><div class="site-state-wrap animated"><nav class="site-state"><div class="site-state-item site-state-posts"><a href="/archives/"><span class="site-state-item-count">202</span> <span class="site-state-item-name">日志</span></a></div><div class="site-state-item site-state-categories"><a href="/categories/"><span class="site-state-item-count">30</span> <span class="site-state-item-name">分类</span></a></div><div class="site-state-item site-state-tags"><a href="/tags/"><span class="site-state-item-count">1283</span> <span class="site-state-item-name">标签</span></a></div></nav></div><div class="links-of-author animated"><span class="links-of-author-item"><span class="exturl" data-url="aHR0cDovL3dwYS5xcS5jb20vbXNncmQ/dj0zJnVpbj02NDY1NDc5ODkmc2l0ZT1xcSZtZW51PXllcw==" title="QQ → http:&#x2F;&#x2F;wpa.qq.com&#x2F;msgrd?v&#x3D;3&amp;uin&#x3D;646547989&amp;site&#x3D;qq&amp;menu&#x3D;yes"><i class="fab fa-qq fa-fw"></i>QQ</span> </span><span class="links-of-author-item"><span class="exturl" data-url="bWFpbHRvOnRvbnl5dUB2aXAucXEuY29t" title="E-Mail → mailto:tonyyu@vip.qq.com"><i class="fa fa-envelope fa-fw"></i>E-Mail</span></span></div></section></div></aside><div class="sidebar-dimmer"></div></header><div class="back-to-top"><i class="fa fa-arrow-up"></i> <span>0%</span></div><div class="reading-progress-bar"></div><span class="exturl github-corner" data-url="aHR0cHM6Ly9naXRodWIuY29tL3Rvbnl1MjAxOQ==" title="关注我" aria-label="关注我"><svg width="80" height="80" viewBox="0 0 250 250" aria-hidden="true"><path d="M0,0 L115,115 L130,115 L142,142 L250,250 L250,0 Z"></path><path d="M128.3,109.0 C113.8,99.7 119.0,89.6 119.0,89.6 C122.0,82.7 120.5,78.6 120.5,78.6 C119.2,72.0 123.4,76.3 123.4,76.3 C127.3,80.9 125.5,87.3 125.5,87.3 C122.9,97.6 130.6,101.9 134.4,103.2" fill="currentColor" style="transform-origin:130px 106px" class="octo-arm"></path><path d="M115.0,115.0 C114.9,115.1 118.7,116.5 119.8,115.4 L133.7,101.6 C136.9,99.2 139.9,98.4 142.2,98.6 C133.8,88.0 127.5,74.4 143.8,58.0 C148.5,53.4 154.0,51.2 159.7,51.0 C160.3,49.4 163.2,43.6 171.4,40.1 C171.4,40.1 176.1,42.5 178.8,56.2 C183.1,58.6 187.2,61.8 190.9,65.4 C194.5,69.0 197.7,73.2 200.1,77.6 C213.8,80.2 216.3,84.9 216.3,84.9 C212.7,93.1 206.9,96.0 205.4,96.6 C205.1,102.4 203.0,107.8 198.3,112.5 C181.9,128.9 168.3,122.5 157.7,114.1 C157.9,116.9 156.7,120.9 152.7,124.9 L141.0,136.5 C139.8,137.7 141.6,141.9 141.8,141.8 Z" fill="currentColor" class="octo-body"></path></svg></span><noscript><div class="noscript-warning">Theme NexT works best with JavaScript enabled</div></noscript><div class="main-inner post posts-expand"><article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN"><link itemprop="mainEntityOfPage" href="https://www.diandian100.cn/fdb2dd4a.html"><span hidden itemprop="author" itemscope itemtype="http://schema.org/Person"><meta itemprop="image" content="/images/avatar.jpg"><meta itemprop="name" content="托小尼"><meta itemprop="description" content=""></span><span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization"><meta itemprop="name" content="点点开发技术分享"></span><header class="post-header"><h1 class="post-title" itemprop="name headline">python数据分析之第三方模块Pandas</h1><div class="post-meta-container"><div class="post-meta"><span class="post-meta-item"><span class="post-meta-item-icon"><i class="far fa-calendar"></i> </span><span class="post-meta-item-text">发表于</span> <time title="创建时间：2019-11-21 16:50:48" itemprop="dateCreated datePublished" datetime="2019-11-21T16:50:48+08:00">2019-11-21</time> </span><span class="post-meta-item"><span class="post-meta-item-icon"><i class="far fa-calendar-check"></i> </span><span class="post-meta-item-text">更新于</span> <time title="修改时间：2020-09-04 09:00:24" itemprop="dateModified" datetime="2020-09-04T09:00:24+08:00">2020-09-04</time> </span><span class="post-meta-item"><span class="post-meta-item-icon"><i class="far fa-folder"></i> </span><span class="post-meta-item-text">分类于</span> <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/rd/" itemprop="url" rel="index"><span itemprop="name">rd</span></a> </span>， <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/rd/python/" itemprop="url" rel="index"><span itemprop="name">python</span></a> </span></span><span class="post-meta-item"><span class="post-meta-item-icon"><i class="far fa-comment"></i> </span><span class="post-meta-item-text">Changyan：</span> <a title="changyan" href="/fdb2dd4a.html#SOHUCS" itemprop="discussionUrl"><span id="changyan_count_unit" class="post-comments-count hc-comment-count" data-xid="fdb2dd4a.html" itemprop="commentCount"></span></a></span></div><div class="post-meta"><span class="post-meta-item" title="本文字数"><span class="post-meta-item-icon"><i class="far fa-file-word"></i> </span><span class="post-meta-item-text">本文字数：</span> <span>19k</span> </span><span class="post-meta-item" title="阅读时长"><span class="post-meta-item-icon"><i class="far fa-clock"></i> </span><span class="post-meta-item-text">阅读时长 &asymp;</span> <span>18 分钟</span></span></div></div></header><div class="post-body" itemprop="articleBody"><p><code>pandas</code> 是基于<code>NumPy</code> 的一种工具，该工具是为了解决数据分析任务而创建的。<code>Pandas</code> 纳入了大量库和一些标准的数据模型，提供了高效地操作大型数据集所需的工具。<code>pandas</code>提供了大量能使我们快速便捷地处理数据的函数和方法。你很快就会发现，它是使<code>Python</code>成为强大而高效的数据分析环境的重要因素之一。</p><a id="more"></a><h2 id="Series"><a href="#Series" class="headerlink" title="Series"></a><code>Series</code></h2><p><code>Series</code>是一种类似与一维数组的对象，由下面两个部分组成：</p><ul><li><code>values</code>：一组数据（<code>ndarray</code>类型）</li><li><code>index</code>：相关的数据索引标签</li></ul><h3 id="Series创建"><a href="#Series创建" class="headerlink" title="Series创建"></a><code>Series</code>创建</h3><h4 id="列表创建"><a href="#列表创建" class="headerlink" title="列表创建"></a>列表创建</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pandas <span class="keyword">import</span> Series</span><br><span class="line"></span><br><span class="line">s = Series(data=[<span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>, <span class="number">2</span>, <span class="number">5</span>])</span><br><span class="line">print(s)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 结果</span></span><br><span class="line"><span class="number">0</span>    <span class="number">3</span></span><br><span class="line"><span class="number">1</span>    <span class="number">4</span></span><br><span class="line"><span class="number">2</span>    <span class="number">5</span></span><br><span class="line"><span class="number">3</span>    <span class="number">2</span></span><br><span class="line"><span class="number">4</span>    <span class="number">5</span></span><br></pre></td></tr></table></figure><h4 id="numpy创建"><a href="#numpy创建" class="headerlink" title="numpy创建"></a><code>numpy</code>创建</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"><span class="keyword">from</span> pandas <span class="keyword">import</span> Series</span><br><span class="line">s = Series(data=np.random.randint(<span class="number">1</span>, <span class="number">50</span>, size=<span class="number">6</span>), index=[<span class="string">&#x27;a&#x27;</span>, <span class="string">&#x27;b&#x27;</span>, <span class="string">&#x27;c&#x27;</span>, <span class="string">&#x27;d&#x27;</span>, <span class="string">&#x27;e&#x27;</span>, <span class="string">&#x27;f&#x27;</span>], name=<span class="string">&#x27;test&#x27;</span>)</span><br><span class="line">print(s)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 结果</span></span><br><span class="line">a    <span class="number">24</span></span><br><span class="line">b    <span class="number">39</span></span><br><span class="line">c    <span class="number">46</span></span><br><span class="line">d    <span class="number">13</span></span><br><span class="line">e    <span class="number">41</span></span><br><span class="line">f    <span class="number">15</span></span><br><span class="line">Name: test, dtype: int32</span><br></pre></td></tr></table></figure><h4 id="字典创建"><a href="#字典创建" class="headerlink" title="字典创建"></a>字典创建</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pandas <span class="keyword">import</span> Series</span><br><span class="line">dic = &#123;</span><br><span class="line">    <span class="string">&#x27;name&#x27;</span> : <span class="string">&#x27;张学友&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;gender&#x27;</span> : <span class="string">&#x27;男&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;age&#x27;</span> : <span class="number">18</span>,</span><br><span class="line">    <span class="string">&#x27;city&#x27;</span> : <span class="string">&#x27;鹤岗&#x27;</span></span><br><span class="line">&#125;</span><br><span class="line">s = Series(data=dic, name=<span class="string">&#x27;test&#x27;</span>)</span><br><span class="line">print(s)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 结果</span></span><br><span class="line">name      张学友</span><br><span class="line">gender      男</span><br><span class="line">age        <span class="number">18</span></span><br><span class="line">city       鹤岗</span><br><span class="line">Name: test, dtype: object</span><br></pre></td></tr></table></figure><h3 id="Series索引"><a href="#Series索引" class="headerlink" title="Series索引"></a><code>Series</code>索引</h3><p>可以使用中括号取单个索引（此时返回的是元素类型），或者中括号里一个列表取多个索引（此时返回的是一个<code>Series</code>类型）。</p><h4 id="显式索引"><a href="#显式索引" class="headerlink" title="显式索引"></a>显式索引</h4><ul><li>使用<code>index</code>中的元素作为索引值</li><li>使用<code>s.loc[]</code>（推荐）:注意，<code>loc</code>中括号中放置的一定是显式索引</li><li>使用s.索引元素直接获取</li></ul><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pandas <span class="keyword">import</span> Series</span><br><span class="line">dic = &#123;</span><br><span class="line">    <span class="string">&#x27;name&#x27;</span> : <span class="string">&#x27;张学友&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;gender&#x27;</span> : <span class="string">&#x27;男&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;age&#x27;</span> : <span class="number">18</span>,</span><br><span class="line">    <span class="string">&#x27;city&#x27;</span> : <span class="string">&#x27;鹤岗&#x27;</span></span><br><span class="line">&#125;</span><br><span class="line">s = Series(data=dic, name=<span class="string">&#x27;test&#x27;</span>)</span><br><span class="line">print(s[<span class="string">&#x27;city&#x27;</span>])</span><br><span class="line">print(s.loc[<span class="string">&#x27;city&#x27;</span>])</span><br><span class="line">print(s.city)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 结果</span></span><br><span class="line">鹤岗</span><br><span class="line">鹤岗</span><br><span class="line">鹤岗</span><br></pre></td></tr></table></figure><h4 id="隐式索引"><a href="#隐式索引" class="headerlink" title="隐式索引"></a>隐式索引</h4><ul><li>使用整数作为索引值</li><li>使用<code>.iloc[]</code>（推荐）:<code>iloc</code>中的中括号中必须放置隐式索引</li></ul><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pandas <span class="keyword">import</span> Series</span><br><span class="line">dic = &#123;</span><br><span class="line">    <span class="string">&#x27;name&#x27;</span> : <span class="string">&#x27;张学友&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;gender&#x27;</span> : <span class="string">&#x27;男&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;age&#x27;</span> : <span class="number">18</span>,</span><br><span class="line">    <span class="string">&#x27;city&#x27;</span> : <span class="string">&#x27;鹤岗&#x27;</span></span><br><span class="line">&#125;</span><br><span class="line">s = Series(data=dic, name=<span class="string">&#x27;test&#x27;</span>)</span><br><span class="line">print(s[<span class="number">3</span>])</span><br><span class="line">print(s.iloc[<span class="number">3</span>])</span><br><span class="line"></span><br><span class="line"><span class="comment"># 结果</span></span><br><span class="line">鹤岗</span><br><span class="line">鹤岗</span><br></pre></td></tr></table></figure><h3 id="Series切片"><a href="#Series切片" class="headerlink" title="Series切片"></a><code>Series</code>切片</h3><h4 id="显式索引切片"><a href="#显式索引切片" class="headerlink" title="显式索引切片"></a>显式索引切片</h4><ul><li><p>直接使用索引区间：如<code>s[&#39;a&#39;:&#39;b&#39;]</code></p></li><li><p>使用<code>loc</code>： 如<code>s.loc[&#39;a&#39;:&#39;b&#39;]</code></p></li></ul><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pandas <span class="keyword">import</span> Series</span><br><span class="line">dic = &#123;</span><br><span class="line">    <span class="string">&#x27;name&#x27;</span> : <span class="string">&#x27;张学友&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;gender&#x27;</span> : <span class="string">&#x27;男&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;age&#x27;</span> : <span class="number">18</span>,</span><br><span class="line">    <span class="string">&#x27;city&#x27;</span> : <span class="string">&#x27;鹤岗&#x27;</span></span><br><span class="line">&#125;</span><br><span class="line">s = Series(data=dic, name=<span class="string">&#x27;test&#x27;</span>)</span><br><span class="line">print(s[<span class="string">&#x27;gender&#x27;</span>:<span class="string">&#x27;city&#x27;</span>])</span><br><span class="line">print(s.loc[<span class="string">&#x27;gender&#x27;</span>:<span class="string">&#x27;city&#x27;</span>])</span><br><span class="line"></span><br><span class="line"><span class="comment"># 结果</span></span><br><span class="line">gender     男</span><br><span class="line">age       <span class="number">18</span></span><br><span class="line">city      鹤岗</span><br><span class="line">Name: test, dtype: object</span><br><span class="line">gender     男</span><br><span class="line">age       <span class="number">18</span></span><br><span class="line">city      鹤岗</span><br><span class="line">Name: test, dtype: object</span><br></pre></td></tr></table></figure><h4 id="隐式索引切片"><a href="#隐式索引切片" class="headerlink" title="隐式索引切片"></a>隐式索引切片</h4><ul><li><p>直接使用索引区间：如<code>s[1:3]</code></p></li><li><p>使用<code>iloc</code>： 如<code>s.iloc[1:3]</code></p></li></ul><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pandas <span class="keyword">import</span> Series</span><br><span class="line">dic = &#123;</span><br><span class="line">    <span class="string">&#x27;name&#x27;</span> : <span class="string">&#x27;张学友&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;gender&#x27;</span> : <span class="string">&#x27;男&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;age&#x27;</span> : <span class="number">18</span>,</span><br><span class="line">    <span class="string">&#x27;city&#x27;</span> : <span class="string">&#x27;鹤岗&#x27;</span></span><br><span class="line">&#125;</span><br><span class="line">s = Series(data=dic, name=<span class="string">&#x27;test&#x27;</span>)</span><br><span class="line">print(s[<span class="number">0</span>:<span class="number">2</span>])</span><br><span class="line">print(s.iloc[<span class="number">0</span>:<span class="number">2</span>])</span><br><span class="line"></span><br><span class="line"><span class="comment"># 结果</span></span><br><span class="line">name      张学友</span><br><span class="line">gender      男</span><br><span class="line">Name: test, dtype: object</span><br><span class="line">name      张学友</span><br><span class="line">gender      男</span><br><span class="line">Name: test, dtype: object</span><br></pre></td></tr></table></figure><h3 id="Series属性及基本使用"><a href="#Series属性及基本使用" class="headerlink" title="Series属性及基本使用"></a><code>Series</code>属性及基本使用</h3><h4 id="索引"><a href="#索引" class="headerlink" title="索引"></a>索引</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pandas <span class="keyword">import</span> Series</span><br><span class="line">dic = &#123;</span><br><span class="line">    <span class="string">&#x27;name&#x27;</span> : <span class="string">&#x27;张学友&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;gender&#x27;</span> : <span class="string">&#x27;男&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;age&#x27;</span> : <span class="number">18</span>,</span><br><span class="line">    <span class="string">&#x27;city&#x27;</span> : <span class="string">&#x27;鹤岗&#x27;</span></span><br><span class="line">&#125;</span><br><span class="line">s = Series(data=dic, name=<span class="string">&#x27;test&#x27;</span>)</span><br><span class="line">print(s.index)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 结果</span></span><br><span class="line">Index([<span class="string">&#x27;name&#x27;</span>, <span class="string">&#x27;gender&#x27;</span>, <span class="string">&#x27;age&#x27;</span>, <span class="string">&#x27;city&#x27;</span>], dtype=<span class="string">&#x27;object&#x27;</span>)</span><br></pre></td></tr></table></figure><h4 id="值"><a href="#值" class="headerlink" title="值"></a>值</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pandas <span class="keyword">import</span> Series</span><br><span class="line">dic = &#123;</span><br><span class="line">    <span class="string">&#x27;name&#x27;</span> : <span class="string">&#x27;张学友&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;gender&#x27;</span> : <span class="string">&#x27;男&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;age&#x27;</span> : <span class="number">18</span>,</span><br><span class="line">    <span class="string">&#x27;city&#x27;</span> : <span class="string">&#x27;鹤岗&#x27;</span></span><br><span class="line">&#125;</span><br><span class="line">s = Series(data=dic, name=<span class="string">&#x27;test&#x27;</span>)</span><br><span class="line">print(s.values)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 结果</span></span><br><span class="line">[<span class="string">&#x27;张学友&#x27;</span> <span class="string">&#x27;男&#x27;</span> <span class="number">18</span> <span class="string">&#x27;鹤岗&#x27;</span>]</span><br></pre></td></tr></table></figure><h4 id="head-n"><a href="#head-n" class="headerlink" title="head(n)"></a><code>head(n)</code></h4><p>获取前<code>n</code>个值</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">print(s.head(<span class="number">2</span>))</span><br><span class="line"><span class="comment"># 结果</span></span><br><span class="line">name      张学友</span><br><span class="line">gender      男</span><br><span class="line">Name: test, dtype: object</span><br></pre></td></tr></table></figure><h4 id="tail-n"><a href="#tail-n" class="headerlink" title="tail(n)"></a><code>tail(n)</code></h4><p>获取后<code>n</code>个值</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">print(s.tail(<span class="number">2</span>))</span><br><span class="line"><span class="comment"># 结果</span></span><br><span class="line">age     <span class="number">18</span></span><br><span class="line">city    鹤岗</span><br><span class="line">Name: test, dtype: object</span><br></pre></td></tr></table></figure><h4 id="unique"><a href="#unique" class="headerlink" title="unique()"></a><code>unique()</code></h4><p>去重</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">s = Series(data=[<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>, <span class="number">4</span>, <span class="number">3</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">2</span>])</span><br><span class="line">print(s.unique())</span><br><span class="line"></span><br><span class="line"><span class="comment"># 结果</span></span><br><span class="line">[<span class="number">1</span> <span class="number">2</span> <span class="number">3</span> <span class="number">4</span> <span class="number">5</span>]</span><br></pre></td></tr></table></figure><h4 id="Series运算"><a href="#Series运算" class="headerlink" title="Series运算"></a><code>Series运算</code></h4><h5 id="数字运算"><a href="#数字运算" class="headerlink" title="数字运算"></a>数字运算</h5><p>直接使用运算符<code>+</code>、<code>-</code>、<code>*</code>、<code>/</code>进行运算</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">s = Series(data=[<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>])</span><br><span class="line">print(s+<span class="number">10</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 结果</span></span><br><span class="line"><span class="number">0</span>    <span class="number">11</span></span><br><span class="line"><span class="number">1</span>    <span class="number">12</span></span><br><span class="line"><span class="number">2</span>    <span class="number">13</span></span><br><span class="line"><span class="number">3</span>    <span class="number">14</span></span><br><span class="line"><span class="number">4</span>    <span class="number">15</span></span><br><span class="line">dtype: int64</span><br></pre></td></tr></table></figure><h5 id="计算函数运算"><a href="#计算函数运算" class="headerlink" title="计算函数运算"></a>计算函数运算</h5><p>使用<code>add()</code>、<code>sub()</code>、<code>mul()</code>、<code>div()</code>，分别代表加减乘除。其中都可以携带参数，默认参数可以是数字或者<code>Series</code>，<code>fill_value</code>代表如果元素为空则给其填充一个默认值</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">s = Series(data=[<span class="number">20</span>, <span class="number">30</span>, <span class="literal">None</span>, <span class="number">40</span>, <span class="literal">None</span>], index=[<span class="string">&#x27;a&#x27;</span>, <span class="string">&#x27;b&#x27;</span>, <span class="string">&#x27;c&#x27;</span>, <span class="string">&#x27;d&#x27;</span>, <span class="string">&#x27;e&#x27;</span>])</span><br><span class="line">print(s.add(<span class="number">10</span>, fill_value=<span class="number">999</span>))</span><br><span class="line"></span><br><span class="line"><span class="comment"># 结果</span></span><br><span class="line">a      <span class="number">30.0</span></span><br><span class="line">b      <span class="number">40.0</span></span><br><span class="line">c    <span class="number">1009.0</span></span><br><span class="line">d      <span class="number">50.0</span></span><br><span class="line">e    <span class="number">1009.0</span></span><br><span class="line">dtype: float64</span><br></pre></td></tr></table></figure><h5 id="多个series运算"><a href="#多个series运算" class="headerlink" title="多个series运算"></a>多个<code>series</code>运算</h5><p>当索引没有对应的值时，可能出现缺失数据显示<code>NaN</code>（not a number）的情况，使得两个<code>Series</code>进行相加:索引与之对应的元素会进行算数运算,不对应的就补空</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">s1 = Series(data=[<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>], index=[<span class="string">&#x27;a&#x27;</span>, <span class="string">&#x27;b&#x27;</span>, <span class="string">&#x27;c&#x27;</span>, <span class="string">&#x27;d&#x27;</span>])</span><br><span class="line">s2 = Series(data=[<span class="number">10</span>, <span class="number">20</span>, <span class="number">30</span>, <span class="number">40</span>], index=[<span class="string">&#x27;f&#x27;</span>, <span class="string">&#x27;c&#x27;</span>, <span class="string">&#x27;e&#x27;</span>, <span class="string">&#x27;a&#x27;</span>])</span><br><span class="line">print(s1+s2)</span><br><span class="line"><span class="comment"># 或者</span></span><br><span class="line">s1.add(s2)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 结果</span></span><br><span class="line">a    <span class="number">41.0</span></span><br><span class="line">b     NaN</span><br><span class="line">c    <span class="number">23.0</span></span><br><span class="line">d     NaN</span><br><span class="line">e     NaN</span><br><span class="line">f     NaN</span><br><span class="line">dtype: float64</span><br></pre></td></tr></table></figure><h4 id="isnull"><a href="#isnull" class="headerlink" title="isnull()"></a><code>isnull()</code></h4><p>检测元素是否为空</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">s = Series(data=[<span class="number">1</span>, <span class="number">2</span>, <span class="literal">None</span>, <span class="number">4</span>, <span class="literal">None</span>], index=[<span class="string">&#x27;a&#x27;</span>, <span class="string">&#x27;b&#x27;</span>, <span class="string">&#x27;c&#x27;</span>, <span class="string">&#x27;d&#x27;</span>, <span class="string">&#x27;e&#x27;</span>])</span><br><span class="line">print(s.isnull())</span><br><span class="line"></span><br><span class="line"><span class="comment"># 结果</span></span><br><span class="line">a    <span class="literal">False</span></span><br><span class="line">b    <span class="literal">False</span></span><br><span class="line">c     <span class="literal">True</span></span><br><span class="line">d    <span class="literal">False</span></span><br><span class="line">e     <span class="literal">True</span></span><br><span class="line">dtype: bool</span><br></pre></td></tr></table></figure><h4 id="notnull"><a href="#notnull" class="headerlink" title="notnull()"></a><code>notnull()</code></h4><p>检测元素是否不为空</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">s = Series(data=[<span class="number">1</span>, <span class="number">2</span>, <span class="literal">None</span>, <span class="number">4</span>, <span class="literal">None</span>], index=[<span class="string">&#x27;a&#x27;</span>, <span class="string">&#x27;b&#x27;</span>, <span class="string">&#x27;c&#x27;</span>, <span class="string">&#x27;d&#x27;</span>, <span class="string">&#x27;e&#x27;</span>])</span><br><span class="line">print(s.notnull())</span><br><span class="line"></span><br><span class="line"><span class="comment"># 结果</span></span><br><span class="line">a     <span class="literal">True</span></span><br><span class="line">b     <span class="literal">True</span></span><br><span class="line">c    <span class="literal">False</span></span><br><span class="line">d     <span class="literal">True</span></span><br><span class="line">e    <span class="literal">False</span></span><br><span class="line">dtype: bool</span><br></pre></td></tr></table></figure><h2 id="DataFrame"><a href="#DataFrame" class="headerlink" title="DataFrame"></a><code>DataFrame</code></h2><p><code>DataFrame</code>是一个【表格型】的数据结构。<code>DataFrame</code>由按一定顺序排列的多列数据组成。设计初衷是将Series的使用场景从一维拓展到多维。<code>DataFrame</code>既有行索引，也有列索引。</p><ul><li>行索引：<code>index</code></li><li>列索引：<code>columns</code></li><li>值：<code>values</code></li></ul><h3 id="Dataframe创建"><a href="#Dataframe创建" class="headerlink" title="Dataframe创建"></a><code>Dataframe</code>创建</h3><h4 id="使用ndarray"><a href="#使用ndarray" class="headerlink" title="使用ndarray"></a>使用<code>ndarray</code></h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">DataFrame(data=np.random.randint(<span class="number">0</span>,<span class="number">100</span>,size=(<span class="number">5</span>,<span class="number">6</span>)))</span><br></pre></td></tr></table></figure><p>运行结果：<br>| 0 | 1 | 2 | 3 | 4 | 5 | |<br>| —: | —: | —: | —: | —: | —: | —- |<br>| 0 | 32 | 93 | 0 | 23 | 21 | 40 |<br>| 1 | 27 | 35 | 9 | 76 | 41 | 68 |<br>| 2 | 63 | 96 | 63 | 30 | 96 | 51 |<br>| 3 | 2 | 50 | 28 | 26 | 26 | 41 |<br>| 4 | 32 | 74 | 97 | 84 | 56 | 7 |</p><h4 id="字典创建-1"><a href="#字典创建-1" class="headerlink" title="字典创建"></a>字典创建</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">dic = &#123;</span><br><span class="line">    <span class="string">&#x27;张三&#x27;</span>:[<span class="number">77</span>,<span class="number">88</span>,<span class="number">99</span>,<span class="number">90</span>],</span><br><span class="line">    <span class="string">&#x27;李四&#x27;</span>:[<span class="number">67</span>,<span class="number">88</span>,<span class="number">99</span>,<span class="number">78</span>]</span><br><span class="line">&#125;</span><br><span class="line">df = DataFrame(data=dic,index=[<span class="string">&#x27;语文&#x27;</span>,<span class="string">&#x27;数学&#x27;</span>,<span class="string">&#x27;英语&#x27;</span>,<span class="string">&#x27;理综&#x27;</span>])</span><br></pre></td></tr></table></figure><p>运行结果：<br>| | 张三 | 李四 |<br>| —: | —: | —: |<br>| 语文 | 77 | 67 |<br>| 数学 | 88 | 88 |<br>| 英语 | 99 | 99 |<br>| 理综 | 90 | 78 |</p><h3 id="Dataframe属性"><a href="#Dataframe属性" class="headerlink" title="Dataframe属性"></a><code>Dataframe</code>属性</h3><h4 id="values"><a href="#values" class="headerlink" title="values"></a><code>values</code></h4><p>元素值</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">dic = &#123;</span><br><span class="line">    <span class="string">&#x27;张三&#x27;</span>:[<span class="number">77</span>,<span class="number">88</span>,<span class="number">99</span>,<span class="number">90</span>],</span><br><span class="line">    <span class="string">&#x27;李四&#x27;</span>:[<span class="number">67</span>,<span class="number">88</span>,<span class="number">99</span>,<span class="number">78</span>]</span><br><span class="line">&#125;</span><br><span class="line">df = DataFrame(data=dic,index=[<span class="string">&#x27;语文&#x27;</span>,<span class="string">&#x27;数学&#x27;</span>,<span class="string">&#x27;英语&#x27;</span>,<span class="string">&#x27;理综&#x27;</span>])</span><br><span class="line">df.values</span><br></pre></td></tr></table></figure><p>运行结果：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">array([[77, 67],</span><br><span class="line">       [88, 88],</span><br><span class="line">       [99, 99],</span><br><span class="line">       [90, 78]], dtype&#x3D;int64)</span><br></pre></td></tr></table></figure><h4 id="columns"><a href="#columns" class="headerlink" title="columns"></a><code>columns</code></h4><p>列索引</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">df.columns</span><br></pre></td></tr></table></figure><p>运行结果：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Index([<span class="string">&#x27;张三&#x27;</span>, <span class="string">&#x27;李四&#x27;</span>], dtype=<span class="string">&#x27;object&#x27;</span>)</span><br></pre></td></tr></table></figure><h4 id="index"><a href="#index" class="headerlink" title="index"></a><code>index</code></h4><p>行索引</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">df.index</span><br></pre></td></tr></table></figure><p>运行结果：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Index([<span class="string">&#x27;语文&#x27;</span>, <span class="string">&#x27;数学&#x27;</span>, <span class="string">&#x27;英语&#x27;</span>, <span class="string">&#x27;理综&#x27;</span>], dtype=<span class="string">&#x27;object&#x27;</span>)</span><br></pre></td></tr></table></figure><h4 id="shape"><a href="#shape" class="headerlink" title="shape"></a><code>shape</code></h4><p>形状、维度</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">df.shape</span><br></pre></td></tr></table></figure><p>运行结果：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">(<span class="number">4</span>, <span class="number">2</span>)</span><br></pre></td></tr></table></figure><h3 id="DataFrame索引"><a href="#DataFrame索引" class="headerlink" title="DataFrame索引"></a><code>DataFrame</code>索引</h3><h4 id="列索引"><a href="#列索引" class="headerlink" title="列索引"></a>列索引</h4><h5 id="字典方式"><a href="#字典方式" class="headerlink" title="字典方式"></a>字典方式</h5><p>通过类似字典的方式取得如：<code>df[&#39;a&#39;]</code></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">df[<span class="string">&#x27;张三&#x27;</span>]</span><br></pre></td></tr></table></figure><p>结果：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">语文    <span class="number">77</span></span><br><span class="line">数学    <span class="number">88</span></span><br><span class="line">英语    <span class="number">99</span></span><br><span class="line">理综    <span class="number">90</span></span><br><span class="line">Name: 张三, dtype: int64</span><br></pre></td></tr></table></figure><h5 id="属性方式"><a href="#属性方式" class="headerlink" title="属性方式"></a>属性方式</h5><p>通过类似对象取属性的方式取列，如：<code>df.a</code></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">df.张三</span><br></pre></td></tr></table></figure><p>结果：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">语文    <span class="number">77</span></span><br><span class="line">数学    <span class="number">88</span></span><br><span class="line">英语    <span class="number">99</span></span><br><span class="line">理综    <span class="number">90</span></span><br><span class="line">Name: 张三, dtype: int64</span><br></pre></td></tr></table></figure><h5 id="取多列"><a href="#取多列" class="headerlink" title="取多列"></a>取多列</h5><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">df[[<span class="string">&#x27;李四&#x27;</span>, <span class="string">&#x27;张三&#x27;</span>]]</span><br></pre></td></tr></table></figure><p>结果：</p><table><thead><tr><th align="right"></th><th align="right">李四</th><th align="right">张三</th></tr></thead><tbody><tr><td align="right">语文</td><td align="right">67</td><td align="right">77</td></tr><tr><td align="right">数学</td><td align="right">88</td><td align="right">88</td></tr><tr><td align="right">英语</td><td align="right">99</td><td align="right">99</td></tr><tr><td align="right">理综</td><td align="right">78</td><td align="right">90</td></tr></tbody></table><h5 id="修改列索引"><a href="#修改列索引" class="headerlink" title="修改列索引"></a>修改列索引</h5><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#修改列索引</span></span><br><span class="line">df.columns = [<span class="string">&#x27;zhangsan&#x27;</span>,<span class="string">&#x27;lisi&#x27;</span>]</span><br><span class="line">df</span><br></pre></td></tr></table></figure><p>结果：</p><table><thead><tr><th align="right"></th><th align="right">zhangsan</th><th align="right">lisi</th></tr></thead><tbody><tr><td align="right">语文</td><td align="right">77</td><td align="right">67</td></tr><tr><td align="right">数学</td><td align="right">88</td><td align="right">88</td></tr><tr><td align="right">英语</td><td align="right">99</td><td align="right">99</td></tr><tr><td align="right">理综</td><td align="right">90</td><td align="right">78</td></tr></tbody></table><h4 id="行索引"><a href="#行索引" class="headerlink" title="行索引"></a>行索引</h4><h5 id="loc"><a href="#loc" class="headerlink" title="loc"></a><code>loc</code></h5><p>使用<code>.loc[]</code>加<code>index</code>来进行行索引</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">df.loc[<span class="string">&#x27;语文&#x27;</span>]</span><br></pre></td></tr></table></figure><p>结果：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">张三    <span class="number">77</span></span><br><span class="line">李四    <span class="number">67</span></span><br><span class="line">Name: 语文, dtype: int64</span><br></pre></td></tr></table></figure><p>选择多行</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">df.loc[[<span class="string">&#x27;语文&#x27;</span>, <span class="string">&#x27;英语&#x27;</span>]]</span><br></pre></td></tr></table></figure><p>结果：</p><table><thead><tr><th align="right"></th><th align="right">张三</th><th align="right">李四</th></tr></thead><tbody><tr><td align="right">语文</td><td align="right">77</td><td align="right">67</td></tr><tr><td align="right">英语</td><td align="right">99</td><td align="right">99</td></tr></tbody></table><h5 id="iloc"><a href="#iloc" class="headerlink" title="iloc"></a><code>iloc</code></h5><p>使用<code>.iloc[]</code>加整数来进行行索引(默认索引)</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">df.iloc[<span class="number">1</span>]</span><br></pre></td></tr></table></figure><p>结果：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">张三    <span class="number">88</span></span><br><span class="line">李四    <span class="number">88</span></span><br><span class="line">Name: 数学, dtype: int64</span><br></pre></td></tr></table></figure><p>多行索引</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">df.iloc[[<span class="number">1</span>,<span class="number">3</span>]]</span><br></pre></td></tr></table></figure><p>结果：</p><table><thead><tr><th align="right"></th><th align="right">张三</th><th align="right">李四</th></tr></thead><tbody><tr><td align="right">数学</td><td align="right">88</td><td align="right">88</td></tr><tr><td align="right">理综</td><td align="right">90</td><td align="right">78</td></tr></tbody></table><h4 id="元素索引"><a href="#元素索引" class="headerlink" title="元素索引"></a>元素索引</h4><p>行索引在前，列索引在后</p><h5 id="loc-1"><a href="#loc-1" class="headerlink" title="loc"></a><code>loc</code></h5><p>使用自定义索引获取，如：<code>df.loc[&#39;理综&#39;, &#39;李四&#39;]</code></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">df.loc[<span class="string">&#x27;理综&#x27;</span>, <span class="string">&#x27;李四&#x27;</span>]</span><br></pre></td></tr></table></figure><p>结果：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">78</span></span><br></pre></td></tr></table></figure><h5 id="iloc-1"><a href="#iloc-1" class="headerlink" title="iloc"></a><code>iloc</code></h5><p>使用默认索引获取， 如：<code>df.iloc[3, 1]</code></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">df.iloc[<span class="number">3</span>, <span class="number">1</span>]</span><br></pre></td></tr></table></figure><p>结果：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">78</span></span><br></pre></td></tr></table></figure><h3 id="DataFrame切片"><a href="#DataFrame切片" class="headerlink" title="DataFrame切片"></a><code>DataFrame</code>切片</h3><h5 id="中括号切片"><a href="#中括号切片" class="headerlink" title="中括号切片"></a>中括号切片</h5><p>直接使用中括号，是按行进行切分的，且只能按行切分，如：<code>df[0:2]</code></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">df[<span class="number">0</span>:<span class="number">2</span>]</span><br></pre></td></tr></table></figure><p>结果：</p><table><thead><tr><th align="right"></th><th align="right">张三</th><th align="right">李四</th></tr></thead><tbody><tr><td align="right">语文</td><td align="right">77</td><td align="right">67</td></tr><tr><td align="right">数学</td><td align="right">88</td><td align="right">88</td></tr></tbody></table><h5 id="iloc-2"><a href="#iloc-2" class="headerlink" title="iloc"></a><code>iloc</code></h5><p>默认按行进行切分，第1个参数为行区间，第二个参数为列区间，且区间范围使用默认索引，如：<code>df.iloc[1:2, 1:3]</code></p><h6 id="只切行"><a href="#只切行" class="headerlink" title="只切行"></a>只切行</h6><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">df.iloc[<span class="number">0</span>:<span class="number">2</span>]</span><br></pre></td></tr></table></figure><p>结果：</p><table><thead><tr><th align="right"></th><th align="right">张三</th><th align="right">李四</th></tr></thead><tbody><tr><td align="right">语文</td><td align="right">77</td><td align="right">67</td></tr><tr><td align="right">数学</td><td align="right">88</td><td align="right">88</td></tr></tbody></table><h6 id="只切列"><a href="#只切列" class="headerlink" title="只切列"></a>只切列</h6><p>默认第一个参数为行，如果只切列，行区间也要保留<code>:</code></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">df.iloc[:, <span class="number">1</span>:<span class="number">2</span>]</span><br></pre></td></tr></table></figure><p>结果：</p><table><thead><tr><th align="right"></th><th align="right">李四</th></tr></thead><tbody><tr><td align="right">语文</td><td align="right">67</td></tr><tr><td align="right">数学</td><td align="right">88</td></tr><tr><td align="right">英语</td><td align="right">99</td></tr><tr><td align="right">理综</td><td align="right">78</td></tr></tbody></table><h6 id="切行切列"><a href="#切行切列" class="headerlink" title="切行切列"></a>切行切列</h6><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">df.iloc[<span class="number">1</span>:<span class="number">3</span>, <span class="number">1</span>:<span class="number">2</span>]</span><br></pre></td></tr></table></figure><p>结果：</p><table><thead><tr><th align="right"></th><th align="right">李四</th></tr></thead><tbody><tr><td align="right">数学</td><td align="right">88</td></tr><tr><td align="right">英语</td><td align="right">99</td></tr></tbody></table><h5 id="loc-2"><a href="#loc-2" class="headerlink" title="loc"></a><code>loc</code></h5><p>默认按行进行切分，第1个参数为行区间，第二个参数为列区间，且区间范围使用自定义索引，如：<code>df.loc[&#39;语文&#39;:&#39;英语&#39;, &#39;张三&#39;:&#39;李四&#39;]</code></p><h6 id="只切行-1"><a href="#只切行-1" class="headerlink" title="只切行"></a>只切行</h6><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">df.loc[<span class="string">&#x27;语文&#x27;</span>:<span class="string">&#x27;数学&#x27;</span>]</span><br></pre></td></tr></table></figure><p>结果：</p><table><thead><tr><th align="right"></th><th align="right">张三</th><th align="right">李四</th></tr></thead><tbody><tr><td align="right">语文</td><td align="right">77</td><td align="right">67</td></tr><tr><td align="right">数学</td><td align="right">88</td><td align="right">88</td></tr></tbody></table><h6 id="只切列-1"><a href="#只切列-1" class="headerlink" title="只切列"></a>只切列</h6><p>默认第一个参数为行，如果只切列，行区间也要保留<code>:</code></p><p><strong>切单列</strong></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">df.loc[:, <span class="string">&#x27;李四&#x27;</span>]</span><br></pre></td></tr></table></figure><p>结果：</p><table><thead><tr><th align="right"></th><th align="right">李四</th></tr></thead><tbody><tr><td align="right">语文</td><td align="right">67</td></tr><tr><td align="right">数学</td><td align="right">88</td></tr><tr><td align="right">英语</td><td align="right">99</td></tr><tr><td align="right">理综</td><td align="right">78</td></tr></tbody></table><p><strong>切多列</strong></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">dic = &#123;</span><br><span class="line">    <span class="string">&#x27;张三&#x27;</span>:[<span class="number">77</span>,<span class="number">88</span>,<span class="number">99</span>,<span class="number">90</span>],</span><br><span class="line">    <span class="string">&#x27;李四&#x27;</span>:[<span class="number">67</span>,<span class="number">92</span>,<span class="number">97</span>,<span class="number">68</span>],</span><br><span class="line">    <span class="string">&#x27;王五&#x27;</span>:[<span class="number">83</span>,<span class="number">79</span>,<span class="number">91</span>,<span class="number">78</span>]</span><br><span class="line">&#125;</span><br><span class="line">df = DataFrame(data=dic,index=[<span class="string">&#x27;语文&#x27;</span>,<span class="string">&#x27;数学&#x27;</span>,<span class="string">&#x27;英语&#x27;</span>,<span class="string">&#x27;理综&#x27;</span>])</span><br><span class="line"></span><br><span class="line">df.loc[:, <span class="string">&#x27;张三&#x27;</span>:<span class="string">&#x27;李四&#x27;</span>]</span><br></pre></td></tr></table></figure><p>结果：</p><table><thead><tr><th align="right"></th><th align="right">张三</th><th align="right">李四</th></tr></thead><tbody><tr><td align="right">语文</td><td align="right">77</td><td align="right">67</td></tr><tr><td align="right">数学</td><td align="right">88</td><td align="right">92</td></tr><tr><td align="right">英语</td><td align="right">99</td><td align="right">97</td></tr><tr><td align="right">理综</td><td align="right">90</td><td align="right">68</td></tr></tbody></table><h6 id="切行切列-1"><a href="#切行切列-1" class="headerlink" title="切行切列"></a>切行切列</h6><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">dic = &#123;</span><br><span class="line">    <span class="string">&#x27;张三&#x27;</span>:[<span class="number">77</span>,<span class="number">88</span>,<span class="number">99</span>,<span class="number">90</span>],</span><br><span class="line">    <span class="string">&#x27;李四&#x27;</span>:[<span class="number">67</span>,<span class="number">92</span>,<span class="number">97</span>,<span class="number">68</span>],</span><br><span class="line">    <span class="string">&#x27;王五&#x27;</span>:[<span class="number">83</span>,<span class="number">79</span>,<span class="number">91</span>,<span class="number">78</span>]</span><br><span class="line">&#125;</span><br><span class="line">df = DataFrame(data=dic,index=[<span class="string">&#x27;语文&#x27;</span>,<span class="string">&#x27;数学&#x27;</span>,<span class="string">&#x27;英语&#x27;</span>,<span class="string">&#x27;理综&#x27;</span>])</span><br><span class="line"></span><br><span class="line">df.loc[<span class="string">&#x27;数学&#x27;</span>:<span class="string">&#x27;英语&#x27;</span>, <span class="string">&#x27;张三&#x27;</span>:<span class="string">&#x27;李四&#x27;</span>]</span><br></pre></td></tr></table></figure><p>结果：</p><table><thead><tr><th align="right"></th><th align="right">张三</th><th align="right">李四</th></tr></thead><tbody><tr><td align="right">数学</td><td align="right">88</td><td align="right">92</td></tr><tr><td align="right">英语</td><td align="right">99</td><td align="right">97</td></tr></tbody></table><h3 id="DataFrame运算"><a href="#DataFrame运算" class="headerlink" title="DataFrame运算"></a><code>DataFrame</code>运算</h3><h4 id="DataFrame之间运算"><a href="#DataFrame之间运算" class="headerlink" title="DataFrame之间运算"></a><code>DataFrame</code>之间运算</h4><p>同<code>Series</code>一样：</p><ul><li>在运算中自动对齐不同索引的数据</li><li>如果索引不对应，则补<code>NaN</code></li></ul><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">df1 = DataFrame(data=np.random.randint(<span class="number">1</span>, <span class="number">100</span>, size=[<span class="number">4</span>, <span class="number">3</span>]), index=[<span class="string">&#x27;a&#x27;</span>, <span class="string">&#x27;b&#x27;</span>, <span class="string">&#x27;c&#x27;</span>, <span class="string">&#x27;d&#x27;</span>], columns=[<span class="string">&#x27;aa&#x27;</span>, <span class="string">&#x27;bb&#x27;</span>, <span class="string">&#x27;cc&#x27;</span>])</span><br><span class="line">df2 = DataFrame(data=np.random.randint(<span class="number">1</span>, <span class="number">100</span>, size=[<span class="number">4</span>, <span class="number">3</span>]), index=[<span class="string">&#x27;a&#x27;</span>, <span class="string">&#x27;b&#x27;</span>, <span class="string">&#x27;c&#x27;</span>, <span class="string">&#x27;d&#x27;</span>], columns=[<span class="string">&#x27;bb&#x27;</span>, <span class="string">&#x27;dd&#x27;</span>, <span class="string">&#x27;aa&#x27;</span>])</span><br></pre></td></tr></table></figure><p><code>df1</code>：</p><table><thead><tr><th align="right"></th><th align="right">aa</th><th align="right">bb</th><th align="right">cc</th></tr></thead><tbody><tr><td align="right">a</td><td align="right">48</td><td align="right">48</td><td align="right">44</td></tr><tr><td align="right">b</td><td align="right">31</td><td align="right">53</td><td align="right">24</td></tr><tr><td align="right">c</td><td align="right">92</td><td align="right">71</td><td align="right">10</td></tr><tr><td align="right">d</td><td align="right">43</td><td align="right">62</td><td align="right">40</td></tr></tbody></table><p><code>df2</code>:</p><table><thead><tr><th align="right"></th><th align="right">bb</th><th align="right">dd</th><th align="right">aa</th></tr></thead><tbody><tr><td align="right">a</td><td align="right">34</td><td align="right">22</td><td align="right">60</td></tr><tr><td align="right">b</td><td align="right">25</td><td align="right">30</td><td align="right">21</td></tr><tr><td align="right">c</td><td align="right">41</td><td align="right">36</td><td align="right">13</td></tr><tr><td align="right">d</td><td align="right">45</td><td align="right">48</td><td align="right">50</td></tr></tbody></table><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">df1+df2</span><br></pre></td></tr></table></figure><p>结果为：</p><table><thead><tr><th align="right"></th><th align="right">aa</th><th align="right">bb</th><th align="right">cc</th><th align="right">dd</th></tr></thead><tbody><tr><td align="right">a</td><td align="right">108</td><td align="right">82</td><td align="right">NaN</td><td align="right">NaN</td></tr><tr><td align="right">b</td><td align="right">52</td><td align="right">78</td><td align="right">NaN</td><td align="right">NaN</td></tr><tr><td align="right">c</td><td align="right">105</td><td align="right">112</td><td align="right">NaN</td><td align="right">NaN</td></tr><tr><td align="right">d</td><td align="right">93</td><td align="right">107</td><td align="right">NaN</td><td align="right">NaN</td></tr></tbody></table><p>下面以一个示例来说明<code>DataFrame</code>的运算，要求如下：</p><ol><li>假设df1是期中考试成绩，df2是期末考试成绩，请自由创建df2，并将其与df1相加，求期中期末平均值。</li><li>假设张三期中考试数学被发现作弊，要记为0分，如何实现？</li><li>李四因为举报张三作弊立功，期中考试所有科目加100分，如何实现？</li><li>后来老师发现有一道题出错了，为了安抚学生情绪，给每位学生每个科目都加10分，如何实现？</li></ol><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 防止每次变化</span></span><br><span class="line">np.random.seed(<span class="number">2</span>)</span><br><span class="line">df1 = DataFrame(data=np.random.randint(<span class="number">80</span>, <span class="number">100</span>, size=[<span class="number">4</span>, <span class="number">3</span>]), index=[<span class="string">&#x27;语文&#x27;</span>, <span class="string">&#x27;数学&#x27;</span>, <span class="string">&#x27;英语&#x27;</span>, <span class="string">&#x27;开车&#x27;</span>], columns=[<span class="string">&#x27;张三&#x27;</span>, <span class="string">&#x27;李四&#x27;</span>, <span class="string">&#x27;王五&#x27;</span>])</span><br><span class="line">np.random.seed(<span class="number">2</span>)</span><br><span class="line">df2 = DataFrame(data=np.random.randint(<span class="number">75</span>, <span class="number">100</span>, size=[<span class="number">4</span>, <span class="number">3</span>]), index=[<span class="string">&#x27;语文&#x27;</span>, <span class="string">&#x27;数学&#x27;</span>, <span class="string">&#x27;英语&#x27;</span>, <span class="string">&#x27;开车&#x27;</span>], columns=[<span class="string">&#x27;张三&#x27;</span>, <span class="string">&#x27;李四&#x27;</span>, <span class="string">&#x27;王五&#x27;</span>])</span><br></pre></td></tr></table></figure><p>先看下两次考试结果，期中<code>df1</code>考试结果为：</p><table><thead><tr><th align="right"></th><th align="right">张三</th><th align="right">李四</th><th align="right">王五</th></tr></thead><tbody><tr><td align="right">语文</td><td align="right">88</td><td align="right">95</td><td align="right">93</td></tr><tr><td align="right">数学</td><td align="right">88</td><td align="right">91</td><td align="right">98</td></tr><tr><td align="right">英语</td><td align="right">91</td><td align="right">88</td><td align="right">87</td></tr><tr><td align="right">开车</td><td align="right">82</td><td align="right">97</td><td align="right">91</td></tr></tbody></table><p>期末<code>df2</code>考试结果为：</p><table><thead><tr><th align="right"></th><th align="right">张三</th><th align="right">李四</th><th align="right">王五</th></tr></thead><tbody><tr><td align="right">语文</td><td align="right">83</td><td align="right">90</td><td align="right">88</td></tr><tr><td align="right">数学</td><td align="right">83</td><td align="right">97</td><td align="right">86</td></tr><tr><td align="right">英语</td><td align="right">93</td><td align="right">86</td><td align="right">83</td></tr><tr><td align="right">开车</td><td align="right">82</td><td align="right">77</td><td align="right">92</td></tr></tbody></table><h4 id="求平均值"><a href="#求平均值" class="headerlink" title="求平均值"></a>求平均值</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"># 期中加期末除以2</span><br><span class="line">(df1+df2)&#x2F;2</span><br></pre></td></tr></table></figure><p>结果：</p><table><thead><tr><th align="right"></th><th align="right">张三</th><th align="right">李四</th><th align="right">王五</th></tr></thead><tbody><tr><td align="right">语文</td><td align="right">85.5</td><td align="right">92.5</td><td align="right">90.5</td></tr><tr><td align="right">数学</td><td align="right">85.5</td><td align="right">94.0</td><td align="right">92.0</td></tr><tr><td align="right">英语</td><td align="right">92.0</td><td align="right">87.0</td><td align="right">85.0</td></tr><tr><td align="right">开车</td><td align="right">82.0</td><td align="right">87.0</td><td align="right">91.5</td></tr></tbody></table><h4 id="张三期中数学0分"><a href="#张三期中数学0分" class="headerlink" title="张三期中数学0分"></a>张三期中数学0分</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">df1.loc[&#39;数学&#39;, &#39;张三&#39;] &#x3D; 0</span><br><span class="line"># 或者使用默认索引</span><br><span class="line"># df1.iloc[1,0] &#x3D; 0</span><br><span class="line">df1</span><br></pre></td></tr></table></figure><p>结果：</p><table><thead><tr><th align="right"></th><th align="right">张三</th><th align="right">李四</th><th align="right">王五</th></tr></thead><tbody><tr><td align="right">语文</td><td align="right">88</td><td align="right">95</td><td align="right">93</td></tr><tr><td align="right">数学</td><td align="right">0</td><td align="right">91</td><td align="right">98</td></tr><tr><td align="right">英语</td><td align="right">91</td><td align="right">88</td><td align="right">87</td></tr><tr><td align="right">开车</td><td align="right">82</td><td align="right">97</td><td align="right">91</td></tr></tbody></table><h4 id="李四期中所有加100"><a href="#李四期中所有加100" class="headerlink" title="李四期中所有加100"></a>李四期中所有加100</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">df1.loc[:, &#39;李四&#39;] +&#x3D; 100</span><br><span class="line"># 使用默认索引</span><br><span class="line"># df1.iloc[:, 1] +&#x3D; 100</span><br><span class="line">df1</span><br></pre></td></tr></table></figure><p>结果：</p><table><thead><tr><th align="right"></th><th align="right">张三</th><th align="right">李四</th><th align="right">王五</th></tr></thead><tbody><tr><td align="right">语文</td><td align="right">88</td><td align="right">195</td><td align="right">93</td></tr><tr><td align="right">数学</td><td align="right">0</td><td align="right">191</td><td align="right">98</td></tr><tr><td align="right">英语</td><td align="right">91</td><td align="right">188</td><td align="right">87</td></tr><tr><td align="right">开车</td><td align="right">82</td><td align="right">197</td><td align="right">91</td></tr></tbody></table><h4 id="期中全部加10"><a href="#期中全部加10" class="headerlink" title="期中全部加10"></a>期中全部加10</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">df1 +&#x3D; 10</span><br><span class="line">df1</span><br></pre></td></tr></table></figure><p>结果：</p><table><thead><tr><th align="right"></th><th align="right">张三</th><th align="right">李四</th><th align="right">王五</th></tr></thead><tbody><tr><td align="right">语文</td><td align="right">98</td><td align="right">205</td><td align="right">103</td></tr><tr><td align="right">数学</td><td align="right">10</td><td align="right">201</td><td align="right">108</td></tr><tr><td align="right">英语</td><td align="right">101</td><td align="right">198</td><td align="right">97</td></tr><tr><td align="right">开车</td><td align="right">92</td><td align="right">207</td><td align="right">101</td></tr></tbody></table><h3 id="删除重复元素"><a href="#删除重复元素" class="headerlink" title="删除重复元素"></a>删除重复元素</h3><p>使用duplicated()函数检测重复的行，返回元素为布尔类型的Series对象，每个元素对应一行，如果该行不是第一次出现，则元素为True</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"><span class="keyword">from</span> pandas <span class="keyword">import</span> DataFrame, Series</span><br><span class="line"><span class="comment">#创建一个df</span></span><br><span class="line">np.random.seed(<span class="number">2</span>)</span><br><span class="line">df = DataFrame(data=np.random.randint(<span class="number">1</span>, <span class="number">100</span>, size=[<span class="number">7</span>, <span class="number">3</span>]), index=[<span class="string">&#x27;a&#x27;</span>, <span class="string">&#x27;b&#x27;</span>, <span class="string">&#x27;c&#x27;</span>, <span class="string">&#x27;d&#x27;</span>, <span class="string">&#x27;e&#x27;</span>, <span class="string">&#x27;f&#x27;</span>, <span class="string">&#x27;g&#x27;</span>], columns=[<span class="string">&#x27;aa&#x27;</span>, <span class="string">&#x27;bb&#x27;</span>, <span class="string">&#x27;cc&#x27;</span>])</span><br><span class="line"><span class="comment">#手动将df的某几行设置成相同的内容</span></span><br><span class="line">df.loc[[<span class="string">&#x27;b&#x27;</span>, <span class="string">&#x27;d&#x27;</span>, <span class="string">&#x27;f&#x27;</span>]] = <span class="number">888</span></span><br><span class="line">print(df)</span><br></pre></td></tr></table></figure><p>结果：</p><table><thead><tr><th align="right"></th><th align="right">aa</th><th align="right">bb</th><th align="right">cc</th></tr></thead><tbody><tr><td align="right">a</td><td align="right">41</td><td align="right">16</td><td align="right">73</td></tr><tr><td align="right">b</td><td align="right">888</td><td align="right">888</td><td align="right">888</td></tr><tr><td align="right">c</td><td align="right">76</td><td align="right">8</td><td align="right">35</td></tr><tr><td align="right">d</td><td align="right">888</td><td align="right">888</td><td align="right">888</td></tr><tr><td align="right">e</td><td align="right">86</td><td align="right">48</td><td align="right">64</td></tr><tr><td align="right">f</td><td align="right">888</td><td align="right">888</td><td align="right">888</td></tr><tr><td align="right">g</td><td align="right">38</td><td align="right">40</td><td align="right">68</td></tr></tbody></table><p>使用duplicated查看所有重复元素行</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># keep代表保留某些行，可选有first、last、False分别代表保留首行重复行、末行重复行，不保留任何重复行</span></span><br><span class="line">duplicate_rows = df.duplicated(keep=<span class="literal">False</span>)</span><br><span class="line">print(duplicate_rows)</span><br></pre></td></tr></table></figure><p>结果：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">a    <span class="literal">False</span></span><br><span class="line">b     <span class="literal">True</span></span><br><span class="line">c    <span class="literal">False</span></span><br><span class="line">d     <span class="literal">True</span></span><br><span class="line">e    <span class="literal">False</span></span><br><span class="line">f     <span class="literal">True</span></span><br><span class="line">g    <span class="literal">False</span></span><br><span class="line">dtype: bool</span><br></pre></td></tr></table></figure><p>获取重复行的索引</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">duplicate_rows_index = df.loc[duplicate_rows].index</span><br><span class="line">print(duplicate_rows_index)</span><br></pre></td></tr></table></figure><p>结果：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Index([<span class="string">&#x27;b&#x27;</span>, <span class="string">&#x27;d&#x27;</span>, <span class="string">&#x27;f&#x27;</span>], dtype=<span class="string">&#x27;object&#x27;</span>)</span><br></pre></td></tr></table></figure><p>根据重复行索引，删除行</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 根据索引删除行，axis=0代表行</span></span><br><span class="line">df.drop(labels=duplicate_rows_index, axis=<span class="number">0</span>)</span><br></pre></td></tr></table></figure><p>结果：</p><table><thead><tr><th align="right"></th><th align="right">aa</th><th align="right">bb</th><th align="right">cc</th></tr></thead><tbody><tr><td align="right">a</td><td align="right">41</td><td align="right">16</td><td align="right">73</td></tr><tr><td align="right">c</td><td align="right">76</td><td align="right">8</td><td align="right">35</td></tr><tr><td align="right">e</td><td align="right">86</td><td align="right">48</td><td align="right">64</td></tr><tr><td align="right">g</td><td align="right">38</td><td align="right">40</td><td align="right">68</td></tr></tbody></table><h3 id="使用drop-duplicates"><a href="#使用drop-duplicates" class="headerlink" title="使用drop_duplicates"></a>使用<code>drop_duplicates</code></h3><p>df原始数据：</p><table><thead><tr><th align="right"></th><th align="right">aa</th><th align="right">bb</th><th align="right">cc</th></tr></thead><tbody><tr><td align="right">a</td><td align="right">41</td><td align="right">16</td><td align="right">73</td></tr><tr><td align="right">b</td><td align="right">888</td><td align="right">888</td><td align="right">888</td></tr><tr><td align="right">c</td><td align="right">76</td><td align="right">8</td><td align="right">35</td></tr><tr><td align="right">d</td><td align="right">888</td><td align="right">888</td><td align="right">888</td></tr><tr><td align="right">e</td><td align="right">86</td><td align="right">48</td><td align="right">64</td></tr><tr><td align="right">f</td><td align="right">888</td><td align="right">888</td><td align="right">888</td></tr><tr><td align="right">g</td><td align="right">38</td><td align="right">40</td><td align="right">68</td></tr></tbody></table><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 不保留任何重复行</span></span><br><span class="line">df.drop_duplicates(keep=<span class="literal">False</span>)</span><br></pre></td></tr></table></figure><p>结果：<br>| | aa | bb | cc |<br>| —: | —: | —: | —: |<br>| a | 41 | 16 | 73 |<br>| c | 76 | 8 | 35 |<br>| e | 86 | 48 | 64 |<br>| g | 38 | 40 | 68 |</p><h3 id="映射"><a href="#映射" class="headerlink" title="映射"></a>映射</h3><h4 id="replace-函数"><a href="#replace-函数" class="headerlink" title="replace()函数"></a><code>replace()</code>函数</h4><p>替换元素-replace()函数：替换元素。使用replace()函数，对values进行映射操作</p><p>语法：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">df.replace(</span><br><span class="line">    to_replace&#x3D;None, # 要替换的值</span><br><span class="line">    value&#x3D;None,			# 替换后的值</span><br><span class="line">    inplace&#x3D;False		# 是否作用于原对象还是返回新对象</span><br><span class="line">)</span><br></pre></td></tr></table></figure><h5 id="Series替换操作"><a href="#Series替换操作" class="headerlink" title="Series替换操作"></a><code>Series</code>替换操作</h5><ul><li>单值替换<ul><li>普通替换</li><li>字典替换(推荐）</li></ul></li><li>多值替换<ul><li>列表替换</li><li>字典替换（推荐）</li></ul></li><li>参数<ul><li>to_replace:被替换的元素</li></ul></li></ul><h5 id="DataFrame替换操作"><a href="#DataFrame替换操作" class="headerlink" title="DataFrame替换操作"></a><code>DataFrame</code>替换操作</h5><ul><li><p>单值替换</p><ul><li>普通替换： 替换所有符合要求的元素:<code>to_replace=15</code>,<code>value=&#39;e&#39;</code></li><li>按列指定单值替换： <code>to_replace=&#123;列标签：替换值&#125;</code> <code>value=&#39;value&#39;</code></li></ul></li><li><p>多值替换</p><ul><li>列表替换: <code>to_replace=[] value=[]</code></li><li>字典替换（推荐） <code>to_replace=&#123;to_replace:value,to_replace:value&#125;</code></li></ul></li></ul><h5 id="示例"><a href="#示例" class="headerlink" title="示例"></a>示例</h5><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span>s = pd.Series([<span class="number">0</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>])</span><br><span class="line"></span><br><span class="line"><span class="number">0</span>修改为<span class="number">5</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>s.replace(<span class="number">0</span>, <span class="number">5</span>)</span><br><span class="line"><span class="number">0</span>    <span class="number">5</span></span><br><span class="line"><span class="number">1</span>    <span class="number">1</span></span><br><span class="line"><span class="number">2</span>    <span class="number">2</span></span><br><span class="line"><span class="number">3</span>    <span class="number">3</span></span><br><span class="line"><span class="number">4</span>    <span class="number">4</span></span><br><span class="line">dtype: int64</span><br><span class="line"></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>df = pd.DataFrame(&#123;<span class="string">&#x27;A&#x27;</span>: [<span class="number">0</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>],</span><br><span class="line"><span class="meta">... </span>                   <span class="string">&#x27;B&#x27;</span>: [<span class="number">5</span>, <span class="number">6</span>, <span class="number">7</span>, <span class="number">8</span>, <span class="number">9</span>],</span><br><span class="line"><span class="meta">... </span>                   <span class="string">&#x27;C&#x27;</span>: [<span class="string">&#x27;a&#x27;</span>, <span class="string">&#x27;b&#x27;</span>, <span class="string">&#x27;c&#x27;</span>, <span class="string">&#x27;d&#x27;</span>, <span class="string">&#x27;e&#x27;</span>]&#125;)</span><br><span class="line"><span class="number">0</span>修改为<span class="number">5</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>df.replace(<span class="number">0</span>, <span class="number">5</span>)</span><br><span class="line">   A  B  C</span><br><span class="line"><span class="number">0</span>  <span class="number">5</span>  <span class="number">5</span>  a</span><br><span class="line"><span class="number">1</span>  <span class="number">1</span>  <span class="number">6</span>  b</span><br><span class="line"><span class="number">2</span>  <span class="number">2</span>  <span class="number">7</span>  c</span><br><span class="line"><span class="number">3</span>  <span class="number">3</span>  <span class="number">8</span>  d</span><br><span class="line"><span class="number">4</span>  <span class="number">4</span>  <span class="number">9</span>  e</span><br><span class="line"></span><br><span class="line">**List-like `to_replace`**</span><br><span class="line"></span><br><span class="line">将<span class="number">0</span>/<span class="number">1</span>/<span class="number">2</span>/<span class="number">3</span>都修改为<span class="number">4</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>df.replace([<span class="number">0</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>], <span class="number">4</span>)</span><br><span class="line">   A  B  C</span><br><span class="line"><span class="number">0</span>  <span class="number">4</span>  <span class="number">5</span>  a</span><br><span class="line"><span class="number">1</span>  <span class="number">4</span>  <span class="number">6</span>  b</span><br><span class="line"><span class="number">2</span>  <span class="number">4</span>  <span class="number">7</span>  c</span><br><span class="line"><span class="number">3</span>  <span class="number">4</span>  <span class="number">8</span>  d</span><br><span class="line"><span class="number">4</span>  <span class="number">4</span>  <span class="number">9</span>  e</span><br><span class="line"></span><br><span class="line">将<span class="number">0</span>/<span class="number">1</span>/<span class="number">2</span>/<span class="number">3</span>依次修改为<span class="number">4</span>/<span class="number">3</span>/<span class="number">2</span>/<span class="number">1</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>df.replace([<span class="number">0</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>], [<span class="number">4</span>, <span class="number">3</span>, <span class="number">2</span>, <span class="number">1</span>])</span><br><span class="line">   A  B  C</span><br><span class="line"><span class="number">0</span>  <span class="number">4</span>  <span class="number">5</span>  a</span><br><span class="line"><span class="number">1</span>  <span class="number">3</span>  <span class="number">6</span>  b</span><br><span class="line"><span class="number">2</span>  <span class="number">2</span>  <span class="number">7</span>  c</span><br><span class="line"><span class="number">3</span>  <span class="number">1</span>  <span class="number">8</span>  d</span><br><span class="line"><span class="number">4</span>  <span class="number">4</span>  <span class="number">9</span>  e</span><br><span class="line"></span><br><span class="line">将<span class="number">1</span>/<span class="number">2</span>替换为所在元素下一行当前列的元素，bfill代表上一行当前列对应的元素</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>s.replace([<span class="number">1</span>, <span class="number">2</span>], method=<span class="string">&#x27;bfill&#x27;</span>)</span><br><span class="line"><span class="number">0</span>    <span class="number">0</span></span><br><span class="line"><span class="number">1</span>    <span class="number">3</span></span><br><span class="line"><span class="number">2</span>    <span class="number">3</span></span><br><span class="line"><span class="number">3</span>    <span class="number">3</span></span><br><span class="line"><span class="number">4</span>    <span class="number">4</span></span><br><span class="line">dtype: int64</span><br><span class="line"></span><br><span class="line">**dict-like `to_replace`**</span><br><span class="line">将<span class="number">0</span>替换为<span class="number">10</span>， <span class="number">1</span>替换为<span class="number">100</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>df.replace(&#123;<span class="number">0</span>: <span class="number">10</span>, <span class="number">1</span>: <span class="number">100</span>&#125;)</span><br><span class="line">     A  B  C</span><br><span class="line"><span class="number">0</span>   <span class="number">10</span>  <span class="number">5</span>  a</span><br><span class="line"><span class="number">1</span>  <span class="number">100</span>  <span class="number">6</span>  b</span><br><span class="line"><span class="number">2</span>    <span class="number">2</span>  <span class="number">7</span>  c</span><br><span class="line"><span class="number">3</span>    <span class="number">3</span>  <span class="number">8</span>  d</span><br><span class="line"><span class="number">4</span>    <span class="number">4</span>  <span class="number">9</span>  e</span><br><span class="line">将A列中<span class="number">0</span>和B列中<span class="number">5</span>替换为<span class="number">100</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>df.replace(&#123;<span class="string">&#x27;A&#x27;</span>: <span class="number">0</span>, <span class="string">&#x27;B&#x27;</span>: <span class="number">5</span>&#125;, <span class="number">100</span>)</span><br><span class="line">     A    B  C</span><br><span class="line"><span class="number">0</span>  <span class="number">100</span>  <span class="number">100</span>  a</span><br><span class="line"><span class="number">1</span>    <span class="number">1</span>    <span class="number">6</span>  b</span><br><span class="line"><span class="number">2</span>    <span class="number">2</span>    <span class="number">7</span>  c</span><br><span class="line"><span class="number">3</span>    <span class="number">3</span>    <span class="number">8</span>  d</span><br><span class="line"><span class="number">4</span>    <span class="number">4</span>    <span class="number">9</span>  e</span><br><span class="line">将A列中的<span class="number">0</span>替换为<span class="number">100</span>，<span class="number">4</span>替换为<span class="number">400</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>df.replace(&#123;<span class="string">&#x27;A&#x27;</span>: &#123;<span class="number">0</span>: <span class="number">100</span>, <span class="number">4</span>: <span class="number">400</span>&#125;&#125;)</span><br><span class="line">     A  B  C</span><br><span class="line"><span class="number">0</span>  <span class="number">100</span>  <span class="number">5</span>  a</span><br><span class="line"><span class="number">1</span>    <span class="number">1</span>  <span class="number">6</span>  b</span><br><span class="line"><span class="number">2</span>    <span class="number">2</span>  <span class="number">7</span>  c</span><br><span class="line"><span class="number">3</span>    <span class="number">3</span>  <span class="number">8</span>  d</span><br><span class="line"><span class="number">4</span>  <span class="number">400</span>  <span class="number">9</span>  e</span><br><span class="line"></span><br><span class="line">**Regular expression `to_replace`**</span><br><span class="line"></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>df = pd.DataFrame(&#123;<span class="string">&#x27;A&#x27;</span>: [<span class="string">&#x27;bat&#x27;</span>, <span class="string">&#x27;foo&#x27;</span>, <span class="string">&#x27;bait&#x27;</span>],</span><br><span class="line"><span class="meta">... </span>                   <span class="string">&#x27;B&#x27;</span>: [<span class="string">&#x27;abc&#x27;</span>, <span class="string">&#x27;bar&#x27;</span>, <span class="string">&#x27;xyz&#x27;</span>]&#125;)</span><br><span class="line">将元素值ba开头且<span class="number">3</span>位字母结束的值替换为new</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>df.replace(to_replace=<span class="string">r&#x27;^ba.$&#x27;</span>, value=<span class="string">&#x27;new&#x27;</span>, regex=<span class="literal">True</span>)</span><br><span class="line">      A    B</span><br><span class="line"><span class="number">0</span>   new  abc</span><br><span class="line"><span class="number">1</span>   foo  new</span><br><span class="line"><span class="number">2</span>  bait  xyz</span><br><span class="line">将A列中元素值ba开头且<span class="number">3</span>位字母结束的值替换为new</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>df.replace(&#123;<span class="string">&#x27;A&#x27;</span>: <span class="string">r&#x27;^ba.$&#x27;</span>&#125;, &#123;<span class="string">&#x27;A&#x27;</span>: <span class="string">&#x27;new&#x27;</span>&#125;, regex=<span class="literal">True</span>)</span><br><span class="line">      A    B</span><br><span class="line"><span class="number">0</span>   new  abc</span><br><span class="line"><span class="number">1</span>   foo  bar</span><br><span class="line"><span class="number">2</span>  bait  xyz</span><br><span class="line">将元素值ba开头且<span class="number">3</span>位字母结束的值替换为new</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>df.replace(regex=<span class="string">r&#x27;^ba.$&#x27;</span>, value=<span class="string">&#x27;new&#x27;</span>)</span><br><span class="line">      A    B</span><br><span class="line"><span class="number">0</span>   new  abc</span><br><span class="line"><span class="number">1</span>   foo  new</span><br><span class="line"><span class="number">2</span>  bait  xyz</span><br><span class="line">将元素值ba开头且<span class="number">3</span>位字母结束的值替换为new，foo替换为xyz</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>df.replace(regex=&#123;<span class="string">r&#x27;^ba.$&#x27;</span>: <span class="string">&#x27;new&#x27;</span>, <span class="string">&#x27;foo&#x27;</span>: <span class="string">&#x27;xyz&#x27;</span>&#125;)</span><br><span class="line">      A    B</span><br><span class="line"><span class="number">0</span>   new  abc</span><br><span class="line"><span class="number">1</span>   xyz  new</span><br><span class="line"><span class="number">2</span>  bait  xyz</span><br><span class="line">将元素值ba开头且<span class="number">3</span>位字母结束的值和职位foo的元素替换为new</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>df.replace(regex=[<span class="string">r&#x27;^ba.$&#x27;</span>, <span class="string">&#x27;foo&#x27;</span>], value=<span class="string">&#x27;new&#x27;</span>)</span><br><span class="line">      A    B</span><br><span class="line"><span class="number">0</span>   new  abc</span><br><span class="line"><span class="number">1</span>   new  new</span><br><span class="line"><span class="number">2</span>  bait  xyz</span><br></pre></td></tr></table></figure><h4 id="map-函数"><a href="#map-函数" class="headerlink" title="map()函数"></a><code>map()</code>函数</h4><p>新建一列 ， <code>map</code>函数并不是<code>df</code>的方法，而是<code>series</code>的方法</p><ul><li><p><code>map()</code>可以映射新一列数据</p></li><li><p><code>map()</code>中可以使用<code>lambda</code>表达式</p></li><li><p><code>map()</code>中可以使用方法，可以是自定义的方法</p><p><code>eg:map(&#123;to_replace:value&#125;)</code></p></li><li><p><strong>注意</strong> <code>map()</code>中不能使用<code>sum</code>之类的函数，<code>for</code>循环；并不是任何形式的函数都可以作为map的参数。只有当一个函数具有一个参数且有返回值，那么该函数才可以作为map的参数。</p></li></ul><h5 id="示例-1"><a href="#示例-1" class="headerlink" title="示例"></a>示例</h5><h6 id="原始数据"><a href="#原始数据" class="headerlink" title="原始数据"></a>原始数据</h6><p>人员对应工资表</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">np.random.seed(<span class="number">2</span>)</span><br><span class="line">dic=&#123;</span><br><span class="line">    <span class="string">&#x27;name&#x27;</span>:[<span class="string">&#x27;JAY&#x27;</span>, <span class="string">&#x27;TONY&#x27;</span>, <span class="string">&#x27;DAVID&#x27;</span>],</span><br><span class="line">    <span class="string">&#x27;salary&#x27;</span>: np.random.randint(<span class="number">9000</span>, <span class="number">500000</span>, size=<span class="number">3</span>)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">df = DataFrame(data=dic)</span><br><span class="line">df</span><br></pre></td></tr></table></figure><p>结果：</p><table><thead><tr><th align="right"></th><th align="right">name</th><th align="right">salary</th></tr></thead><tbody><tr><td align="right">0</td><td align="right">JAY</td><td align="right">360400</td></tr><tr><td align="right">1</td><td align="right">TONY</td><td align="right">109879</td></tr><tr><td align="right">2</td><td align="right">DAVID</td><td align="right">212245</td></tr></tbody></table><h6 id="添加对应中文名"><a href="#添加对应中文名" class="headerlink" title="添加对应中文名"></a>添加对应中文名</h6><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"># 添加中文名</span><br><span class="line">cname &#x3D; &#123;</span><br><span class="line">    &#39;JAY&#39; : &#39;周杰伦&#39;,</span><br><span class="line">    &#39;TONY&#39;: &#39;托小尼&#39;,</span><br><span class="line">    &#39;DAVID&#39;: &#39;大卫&#39;</span><br><span class="line">&#125;</span><br><span class="line">df[&#39;cname&#39;] &#x3D; df[&#39;name&#39;].map(cname)</span><br><span class="line">df</span><br></pre></td></tr></table></figure><p>结果：</p><table><thead><tr><th align="right"></th><th align="right">name</th><th align="right">salary</th><th align="right">cname</th></tr></thead><tbody><tr><td align="right">0</td><td align="right">JAY</td><td align="right">360400</td><td align="right">周杰伦</td></tr><tr><td align="right">1</td><td align="right">TONY</td><td align="right">109879</td><td align="right">托小尼</td></tr><tr><td align="right">2</td><td align="right">DAVID</td><td align="right">212245</td><td align="right">大卫</td></tr></tbody></table><h6 id="增加税后工资"><a href="#增加税后工资" class="headerlink" title="增加税后工资"></a>增加税后工资</h6><p>工资超过20万，交20%的税，添加税后工资列</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 工资大于200000交20%税，税后工资</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">calc_salary</span>(<span class="params">salary</span>):</span></span><br><span class="line">    <span class="keyword">if</span> salary &gt; <span class="number">200000</span>:</span><br><span class="line">        salary = salary - salary * <span class="number">0.2</span></span><br><span class="line">    <span class="keyword">return</span> salary</span><br><span class="line"></span><br><span class="line">df[<span class="string">&#x27;after_salary&#x27;</span>] = df[<span class="string">&#x27;salary&#x27;</span>].map(calc_salary)</span><br><span class="line">df</span><br></pre></td></tr></table></figure><p>结果：</p><table><thead><tr><th align="right"></th><th align="right">name</th><th align="right">salary</th><th align="right">cname</th><th align="right">after_salary</th></tr></thead><tbody><tr><td align="right">0</td><td align="right">JAY</td><td align="right">360400</td><td align="right">周杰伦</td><td align="right">288320.0</td></tr><tr><td align="right">1</td><td align="right">TONY</td><td align="right">109879</td><td align="right">托小尼</td><td align="right">109879.0</td></tr><tr><td align="right">2</td><td align="right">DAVID</td><td align="right">212245</td><td align="right">大卫</td><td align="right">169796.0</td></tr></tbody></table><h6 id="匿名函数计算工资"><a href="#匿名函数计算工资" class="headerlink" title="匿名函数计算工资"></a>匿名函数计算工资</h6><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">df[<span class="string">&#x27;after_salary1&#x27;</span>] = df[<span class="string">&#x27;salary&#x27;</span>].map(<span class="keyword">lambda</span> x: x - x * <span class="number">0.2</span> <span class="keyword">if</span> x&gt;<span class="number">200000</span> <span class="keyword">else</span> x)</span><br><span class="line">df</span><br></pre></td></tr></table></figure><p>结果：</p><table><thead><tr><th align="right"></th><th align="right">name</th><th align="right">salary</th><th align="right">cname</th><th align="right">after_salary</th><th align="right">after_salary1</th></tr></thead><tbody><tr><td align="right">0</td><td align="right">JAY</td><td align="right">360400</td><td align="right">周杰伦</td><td align="right">288320.0</td><td align="right">288320.0</td></tr><tr><td align="right">1</td><td align="right">TONY</td><td align="right">109879</td><td align="right">托小尼</td><td align="right">109879.0</td><td align="right">109879.0</td></tr><tr><td align="right">2</td><td align="right">DAVID</td><td align="right">212245</td><td align="right">大卫</td><td align="right">169796.0</td><td align="right">169796.0</td></tr></tbody></table><h5 id="Series-map示例"><a href="#Series-map示例" class="headerlink" title="Series map示例"></a>Series map示例</h5><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 创建Series</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>s = pd.Series([<span class="string">&#x27;cat&#x27;</span>, <span class="string">&#x27;dog&#x27;</span>, np.nan, <span class="string">&#x27;rabbit&#x27;</span>])</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>s</span><br><span class="line"><span class="number">0</span>      cat</span><br><span class="line"><span class="number">1</span>      dog</span><br><span class="line"><span class="number">2</span>      NaN</span><br><span class="line"><span class="number">3</span>   rabbit</span><br><span class="line">dtype: object</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># 使用字典映射替换为对应的值，没有被字典中映射的值将赋为NaN</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>s.map(&#123;<span class="string">&#x27;cat&#x27;</span>: <span class="string">&#x27;kitten&#x27;</span>, <span class="string">&#x27;dog&#x27;</span>: <span class="string">&#x27;puppy&#x27;</span>&#125;)</span><br><span class="line"><span class="number">0</span>   kitten</span><br><span class="line"><span class="number">1</span>    puppy</span><br><span class="line"><span class="number">2</span>      NaN</span><br><span class="line"><span class="number">3</span>      NaN</span><br><span class="line">dtype: object</span><br><span class="line"></span><br><span class="line"><span class="comment"># 类似循环映射原始Series每个值到字符串</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>s.map(<span class="string">&#x27;I am a &#123;&#125;&#x27;</span>.format)</span><br><span class="line"><span class="number">0</span>       I am a cat</span><br><span class="line"><span class="number">1</span>       I am a dog</span><br><span class="line"><span class="number">2</span>       I am a nan</span><br><span class="line"><span class="number">3</span>    I am a rabbit</span><br><span class="line">dtype: object</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># 如果na_action设置为ignore，将忽略该次映射关系</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>s.map(<span class="string">&#x27;I am a &#123;&#125;&#x27;</span>.format, na_action=<span class="string">&#x27;ignore&#x27;</span>)</span><br><span class="line"><span class="number">0</span>     I am a cat</span><br><span class="line"><span class="number">1</span>     I am a dog</span><br><span class="line"><span class="number">2</span>            NaN</span><br><span class="line"><span class="number">3</span>  I am a rabbit</span><br></pre></td></tr></table></figure><h4 id="异常值过滤"><a href="#异常值过滤" class="headerlink" title="异常值过滤"></a>异常值过滤</h4><p>过滤掉以下<code>DataFrame</code>中cc列中元素小于cc列平均值的元素所在行</p><h5 id="创建DataFrame"><a href="#创建DataFrame" class="headerlink" title="创建DataFrame"></a>创建<code>DataFrame</code></h5><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">np.random.seed(<span class="number">3</span>)</span><br><span class="line">df = DataFrame(data=np.random.randint(<span class="number">1</span>, <span class="number">10</span>, size=[<span class="number">5</span>, <span class="number">3</span>]), columns=[<span class="string">&#x27;aa&#x27;</span>, <span class="string">&#x27;bb&#x27;</span>, <span class="string">&#x27;cc&#x27;</span>], index=[<span class="string">&#x27;a&#x27;</span>, <span class="string">&#x27;b&#x27;</span>, <span class="string">&#x27;c&#x27;</span>, <span class="string">&#x27;d&#x27;</span>, <span class="string">&#x27;e&#x27;</span>])</span><br><span class="line">df</span><br></pre></td></tr></table></figure><p>结果：</p><table><thead><tr><th align="right"></th><th align="right">aa</th><th align="right">bb</th><th align="right">cc</th></tr></thead><tbody><tr><td align="right">a</td><td align="right">9</td><td align="right">4</td><td align="right">9</td></tr><tr><td align="right">b</td><td align="right">9</td><td align="right">1</td><td align="right">6</td></tr><tr><td align="right">c</td><td align="right">4</td><td align="right">6</td><td align="right">8</td></tr><tr><td align="right">d</td><td align="right">7</td><td align="right">1</td><td align="right">5</td></tr><tr><td align="right">e</td><td align="right">8</td><td align="right">9</td><td align="right">2</td></tr></tbody></table><h5 id="检测平均值"><a href="#检测平均值" class="headerlink" title="检测平均值"></a>检测平均值</h5><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 过滤掉bb列元素小于当前列平均值的元素</span></span><br><span class="line"><span class="comment"># 计算cc列平均值，平均值为6.0</span></span><br><span class="line">cc_avg = df[<span class="string">&#x27;cc&#x27;</span>].mean()</span><br><span class="line"><span class="comment"># 检测cc列元素不小于平均值</span></span><br><span class="line">ret = df[<span class="string">&#x27;cc&#x27;</span>]&gt;=cc_avg</span><br><span class="line">ret</span><br></pre></td></tr></table></figure><p>结果：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">a     <span class="literal">True</span></span><br><span class="line">b     <span class="literal">True</span></span><br><span class="line">c     <span class="literal">True</span></span><br><span class="line">d    <span class="literal">False</span></span><br><span class="line">e    <span class="literal">False</span></span><br><span class="line">Name: cc, dtype: bool</span><br></pre></td></tr></table></figure><h5 id="过滤结果"><a href="#过滤结果" class="headerlink" title="过滤结果"></a>过滤结果</h5><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">df.loc[ret]</span><br></pre></td></tr></table></figure><p>结果：</p><table><thead><tr><th align="right"></th><th align="right">aa</th><th align="right">bb</th><th align="right">cc</th></tr></thead><tbody><tr><td align="right">a</td><td align="right">9</td><td align="right">4</td><td align="right">9</td></tr><tr><td align="right">b</td><td align="right">9</td><td align="right">1</td><td align="right">6</td></tr><tr><td align="right">c</td><td align="right">4</td><td align="right">6</td><td align="right">8</td></tr></tbody></table><h4 id="随机抽样"><a href="#随机抽样" class="headerlink" title="随机抽样"></a>随机抽样</h4><p>用于随机抽取其中的部分样本</p><h5 id="take"><a href="#take" class="headerlink" title="take"></a>take</h5><ul><li><code>take()</code>函数接受一个索引列表，用数字表示,使得<code>df</code>根据列表中索引的顺序进行排序</li><li><code>eg</code>:<code>df.take([1,3,4,2,5])</code></li></ul><h6 id="原始数列"><a href="#原始数列" class="headerlink" title="原始数列"></a>原始数列</h6><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">np.random.seed(<span class="number">2</span>)</span><br><span class="line">df = DataFrame(data=np.random.randint(<span class="number">1</span>, <span class="number">100</span>, size=[<span class="number">20</span>, <span class="number">5</span>]), columns=[<span class="string">&#x27;a&#x27;</span>, <span class="string">&#x27;b&#x27;</span>, <span class="string">&#x27;c&#x27;</span>, <span class="string">&#x27;d&#x27;</span>, <span class="string">&#x27;e&#x27;</span>])</span><br><span class="line">df</span><br></pre></td></tr></table></figure><table><thead><tr><th align="right"></th><th align="right">a</th><th align="right">b</th><th align="right">c</th><th align="right">d</th><th align="right">e</th></tr></thead><tbody><tr><td align="right">0</td><td align="right">41</td><td align="right">16</td><td align="right">73</td><td align="right">23</td><td align="right">44</td></tr><tr><td align="right">1</td><td align="right">83</td><td align="right">76</td><td align="right">8</td><td align="right">35</td><td align="right">50</td></tr><tr><td align="right">2</td><td align="right">96</td><td align="right">76</td><td align="right">86</td><td align="right">48</td><td align="right">64</td></tr><tr><td align="right">3</td><td align="right">32</td><td align="right">91</td><td align="right">21</td><td align="right">38</td><td align="right">40</td></tr><tr><td align="right">4</td><td align="right">68</td><td align="right">5</td><td align="right">43</td><td align="right">52</td><td align="right">39</td></tr><tr><td align="right">5</td><td align="right">34</td><td align="right">59</td><td align="right">68</td><td align="right">70</td><td align="right">89</td></tr><tr><td align="right">6</td><td align="right">69</td><td align="right">47</td><td align="right">71</td><td align="right">96</td><td align="right">84</td></tr><tr><td align="right">7</td><td align="right">32</td><td align="right">67</td><td align="right">81</td><td align="right">53</td><td align="right">77</td></tr><tr><td align="right">8</td><td align="right">51</td><td align="right">5</td><td align="right">91</td><td align="right">64</td><td align="right">80</td></tr><tr><td align="right">9</td><td align="right">50</td><td align="right">40</td><td align="right">47</td><td align="right">9</td><td align="right">51</td></tr><tr><td align="right">10</td><td align="right">16</td><td align="right">9</td><td align="right">18</td><td align="right">23</td><td align="right">74</td></tr><tr><td align="right">11</td><td align="right">58</td><td align="right">91</td><td align="right">63</td><td align="right">84</td><td align="right">97</td></tr><tr><td align="right">12</td><td align="right">44</td><td align="right">33</td><td align="right">27</td><td align="right">9</td><td align="right">77</td></tr><tr><td align="right">13</td><td align="right">11</td><td align="right">41</td><td align="right">35</td><td align="right">61</td><td align="right">10</td></tr><tr><td align="right">14</td><td align="right">71</td><td align="right">87</td><td align="right">71</td><td align="right">20</td><td align="right">57</td></tr><tr><td align="right">15</td><td align="right">83</td><td align="right">2</td><td align="right">69</td><td align="right">41</td><td align="right">82</td></tr><tr><td align="right">16</td><td align="right">62</td><td align="right">71</td><td align="right">98</td><td align="right">19</td><td align="right">85</td></tr><tr><td align="right">17</td><td align="right">91</td><td align="right">88</td><td align="right">23</td><td align="right">44</td><td align="right">53</td></tr><tr><td align="right">18</td><td align="right">75</td><td align="right">73</td><td align="right">91</td><td align="right">92</td><td align="right">97</td></tr><tr><td align="right">19</td><td align="right">17</td><td align="right">56</td><td align="right">22</td><td align="right">44</td><td align="right">94</td></tr></tbody></table><h6 id="随机抽取指定行数据"><a href="#随机抽取指定行数据" class="headerlink" title="随机抽取指定行数据"></a>随机抽取指定行数据</h6><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"># axis&#x3D;0代表行，随机抽取以下4行</span><br><span class="line">df.take([19, 3, 9, 7], axis&#x3D;0)</span><br></pre></td></tr></table></figure><p>结果：</p><table><thead><tr><th align="right"></th><th align="right">a</th><th align="right">b</th><th align="right">c</th><th align="right">d</th><th align="right">e</th></tr></thead><tbody><tr><td align="right">19</td><td align="right">17</td><td align="right">56</td><td align="right">22</td><td align="right">44</td><td align="right">94</td></tr><tr><td align="right">3</td><td align="right">32</td><td align="right">91</td><td align="right">21</td><td align="right">38</td><td align="right">40</td></tr><tr><td align="right">9</td><td align="right">50</td><td align="right">40</td><td align="right">47</td><td align="right">9</td><td align="right">51</td></tr><tr><td align="right">7</td><td align="right">32</td><td align="right">67</td><td align="right">81</td><td align="right">53</td><td align="right">77</td></tr></tbody></table><h6 id="随机抽取指定列数据"><a href="#随机抽取指定列数据" class="headerlink" title="随机抽取指定列数据"></a>随机抽取指定列数据</h6><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 抽取默认索引为4/2/0的列数据</span></span><br><span class="line">df.take([<span class="number">4</span>, <span class="number">2</span>, <span class="number">0</span>], axis=<span class="number">1</span>)</span><br></pre></td></tr></table></figure><p>结果：</p><table><thead><tr><th align="right"></th><th align="right">a</th><th align="right">b</th><th align="right">c</th><th align="right">d</th><th align="right">e</th></tr></thead><tbody><tr><td align="right">18</td><td align="right">75</td><td align="right">73</td><td align="right">91</td><td align="right">92</td><td align="right">97</td></tr><tr><td align="right">15</td><td align="right">83</td><td align="right">2</td><td align="right">69</td><td align="right">41</td><td align="right">82</td></tr><tr><td align="right">0</td><td align="right">41</td><td align="right">16</td><td align="right">73</td><td align="right">23</td><td align="right">44</td></tr><tr><td align="right">14</td><td align="right">71</td><td align="right">87</td><td align="right">71</td><td align="right">20</td><td align="right">57</td></tr><tr><td align="right">2</td><td align="right">96</td><td align="right">76</td><td align="right">86</td><td align="right">48</td><td align="right">64</td></tr><tr><td align="right">12</td><td align="right">44</td><td align="right">33</td><td align="right">27</td><td align="right">9</td><td align="right">77</td></tr><tr><td align="right">13</td><td align="right">11</td><td align="right">41</td><td align="right">35</td><td align="right">61</td><td align="right">10</td></tr><tr><td align="right">9</td><td align="right">50</td><td align="right">40</td><td align="right">47</td><td align="right">9</td><td align="right">51</td></tr><tr><td align="right">17</td><td align="right">91</td><td align="right">88</td><td align="right">23</td><td align="right">44</td><td align="right">53</td></tr><tr><td align="right">3</td><td align="right">32</td><td align="right">91</td><td align="right">21</td><td align="right">38</td><td align="right">40</td></tr><tr><td align="right">4</td><td align="right">68</td><td align="right">5</td><td align="right">43</td><td align="right">52</td><td align="right">39</td></tr><tr><td align="right">7</td><td align="right">32</td><td align="right">67</td><td align="right">81</td><td align="right">53</td><td align="right">77</td></tr><tr><td align="right">19</td><td align="right">17</td><td align="right">56</td><td align="right">22</td><td align="right">44</td><td align="right">94</td></tr><tr><td align="right">1</td><td align="right">83</td><td align="right">76</td><td align="right">8</td><td align="right">35</td><td align="right">50</td></tr><tr><td align="right">11</td><td align="right">58</td><td align="right">91</td><td align="right">63</td><td align="right">84</td><td align="right">97</td></tr><tr><td align="right">5</td><td align="right">34</td><td align="right">59</td><td align="right">68</td><td align="right">70</td><td align="right">89</td></tr><tr><td align="right">10</td><td align="right">16</td><td align="right">9</td><td align="right">18</td><td align="right">23</td><td align="right">74</td></tr><tr><td align="right">6</td><td align="right">69</td><td align="right">47</td><td align="right">71</td><td align="right">96</td><td align="right">84</td></tr><tr><td align="right">8</td><td align="right">51</td><td align="right">5</td><td align="right">91</td><td align="right">64</td><td align="right">80</td></tr><tr><td align="right">16</td><td align="right">62</td><td align="right">71</td><td align="right">98</td><td align="right">19</td><td align="right">85</td></tr></tbody></table><h6 id="随机打乱"><a href="#随机打乱" class="headerlink" title="随机打乱"></a>随机打乱</h6><p>当<code>DataFrame</code>规模足够大时，直接使用<code>np.random.permutation(x)</code>函数，就配合take()函数实现随机抽样 ，<code>np.random.permutation(x)</code>生成从0到x-1为元素的列表</p><p><strong>生成随机数列</strong></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">rand_arr = np.random.permutation(<span class="number">20</span>)</span><br></pre></td></tr></table></figure><p>结果：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">array([ <span class="number">6</span>,  <span class="number">7</span>, <span class="number">12</span>, <span class="number">17</span>,  <span class="number">9</span>,  <span class="number">8</span>,  <span class="number">4</span>, <span class="number">18</span>,  <span class="number">3</span>,  <span class="number">1</span>, <span class="number">13</span>, <span class="number">15</span>,  <span class="number">2</span>, <span class="number">10</span>, <span class="number">11</span>,  <span class="number">5</span>, <span class="number">16</span>,</span><br><span class="line">        <span class="number">0</span>, <span class="number">19</span>, <span class="number">14</span>])</span><br></pre></td></tr></table></figure><p><strong>抽取随机后的所有数据</strong></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#行列全部打乱</span></span><br><span class="line">df.take(rand_arr, axis=<span class="number">0</span>).take(np.random.permutation(<span class="number">5</span>), axis=<span class="number">1</span>)</span><br></pre></td></tr></table></figure><p>结果：</p><table><thead><tr><th align="right"></th><th align="right">c</th><th align="right">d</th><th align="right">a</th><th align="right">e</th><th align="right">b</th></tr></thead><tbody><tr><td align="right">10</td><td align="right">18</td><td align="right">23</td><td align="right">16</td><td align="right">74</td><td align="right">9</td></tr><tr><td align="right">9</td><td align="right">47</td><td align="right">9</td><td align="right">50</td><td align="right">51</td><td align="right">40</td></tr><tr><td align="right">18</td><td align="right">91</td><td align="right">92</td><td align="right">75</td><td align="right">97</td><td align="right">73</td></tr><tr><td align="right">12</td><td align="right">27</td><td align="right">9</td><td align="right">44</td><td align="right">77</td><td align="right">33</td></tr><tr><td align="right">7</td><td align="right">81</td><td align="right">53</td><td align="right">32</td><td align="right">77</td><td align="right">67</td></tr><tr><td align="right">4</td><td align="right">43</td><td align="right">52</td><td align="right">68</td><td align="right">39</td><td align="right">5</td></tr><tr><td align="right">8</td><td align="right">91</td><td align="right">64</td><td align="right">51</td><td align="right">80</td><td align="right">5</td></tr><tr><td align="right">0</td><td align="right">73</td><td align="right">23</td><td align="right">41</td><td align="right">44</td><td align="right">16</td></tr><tr><td align="right">11</td><td align="right">63</td><td align="right">84</td><td align="right">58</td><td align="right">97</td><td align="right">91</td></tr><tr><td align="right">1</td><td align="right">8</td><td align="right">35</td><td align="right">83</td><td align="right">50</td><td align="right">76</td></tr><tr><td align="right">19</td><td align="right">22</td><td align="right">44</td><td align="right">17</td><td align="right">94</td><td align="right">56</td></tr><tr><td align="right">13</td><td align="right">35</td><td align="right">61</td><td align="right">11</td><td align="right">10</td><td align="right">41</td></tr><tr><td align="right">16</td><td align="right">98</td><td align="right">19</td><td align="right">62</td><td align="right">85</td><td align="right">71</td></tr><tr><td align="right">14</td><td align="right">71</td><td align="right">20</td><td align="right">71</td><td align="right">57</td><td align="right">87</td></tr><tr><td align="right">5</td><td align="right">68</td><td align="right">70</td><td align="right">34</td><td align="right">89</td><td align="right">59</td></tr><tr><td align="right">6</td><td align="right">71</td><td align="right">96</td><td align="right">69</td><td align="right">84</td><td align="right">47</td></tr><tr><td align="right">2</td><td align="right">86</td><td align="right">48</td><td align="right">96</td><td align="right">64</td><td align="right">76</td></tr><tr><td align="right">15</td><td align="right">69</td><td align="right">41</td><td align="right">83</td><td align="right">82</td><td align="right">2</td></tr><tr><td align="right">3</td><td align="right">21</td><td align="right">38</td><td align="right">32</td><td align="right">40</td><td align="right">91</td></tr><tr><td align="right">17</td><td align="right">23</td><td align="right">44</td><td align="right">91</td><td align="right">53</td><td align="right">88</td></tr></tbody></table><h3 id="数据分类"><a href="#数据分类" class="headerlink" title="数据分类"></a>数据分类</h3><p>数据聚合是数据处理的最后一步，通常是要使每一个数组生成一个单一的数值。</p><p>数据分类处理：</p><ul><li>分组：先把数据分为几组</li><li>用函数处理：为不同组的数据应用不同的函数以转换数据</li><li>合并：把不同组得到的结果合并起来</li></ul><p>数据分类处理的核心：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">- groupby()函数</span><br><span class="line">- groups属性查看分组情况</span><br><span class="line">- eg: df.groupby(by=<span class="string">&#x27;item&#x27;</span>).groups</span><br></pre></td></tr></table></figure><h4 id="分组"><a href="#分组" class="headerlink" title="分组"></a>分组</h4><p>原始数据</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">dic = &#123;</span><br><span class="line">    <span class="string">&#x27;水果&#x27;</span> : [<span class="string">&#x27;苹果&#x27;</span>, <span class="string">&#x27;梨&#x27;</span>,<span class="string">&#x27;苹果&#x27;</span>, <span class="string">&#x27;草莓&#x27;</span>, <span class="string">&#x27;香蕉&#x27;</span>, <span class="string">&#x27;梨&#x27;</span>, <span class="string">&#x27;香蕉&#x27;</span>, <span class="string">&#x27;草莓&#x27;</span>],</span><br><span class="line">    <span class="string">&#x27;价格&#x27;</span> : [<span class="number">4</span>, <span class="number">3</span>, <span class="number">5.5</span>, <span class="number">12</span>, <span class="number">3.2</span>, <span class="number">3.5</span>, <span class="number">2.5</span>, <span class="number">10</span>],</span><br><span class="line">    <span class="string">&#x27;颜色&#x27;</span> : [<span class="string">&#x27;绿色&#x27;</span>, <span class="string">&#x27;绿色&#x27;</span>, <span class="string">&#x27;红色&#x27;</span>, <span class="string">&#x27;红色&#x27;</span>, <span class="string">&#x27;绿色&#x27;</span>, <span class="string">&#x27;黄色&#x27;</span>, <span class="string">&#x27;绿色&#x27;</span>, <span class="string">&#x27;黄色&#x27;</span>],</span><br><span class="line">    <span class="string">&#x27;重量&#x27;</span> : [<span class="number">12</span>, <span class="number">10</span>, <span class="number">9</span>, <span class="number">15</span>, <span class="number">19</span>, <span class="number">20</span>, <span class="number">17</span>, <span class="number">13</span>]</span><br><span class="line">&#125;</span><br><span class="line">df = DataFrame(data=dic)</span><br><span class="line">df</span><br></pre></td></tr></table></figure><p>结果：</p><table><thead><tr><th align="right"></th><th align="right">水果</th><th align="right">价格</th><th align="right">颜色</th><th align="right">重量</th></tr></thead><tbody><tr><td align="right">0</td><td align="right">苹果</td><td align="right">4.0</td><td align="right">绿色</td><td align="right">12</td></tr><tr><td align="right">1</td><td align="right">梨</td><td align="right">3.0</td><td align="right">绿色</td><td align="right">10</td></tr><tr><td align="right">2</td><td align="right">苹果</td><td align="right">5.5</td><td align="right">红色</td><td align="right">9</td></tr><tr><td align="right">3</td><td align="right">草莓</td><td align="right">12.0</td><td align="right">红色</td><td align="right">15</td></tr><tr><td align="right">4</td><td align="right">香蕉</td><td align="right">3.2</td><td align="right">绿色</td><td align="right">19</td></tr><tr><td align="right">5</td><td align="right">梨</td><td align="right">3.5</td><td align="right">黄色</td><td align="right">20</td></tr><tr><td align="right">6</td><td align="right">香蕉</td><td align="right">2.5</td><td align="right">绿色</td><td align="right">17</td></tr><tr><td align="right">7</td><td align="right">草莓</td><td align="right">10.0</td><td align="right">黄色</td><td align="right">13</td></tr></tbody></table><h5 id="根据水果类型分组"><a href="#根据水果类型分组" class="headerlink" title="根据水果类型分组"></a>根据水果类型分组</h5><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># axis=0表示列分组</span></span><br><span class="line">df.groupby(by=<span class="string">&#x27;水果&#x27;</span>, axis=<span class="number">0</span>).groups</span><br></pre></td></tr></table></figure><p>结果</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&#123;<span class="string">&#x27;梨&#x27;</span>: Int64Index([<span class="number">1</span>, <span class="number">5</span>], dtype=<span class="string">&#x27;int64&#x27;</span>),</span><br><span class="line"> <span class="string">&#x27;苹果&#x27;</span>: Int64Index([<span class="number">0</span>, <span class="number">2</span>], dtype=<span class="string">&#x27;int64&#x27;</span>),</span><br><span class="line"> <span class="string">&#x27;草莓&#x27;</span>: Int64Index([<span class="number">3</span>, <span class="number">7</span>], dtype=<span class="string">&#x27;int64&#x27;</span>),</span><br><span class="line"> <span class="string">&#x27;香蕉&#x27;</span>: Int64Index([<span class="number">4</span>, <span class="number">6</span>], dtype=<span class="string">&#x27;int64&#x27;</span>)&#125;</span><br></pre></td></tr></table></figure><h5 id="按颜色分组"><a href="#按颜色分组" class="headerlink" title="按颜色分组"></a>按颜色分组</h5><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># axis=0表示列分组</span></span><br><span class="line">df.groupby(by=<span class="string">&#x27;颜色&#x27;</span>, axis=<span class="number">0</span>).groups</span><br></pre></td></tr></table></figure><p>结果</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&#123;<span class="string">&#x27;红色&#x27;</span>: Int64Index([<span class="number">2</span>, <span class="number">3</span>], dtype=<span class="string">&#x27;int64&#x27;</span>),</span><br><span class="line"> <span class="string">&#x27;绿色&#x27;</span>: Int64Index([<span class="number">0</span>, <span class="number">1</span>, <span class="number">4</span>, <span class="number">6</span>], dtype=<span class="string">&#x27;int64&#x27;</span>),</span><br><span class="line"> <span class="string">&#x27;黄色&#x27;</span>: Int64Index([<span class="number">5</span>, <span class="number">7</span>], dtype=<span class="string">&#x27;int64&#x27;</span>)&#125;</span><br></pre></td></tr></table></figure><h4 id="聚合"><a href="#聚合" class="headerlink" title="聚合"></a>聚合</h4><p>分组后要做的就是聚合统计数据</p><h5 id="每种水果平均值"><a href="#每种水果平均值" class="headerlink" title="每种水果平均值"></a>每种水果平均值</h5><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 水果平均值，只有价格和重量列是数字可以计算</span></span><br><span class="line">df.groupby(by=<span class="string">&#x27;水果&#x27;</span>).mean()</span><br></pre></td></tr></table></figure><p>结果</p><table><thead><tr><th align="right"></th><th align="right">价格</th><th align="right">重量</th></tr></thead><tbody><tr><td align="right">水果</td><td align="right"></td><td align="right"></td></tr><tr><td align="right">梨</td><td align="right">3.25</td><td align="right">15.0</td></tr><tr><td align="right">苹果</td><td align="right">4.75</td><td align="right">10.5</td></tr><tr><td align="right">草莓</td><td align="right">11.00</td><td align="right">14.0</td></tr><tr><td align="right">香蕉</td><td align="right">2.85</td><td align="right">18.0</td></tr></tbody></table><h5 id="每种水果平均价格"><a href="#每种水果平均价格" class="headerlink" title="每种水果平均价格"></a>每种水果平均价格</h5><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">df.groupby(by=<span class="string">&#x27;水果&#x27;</span>)[<span class="string">&#x27;价格&#x27;</span>].mean()</span><br><span class="line"><span class="comment"># df.groupby(by=&#x27;水果&#x27;).mean()[&#x27;价格&#x27;]</span></span><br></pre></td></tr></table></figure><p>结果</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">水果</span><br><span class="line">梨      <span class="number">3.25</span></span><br><span class="line">苹果     <span class="number">4.75</span></span><br><span class="line">草莓    <span class="number">11.00</span></span><br><span class="line">香蕉     <span class="number">2.85</span></span><br><span class="line">Name: 价格, dtype: float64</span><br></pre></td></tr></table></figure><h5 id="苹果的平均价格"><a href="#苹果的平均价格" class="headerlink" title="苹果的平均价格"></a>苹果的平均价格</h5><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 先计算出每种水果平均价格</span></span><br><span class="line"><span class="comment"># 使用自定义索引获取</span></span><br><span class="line">df.groupby(by=<span class="string">&#x27;水果&#x27;</span>)[<span class="string">&#x27;价格&#x27;</span>].mean()[<span class="string">&#x27;苹果&#x27;</span>]</span><br><span class="line"><span class="comment"># 使用默认索引获取苹果平均价</span></span><br><span class="line"><span class="comment"># df.groupby(by=&#x27;水果&#x27;)[&#x27;价格&#x27;].mean()[1]</span></span><br></pre></td></tr></table></figure><h5 id="添加每个水果平均价格列"><a href="#添加每个水果平均价格列" class="headerlink" title="添加每个水果平均价格列"></a>添加每个水果平均价格列</h5><h6 id="计算每种水果均价"><a href="#计算每种水果均价" class="headerlink" title="计算每种水果均价"></a>计算每种水果均价</h6><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#给df创建一个新列，内容为各个水果的平均价格</span></span><br><span class="line">prices = df.groupby(<span class="string">&#x27;水果&#x27;</span>)[<span class="string">&#x27;价格&#x27;</span>].mean()</span><br><span class="line">prices</span><br></pre></td></tr></table></figure><p>结果</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">水果</span><br><span class="line">梨      <span class="number">3.25</span></span><br><span class="line">苹果     <span class="number">4.75</span></span><br><span class="line">草莓    <span class="number">11.00</span></span><br><span class="line">香蕉     <span class="number">2.85</span></span><br><span class="line">Name: 价格, dtype: float64</span><br></pre></td></tr></table></figure><h6 id="每种水果价格平均价转换成字典"><a href="#每种水果价格平均价转换成字典" class="headerlink" title="每种水果价格平均价转换成字典"></a>每种水果价格平均价转换成字典</h6><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">dic_prices = prices.to_dict()</span><br><span class="line">dic_prices</span><br></pre></td></tr></table></figure><p>结果：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;<span class="string">&#x27;梨&#x27;</span>: <span class="number">3.25</span>, <span class="string">&#x27;苹果&#x27;</span>: <span class="number">4.75</span>, <span class="string">&#x27;草莓&#x27;</span>: <span class="number">11.0</span>, <span class="string">&#x27;香蕉&#x27;</span>: <span class="number">2.85</span>&#125;</span><br></pre></td></tr></table></figure><h6 id="使用map映射后添加到一个新列"><a href="#使用map映射后添加到一个新列" class="headerlink" title="使用map映射后添加到一个新列"></a>使用map映射后添加到一个新列</h6><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">df[<span class="string">&#x27;平均价&#x27;</span>] = df[<span class="string">&#x27;水果&#x27;</span>].map(dic_prices)</span><br><span class="line">df</span><br></pre></td></tr></table></figure><p>结果：</p><table><thead><tr><th align="right"></th><th align="right">水果</th><th align="right">价格</th><th align="right">颜色</th><th align="right">重量</th><th align="right">平均价</th></tr></thead><tbody><tr><td align="right">0</td><td align="right">苹果</td><td align="right">4.0</td><td align="right">绿色</td><td align="right">12</td><td align="right">4.75</td></tr><tr><td align="right">1</td><td align="right">梨</td><td align="right">3.0</td><td align="right">绿色</td><td align="right">10</td><td align="right">3.25</td></tr><tr><td align="right">2</td><td align="right">苹果</td><td align="right">5.5</td><td align="right">红色</td><td align="right">9</td><td align="right">4.75</td></tr><tr><td align="right">3</td><td align="right">草莓</td><td align="right">12.0</td><td align="right">红色</td><td align="right">15</td><td align="right">11.00</td></tr><tr><td align="right">4</td><td align="right">香蕉</td><td align="right">3.2</td><td align="right">绿色</td><td align="right">19</td><td align="right">2.85</td></tr><tr><td align="right">5</td><td align="right">梨</td><td align="right">3.5</td><td align="right">黄色</td><td align="right">20</td><td align="right">3.25</td></tr><tr><td align="right">6</td><td align="right">香蕉</td><td align="right">2.5</td><td align="right">绿色</td><td align="right">17</td><td align="right">2.85</td></tr><tr><td align="right">7</td><td align="right">草莓</td><td align="right">10.0</td><td align="right">黄色</td><td align="right">13</td><td align="right">11.00</td></tr></tbody></table><h4 id="高级数据聚合"><a href="#高级数据聚合" class="headerlink" title="高级数据聚合"></a>高级数据聚合</h4><p>使用<code>groupby</code>分组后，也可以使用<code>transform</code>和<code>apply</code>提供自定义函数实现更多的运算</p><ul><li><code>df.groupby(&#39;item&#39;)[&#39;price&#39;].sum()</code> &lt;==&gt; <code>df.groupby(&#39;item&#39;)[&#39;price&#39;].apply(sum)</code></li><li><code>transform</code>和<code>apply</code>都会进行运算，在<code>transform</code>或者<code>apply</code>中传入函数即可</li><li><code>transform</code>和<code>apply</code>也可以传入一个<code>lambda</code>表达式</li></ul><h5 id="使用apply计算每种水果平均价格"><a href="#使用apply计算每种水果平均价格" class="headerlink" title="使用apply计算每种水果平均价格"></a>使用apply计算每种水果平均价格</h5><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#计算平均价格</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">calc_avg</span>(<span class="params">s</span>):</span></span><br><span class="line">    <span class="comment"># 当前水果总价</span></span><br><span class="line">    sum = <span class="number">0</span></span><br><span class="line">    <span class="comment"># 循环当前该类水果所有商品,并将该类所有商品汇总</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> s:</span><br><span class="line">        sum += i</span><br><span class="line">    <span class="comment"># 将该类所有商品总价除以该类所有商品数量及该类商品平均价返回</span></span><br><span class="line">    <span class="keyword">return</span> sum/s.size</span><br><span class="line">avg_price = df.groupby(by=<span class="string">&#x27;水果&#x27;</span>)[<span class="string">&#x27;价格&#x27;</span>].apply(calc_avg)</span><br><span class="line">print(avg_price)</span><br></pre></td></tr></table></figure><p>结果：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">水果</span><br><span class="line">梨      3.25</span><br><span class="line">苹果     4.75</span><br><span class="line">草莓    11.00</span><br><span class="line">香蕉     2.85</span><br><span class="line">Name: 价格, dtype: float64</span><br></pre></td></tr></table></figure></div><div class="popular-posts-header">相关文章</div><ul class="popular-posts"><li class="popular-posts-item"><div class="popular-posts-title"><a href="/f941f8f2.html" rel="bookmark">Flask 15行代码自动回复机器人(附vue前端)</a></div></li><li class="popular-posts-item"><div class="popular-posts-title"><a href="/75e57c9c.html" rel="bookmark">python数据分析之第三方模块NumPy</a></div></li></ul><footer class="post-footer"><div class="reward-container"><div>打赏个鸡腿</div><button onclick='document.querySelector(".post-reward").classList.toggle("active")'>赞赏</button><div class="post-reward"><div><img src="/images/wechatpay.jpg" alt="托小尼 微信"> <span>微信</span></div><div><img src="/images/alipay.jpg" alt="托小尼 支付宝"> <span>支付宝</span></div></div></div><div class="post-tags"><a href="/tags/python%E5%AD%A6%E4%B9%A0/" rel="tag"><i class="fa fa-tag"></i> python学习</a> <a href="/tags/%E6%95%B0%E6%8D%AE%E5%88%86%E6%9E%90/" rel="tag"><i class="fa fa-tag"></i> 数据分析</a> <a href="/tags/Pandas/" rel="tag"><i class="fa fa-tag"></i> Pandas</a> <a href="/tags/series/" rel="tag"><i class="fa fa-tag"></i> series</a> <a href="/tags/dataframe/" rel="tag"><i class="fa fa-tag"></i> dataframe</a> <a href="/tags/series%E5%88%87%E7%89%87/" rel="tag"><i class="fa fa-tag"></i> series切片</a> <a href="/tags/series%E7%B4%A2%E5%BC%95/" rel="tag"><i class="fa fa-tag"></i> series索引</a> <a href="/tags/python%E6%95%B0%E6%8D%AE%E5%88%86%E6%9E%90/" rel="tag"><i class="fa fa-tag"></i> python数据分析</a> <a href="/tags/numpy/" rel="tag"><i class="fa fa-tag"></i> numpy</a></div><div class="post-nav"><div class="post-nav-item"><a href="/dde7447f.html" rel="prev" title="进制之间互相转换"><i class="fa fa-chevron-left"></i> 进制之间互相转换</a></div><div class="post-nav-item"><a href="/785b4585.html" rel="next" title="python批量替换多个word文档内容">python批量替换多个word文档内容 <i class="fa fa-chevron-right"></i></a></div></div></footer></article><div class="comments"><div id="SOHUCS"></div></div><script>window.addEventListener('tabs:register', () => {
    let { activeClass } = CONFIG.comments;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      const activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      const commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }</script></div></main><footer class="footer"><div class="footer-inner"><div class="beian"><span class="exturl" data-url="aHR0cHM6Ly9iZWlhbi5taWl0Lmdvdi5jbg==">豫ICP备17028303号-1 </span><img src="http://www.beian.gov.cn/portal/download" style="display:inline-block"><span class="exturl" data-url="aHR0cDovL3d3dy5iZWlhbi5nb3YuY24vcG9ydGFsL3JlZ2lzdGVyU3lzdGVtSW5mbz9yZWNvcmRjb2RlPTE3MDI4MzAz">豫公网安备 41102402000095号</span></div><div class="copyright">&copy; <span itemprop="copyrightYear">2021</span> <span class="with-love"><i class="fa fa-user"></i> </span><span class="author" itemprop="copyrightHolder">Tony Yu</span></div><div class="wordcount"><span class="post-meta-item"><span class="post-meta-item-icon"><i class="fa fa-chart-line"></i> </span><span title="站点总字数">1.2m</span> </span><span class="post-meta-item"><span class="post-meta-item-icon"><i class="fa fa-coffee"></i> </span><span title="站点阅读时长">18:50</span></span></div></div></footer><script src="//cdn.jsdelivr.net/npm/animejs@3.2.0/lib/anime.min.js"></script><script src="//cdn.jsdelivr.net/npm/medium-zoom@1.0.6/dist/medium-zoom.min.js"></script><script src="//cdn.jsdelivr.net/npm/lozad@1.15.0/dist/lozad.min.js"></script><script src="/js/utils.js"></script><script src="/js/motion.js"></script><script src="/js/next-boot.js"></script><script src="/js/local-search.js"></script><script>NexT.utils.loadComments('#SOHUCS', () => {
    NexT.utils.getScript('https://changyan.sohu.com/upload/changyan.js', () => {
      window.changyan.api.config({
        appid: 'cyu11Umgd',
        conf : '0f296687f6a61e82028fd7c6ddf32ab9'
      });
    });
  });</script><script src="https://assets.changyan.sohu.com/upload/plugins/plugins.count.js"></script></body></html>