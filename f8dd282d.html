<!DOCTYPE html><html lang="zh-CN"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=2"><meta name="theme-color" content="#222"><meta name="generator" content="Hexo 5.1.1"><link rel="apple-touch-icon" sizes="180x180" href="/images/56x56logo.png"><link rel="icon" type="image/png" sizes="32x32" href="/images/56x56logo.png"><link rel="icon" type="image/png" sizes="16x16" href="/favicon.ico"><link rel="mask-icon" href="/images/400x400logo.png" color="#222"><meta http-equiv="Cache-Control" content="no-transform"><meta http-equiv="Cache-Control" content="no-siteapp"><link rel="stylesheet" href="/css/main.css"><link rel="stylesheet" href="//cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.14.0/css/all.min.css"><link rel="stylesheet" href="//cdn.jsdelivr.net/npm/animate.css@3.1.1/animate.min.css"><script class="hexo-configurations">var NexT=window.NexT||{},CONFIG={hostname:"www.diandian100.cn",root:"/",scheme:"Gemini",version:"8.0.0",exturl:!0,sidebar:{position:"left",display:"always",padding:18,offset:12},copycode:!0,bookmark:{enable:!1,color:"#222",save:"auto"},fancybox:!1,mediumzoom:!0,lazyload:!0,pangu:!1,comments:{style:"tabs",active:null,storage:!0,lazyload:!1,nav:null},motion:{enable:!0,async:!1,transition:{post_block:"fadeIn",post_header:"fadeInDown",post_body:"fadeInDown",coll_header:"fadeInLeft",sidebar:"fadeInUp"}},prism:!1,i18n:{placeholder:"搜索...",empty:"没有找到任何搜索结果：${query}",hits_time:"找到 ${hits} 个搜索结果（用时 ${time} 毫秒）",hits:"找到 ${hits} 个搜索结果"},path:"search.xml",localsearch:{enable:!0,trigger:"auto",top_n_per_article:1,unescape:!1,preload:!1}}</script><meta name="description" content="在常规表单开发中，我们常用的做法是手动编写表单至html模板中，请求数据到视图中处理，如果有多个表单就要多次这样操作，视图中也要多次处理验证这些数据，有一个字段要修改就要去所有与表单关联的地方处理，Django为我们提供了Froms组件帮助我们解决这种问题，统一管理统一处理。"><meta property="og:type" content="article"><meta property="og:title" content="Django之forms组件"><meta property="og:url" content="https://www.diandian100.cn/f8dd282d.html"><meta property="og:site_name" content="点点开发技术分享"><meta property="og:description" content="在常规表单开发中，我们常用的做法是手动编写表单至html模板中，请求数据到视图中处理，如果有多个表单就要多次这样操作，视图中也要多次处理验证这些数据，有一个字段要修改就要去所有与表单关联的地方处理，Django为我们提供了Froms组件帮助我们解决这种问题，统一管理统一处理。"><meta property="og:locale" content="zh_CN"><meta property="og:image" content="https://20200324picgo-1251846158.cos.ap-shanghai.myqcloud.com/img/20200424143202.png"><meta property="og:image" content="https://20200324picgo-1251846158.cos.ap-shanghai.myqcloud.com/img/20200424143834.png"><meta property="og:image" content="https://20200324picgo-1251846158.cos.ap-shanghai.myqcloud.com/img/20200426104924.png"><meta property="og:image" content="https://20200324picgo-1251846158.cos.ap-shanghai.myqcloud.com/img/20200426134329.png"><meta property="article:published_time" content="2020-04-22T06:00:10.000Z"><meta property="article:modified_time" content="2020-10-23T03:17:37.000Z"><meta property="article:author" content="托小尼"><meta property="article:tag" content="Django之forms组件"><meta property="article:tag" content="forms"><meta property="article:tag" content="forms组件"><meta property="article:tag" content="formset"><meta property="article:tag" content="forms.Form"><meta property="article:tag" content="forms.ModelForm"><meta name="twitter:card" content="summary"><meta name="twitter:image" content="https://20200324picgo-1251846158.cos.ap-shanghai.myqcloud.com/img/20200424143202.png"><link rel="canonical" href="https://www.diandian100.cn/f8dd282d.html"><script class="page-configurations">CONFIG.page={sidebar:"",isHome:!1,isPost:!0,lang:"zh-CN"}</script><title>Django之forms组件 | 点点开发技术分享</title><script>var _hmt=_hmt||[];!function(){var e=document.createElement("script");e.src="https://hm.baidu.com/hm.js?3b57832214417f66931e694d19fd60b9";var t=document.getElementsByTagName("script")[0];t.parentNode.insertBefore(e,t)}()</script><noscript><style>body{margin-top:2rem}.use-motion .collection-header,.use-motion .comments,.use-motion .menu-item,.use-motion .pagination,.use-motion .post-block,.use-motion .post-body,.use-motion .post-header,.use-motion .sidebar{visibility:visible}.use-motion .footer,.use-motion .header,.use-motion .site-brand-container .toggle{opacity:initial}.use-motion .custom-logo-image,.use-motion .site-subtitle,.use-motion .site-title{opacity:initial;top:initial}.use-motion .logo-line{transform:scaleX(1)}.search-pop-overlay,.sidebar-nav{display:none}.sidebar-panel{display:block}</style></noscript></head><body itemscope itemtype="http://schema.org/WebPage" class="use-motion"><div class="headband"></div><main class="main"><header class="header" itemscope itemtype="http://schema.org/WPHeader"><div class="header-inner"><div class="site-brand-container"><div class="site-nav-toggle"><div class="toggle" aria-label="切换导航栏"><span class="toggle-line"></span> <span class="toggle-line"></span> <span class="toggle-line"></span></div></div><div class="site-meta"><a href="/" class="brand" rel="start"><i class="logo-line"></i><h1 class="site-title">点点开发技术分享</h1><i class="logo-line"></i></a><p class="site-subtitle" itemprop="description">记录个人日常开发笔记与技巧</p></div><div class="site-nav-right"><div class="toggle popup-trigger"><i class="fa fa-search fa-fw fa-lg"></i></div></div></div><nav class="site-nav"><ul class="main-menu menu"><li class="menu-item menu-item-home"><a href="/" rel="section"><i class="fa fa-home fa-fw"></i>首页</a></li><li class="menu-item menu-item-tags"><a href="/tags/" rel="section"><i class="fa fa-tags fa-fw"></i>标签</a></li><li class="menu-item menu-item-archives"><a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>归档</a></li><li class="menu-item menu-item-development"><a href="/categories/rd/" rel="section"><i class="fa fa-code fa-fw"></i>开发</a></li><li class="menu-item menu-item-frontend"><a href="/categories/fe/" rel="section"><i class="fab fa-html5 fa-fw"></i>前端</a></li><li class="menu-item menu-item-database"><a href="/categories/db/" rel="section"><i class="fa fa-database fa-fw"></i>数据库</a></li><li class="menu-item menu-item-os"><a href="/categories/os/" rel="section"><i class="fab fa-linux fa-fw"></i>系统</a></li><li class="menu-item menu-item-other"><a href="/categories/other/" rel="section"><i class="far fa-paper-plane fa-fw"></i>其他</a></li><li class="menu-item menu-item-search"><a role="button" class="popup-trigger"><i class="fa fa-search fa-fw"></i>搜索</a></li></ul></nav><div class="search-pop-overlay"><div class="popup search-popup"><div class="search-header"><span class="search-icon"><i class="fa fa-search"></i></span><div class="search-input-container"><input autocomplete="off" autocapitalize="off" maxlength="80" placeholder="搜索..." spellcheck="false" type="search" class="search-input"></div><span class="popup-btn-close"><i class="fa fa-times-circle"></i></span></div><div class="search-result-container no-result"><div class="search-result-icon"><i class="fa fa-spinner fa-pulse fa-5x"></i></div></div></div></div></div><div class="toggle sidebar-toggle"><span class="toggle-line"></span> <span class="toggle-line"></span> <span class="toggle-line"></span></div><aside class="sidebar"><div class="sidebar-inner sidebar-nav-active sidebar-toc-active"><ul class="sidebar-nav"><li class="sidebar-nav-toc">文章目录</li><li class="sidebar-nav-overview">站点概览</li></ul><section class="post-toc-wrap sidebar-panel"><div class="post-toc animated"><ol class="nav"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E8%A1%A8%E5%8D%95%E5%AD%97%E6%AE%B5%E7%B1%BB%E5%9E%8B"><span class="nav-number">1.</span> <span class="nav-text">表单字段类型</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E8%A1%A8%E5%8D%95%E9%80%9A%E7%94%A8%E5%B1%9E%E6%80%A7"><span class="nav-number">2.</span> <span class="nav-text">表单通用属性</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E8%87%AA%E5%AE%9A%E4%B9%89%E8%A1%A8%E5%8D%95"><span class="nav-number">3.</span> <span class="nav-text">自定义表单</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E7%BC%96%E5%86%99%E8%87%AA%E5%AE%9A%E4%B9%89%E8%A1%A8%E5%8D%95"><span class="nav-number">3.1.</span> <span class="nav-text">编写自定义表单</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E8%A1%A8%E5%8D%95%E5%AE%9E%E4%BE%8B%E5%8C%96"><span class="nav-number">3.2.</span> <span class="nav-text">表单实例化</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%A8%A1%E6%9D%BF%E4%BD%BF%E7%94%A8%E8%A1%A8%E5%8D%95"><span class="nav-number">3.3.</span> <span class="nav-text">模板使用表单</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#%E6%88%96"><span class="nav-number">3.3.1.</span> <span class="nav-text">或</span></a></li></ol></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E7%A4%BA%E4%BE%8B"><span class="nav-number">3.4.</span> <span class="nav-text">示例</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E8%A1%A8%E5%8D%95%E9%AA%8C%E8%AF%81"><span class="nav-number">3.5.</span> <span class="nav-text">表单验证</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E8%87%AA%E5%AE%9A%E4%B9%89widget"><span class="nav-number">3.6.</span> <span class="nav-text">自定义widget</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E8%87%AA%E5%AE%9A%E4%B9%89%E5%B1%9E%E6%80%A7%E5%92%8C%E9%94%99%E8%AF%AF%E4%BF%A1%E6%81%AF"><span class="nav-number">3.7.</span> <span class="nav-text">自定义属性和错误信息</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E8%A1%A8%E5%8D%95%E6%95%B0%E6%8D%AE%E5%88%9D%E5%A7%8B%E5%8C%96"><span class="nav-number">3.8.</span> <span class="nav-text">表单数据初始化**</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%A8%A1%E5%9E%8B%E8%A1%A8%E5%8D%95"><span class="nav-number">4.</span> <span class="nav-text">模型表单</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%AE%9A%E4%B9%89%E6%A8%A1%E5%9E%8B%E8%A1%A8%E5%8D%95"><span class="nav-number">4.1.</span> <span class="nav-text">定义模型表单</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Meta%E9%80%89%E9%A1%B9"><span class="nav-number">4.2.</span> <span class="nav-text">Meta选项</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#1-fields"><span class="nav-number">4.2.1.</span> <span class="nav-text">1) fields</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#2-labels"><span class="nav-number">4.2.2.</span> <span class="nav-text">2) labels</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#3-help-texts"><span class="nav-number">4.2.3.</span> <span class="nav-text">3) help_texts</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#4-widgets"><span class="nav-number">4.2.4.</span> <span class="nav-text">4) widgets</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#5-field-classes"><span class="nav-number">4.2.5.</span> <span class="nav-text">5) field_classes</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#6-error-messages"><span class="nav-number">4.2.6.</span> <span class="nav-text">6) error_messages</span></a></li></ol></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E8%A1%A8%E5%8D%95%E6%95%B0%E6%8D%AE%E5%88%9D%E5%A7%8B%E5%8C%96-1"><span class="nav-number">4.3.</span> <span class="nav-text">表单数据初始化</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#FormSet"><span class="nav-number">5.</span> <span class="nav-text">FormSet</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#Formset%E7%9A%84%E5%88%86%E7%B1%BB"><span class="nav-number">5.1.</span> <span class="nav-text">Formset的分类</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#formset-factory"><span class="nav-number">5.1.1.</span> <span class="nav-text">formset_factory</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#modelformset-factory"><span class="nav-number">5.1.2.</span> <span class="nav-text">modelformset_factory</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#inlineformset-factory"><span class="nav-number">5.1.3.</span> <span class="nav-text">inlineformset_factory</span></a><ol class="nav-child"><li class="nav-item nav-level-6"><a class="nav-link" href="#%E6%A8%A1%E5%9E%8Bmodels-py"><span class="nav-number">5.1.3.1.</span> <span class="nav-text">模型models.py</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#%E8%87%AA%E5%AE%9A%E4%B9%89%E8%A1%A8%E5%8D%95form-py"><span class="nav-number">5.1.3.2.</span> <span class="nav-text">自定义表单form.py</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#%E8%A7%86%E5%9B%BEviews-py"><span class="nav-number">5.1.3.3.</span> <span class="nav-text">视图views.py</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#%E6%A8%A1%E6%9D%BFtemplates"><span class="nav-number">5.1.3.4.</span> <span class="nav-text">模板templates</span></a></li></ol></li></ol></li></ol></li></ol></div></section><section class="site-overview-wrap sidebar-panel"><div class="site-author animated" itemprop="author" itemscope itemtype="http://schema.org/Person"><img class="site-author-image" itemprop="image" alt="托小尼" src="/images/avatar.jpg"><p class="site-author-name" itemprop="name">托小尼</p><div class="site-description" itemprop="description"></div></div><div class="site-state-wrap animated"><nav class="site-state"><div class="site-state-item site-state-posts"><a href="/archives/"><span class="site-state-item-count">191</span> <span class="site-state-item-name">日志</span></a></div><div class="site-state-item site-state-categories"><a href="/categories/"><span class="site-state-item-count">30</span> <span class="site-state-item-name">分类</span></a></div><div class="site-state-item site-state-tags"><a href="/tags/"><span class="site-state-item-count">1190</span> <span class="site-state-item-name">标签</span></a></div></nav></div><div class="links-of-author animated"><span class="links-of-author-item"><span class="exturl" data-url="aHR0cDovL3dwYS5xcS5jb20vbXNncmQ/dj0zJnVpbj02NDY1NDc5ODkmc2l0ZT1xcSZtZW51PXllcw==" title="QQ → http:&#x2F;&#x2F;wpa.qq.com&#x2F;msgrd?v&#x3D;3&amp;uin&#x3D;646547989&amp;site&#x3D;qq&amp;menu&#x3D;yes"><i class="fab fa-qq fa-fw"></i>QQ</span> </span><span class="links-of-author-item"><span class="exturl" data-url="bWFpbHRvOnRvbnl5dUB2aXAucXEuY29t" title="E-Mail → mailto:tonyyu@vip.qq.com"><i class="fa fa-envelope fa-fw"></i>E-Mail</span></span></div></section></div></aside><div class="sidebar-dimmer"></div></header><div class="back-to-top"><i class="fa fa-arrow-up"></i> <span>0%</span></div><div class="reading-progress-bar"></div><span class="exturl github-corner" data-url="aHR0cHM6Ly9naXRodWIuY29tL3Rvbnl1MjAxOQ==" title="关注我" aria-label="关注我"><svg width="80" height="80" viewBox="0 0 250 250" aria-hidden="true"><path d="M0,0 L115,115 L130,115 L142,142 L250,250 L250,0 Z"></path><path d="M128.3,109.0 C113.8,99.7 119.0,89.6 119.0,89.6 C122.0,82.7 120.5,78.6 120.5,78.6 C119.2,72.0 123.4,76.3 123.4,76.3 C127.3,80.9 125.5,87.3 125.5,87.3 C122.9,97.6 130.6,101.9 134.4,103.2" fill="currentColor" style="transform-origin:130px 106px" class="octo-arm"></path><path d="M115.0,115.0 C114.9,115.1 118.7,116.5 119.8,115.4 L133.7,101.6 C136.9,99.2 139.9,98.4 142.2,98.6 C133.8,88.0 127.5,74.4 143.8,58.0 C148.5,53.4 154.0,51.2 159.7,51.0 C160.3,49.4 163.2,43.6 171.4,40.1 C171.4,40.1 176.1,42.5 178.8,56.2 C183.1,58.6 187.2,61.8 190.9,65.4 C194.5,69.0 197.7,73.2 200.1,77.6 C213.8,80.2 216.3,84.9 216.3,84.9 C212.7,93.1 206.9,96.0 205.4,96.6 C205.1,102.4 203.0,107.8 198.3,112.5 C181.9,128.9 168.3,122.5 157.7,114.1 C157.9,116.9 156.7,120.9 152.7,124.9 L141.0,136.5 C139.8,137.7 141.6,141.9 141.8,141.8 Z" fill="currentColor" class="octo-body"></path></svg></span><noscript><div class="noscript-warning">Theme NexT works best with JavaScript enabled</div></noscript><div class="main-inner post posts-expand"><article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN"><link itemprop="mainEntityOfPage" href="https://www.diandian100.cn/f8dd282d.html"><span hidden itemprop="author" itemscope itemtype="http://schema.org/Person"><meta itemprop="image" content="/images/avatar.jpg"><meta itemprop="name" content="托小尼"><meta itemprop="description" content=""></span><span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization"><meta itemprop="name" content="点点开发技术分享"></span><header class="post-header"><h1 class="post-title" itemprop="name headline">Django之forms组件</h1><div class="post-meta-container"><div class="post-meta"><span class="post-meta-item"><span class="post-meta-item-icon"><i class="far fa-calendar"></i> </span><span class="post-meta-item-text">发表于</span> <time title="创建时间：2020-04-22 14:00:10" itemprop="dateCreated datePublished" datetime="2020-04-22T14:00:10+08:00">2020-04-22</time> </span><span class="post-meta-item"><span class="post-meta-item-icon"><i class="far fa-calendar-check"></i> </span><span class="post-meta-item-text">更新于</span> <time title="修改时间：2020-10-23 11:17:37" itemprop="dateModified" datetime="2020-10-23T11:17:37+08:00">2020-10-23</time> </span><span class="post-meta-item"><span class="post-meta-item-icon"><i class="far fa-folder"></i> </span><span class="post-meta-item-text">分类于</span> <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/rd/" itemprop="url" rel="index"><span itemprop="name">rd</span></a> </span>， <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/rd/python/" itemprop="url" rel="index"><span itemprop="name">python</span></a> </span>， <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/rd/python/django/" itemprop="url" rel="index"><span itemprop="name">django</span></a> </span></span><span class="post-meta-item"><span class="post-meta-item-icon"><i class="far fa-comment"></i> </span><span class="post-meta-item-text">Changyan：</span> <a title="changyan" href="/f8dd282d.html#SOHUCS" itemprop="discussionUrl"><span id="changyan_count_unit" class="post-comments-count hc-comment-count" data-xid="f8dd282d.html" itemprop="commentCount"></span></a></span></div><div class="post-meta"><span class="post-meta-item" title="本文字数"><span class="post-meta-item-icon"><i class="far fa-file-word"></i> </span><span class="post-meta-item-text">本文字数：</span> <span>34k</span> </span><span class="post-meta-item" title="阅读时长"><span class="post-meta-item-icon"><i class="far fa-clock"></i> </span><span class="post-meta-item-text">阅读时长 &asymp;</span> <span>31 分钟</span></span></div></div></header><div class="post-body" itemprop="articleBody"><p>在常规表单开发中，我们常用的做法是手动编写表单至<code>html</code>模板中，请求数据到视图中处理，如果有多个表单就要多次这样操作，视图中也要多次处理验证这些数据，有一个字段要修改就要去所有与表单关联的地方处理，<code>Django</code>为我们提供了<code>Froms</code>组件帮助我们解决这种问题，统一管理统一处理。</p><a id="more"></a><p>类似模型，<code>Django</code>表单也由各种字段组成。表单可以自定义(<code>forms.Form</code>)，也可以由模型Models创建(<code>forms.ModelForm</code>)。值得注意的是模型里用的是<code>verbose_name</code>来描述一个字段, 而表单用的是<code>label</code>。这两种方式其实只在<code>forms</code>中有区别，视图和模板中使用方式一致，我们这里就先将自定义表单，不同的地方会讲下模型表单。</p><p><code>Django</code>的常用做法是在<code>app</code>文件夹下创建一个<code>forms.py</code>，专门存放<code>app</code>中所定义的各种表单，这样方便集中管理表单。如果要使用上述表单，我们可以在视图<code>views.py</code>里把它们像模型一样<code>import</code>进来直接使用。我们这里统一在我们的<code>wechat</code>应用下创建<code>forms.py</code>文件，来存放我们的自定义表单</p><h3 id="表单字段类型"><a href="#表单字段类型" class="headerlink" title="表单字段类型"></a>表单字段类型</h3><p>讲到表单之前我们先讲下表单字段的类型：</p><p>西面的<code>StudentForm</code>类只有一个字段，字段类型是<code>CharField</code>，对应的<code>HTML</code>元素是<br><code>&lt;input type＝”text ” ...＞</code> ，这里的<code>HTML</code>元素叫作字段的<code>Widget</code>。除此之外， <code>Django</code> 的<code>Form</code> 类<br>还提供了几十种字段类型， 每种类型分别对应不同的<code>HTML</code> 元素，下面对这些类型进行简<br>单介绍。如果需要更详细的表单字段介绍，可以参考<code>Django</code> 官网： <span class="exturl" data-url="aHR0cHM6Ly9kb2NzLmRqYW5nb3Byb2plY3QuY29tL2VuLzIuMC9yZWYvZm9ybXMvZmllbGRz">https://docs.djangoproject.com/en/2.0/ref/forms/fields<i class="fa fa-external-link-alt"></i></span> 。</p><ol><li><code>BooleanField</code><br><code>Widget</code>: <code>Checkboxlnput( &lt; input type＝checkbox ” ...＞）</code> 。<br>空值： <code>False</code> 。<br>标惟值： <code>True</code> 、<code>False</code> 。<br>验证：如果设置了<code>required =True</code> ， 则验证字段值是否为<code>True</code> 。<br>验证点： <code>required</code> 。</li><li><code>CharField</code><br><code>Widget</code> : <code>Textlnput( &lt; input type=&quot; text ” ...＞ ）</code> 。<br>空值： <code>empty_value</code> 。<br>标准值： 字符串。<br>验证： 如果设置了<code>max_length</code>, <code>min_length</code> ，则验证字段长度是再符合要求，否则不验证。<br>验证点： <code>required</code> , <code>max_length</code> , <code>min_length</code> 。</li><li><code>ChoiceField</code><br><code>Widget</code>: <code>Select( &lt;select&gt;&lt;option ...&gt; ... &lt;/select＞）</code> 。<br>空值：””。<br>标准值： 字符串。<br>验证： 验证字段值是否存在。<br>验证点： <code>required</code>, <code>invalid_choice</code></li><li><code>DateField</code><br><code>Widget</code>: <code>Datelnput( &lt; input type=&quot;text” ...＞）</code> 。<br>空值： <code>None</code> 。<br>标准值： <code>Python</code> <code>datetime.date</code>巳对象。<br>验证：验证字段值是否是正确的时间格式字符串、<code>datetime .date</code> 对象、<code>datetime.datetime</code><br>对象。<br>验证点： <code>required</code>, <code>invalid</code> 。</li><li><code>DateTimeField</code><br><code>Widget</code>: <code>Datelnput( &lt; input type=&quot; text&quot; ... ＞ ）</code> 。<br>空值： <code>None</code><br>标准值： <code>Python</code> <code>datetime. datetime</code>对象。<br>验证： 验证字段值是否是正确的时间格式字符串、<code>datetime.date</code> 对象、<code>datetime.datetime</code><br>对象。<br>验证点： <code>required</code> , <code>invalid</code> 。</li><li><code>DecimalField</code><br><code>Widget</code>：当<code>Field.localize=False</code>时对应<code>Numberlnput(&lt;input type＝”number”...&gt;)</code>，否则对<br>应<code>Textlnput(&lt;inputtype=&quot;text” ...&gt;)</code>。<br>空值：<code>None</code>。<br>标准值：<code>Python decimal</code>对象。<br>验证：验证字段值是否是数值类型。<br>验证点：<code>required</code>,<code>invalid</code>,<code>max_value</code>,<code>min_value</code>,<code>max_digits</code>,<code>max_decimal_places</code>,<code>max_whole_digits</code>。</li><li><code>FileField</code><br><code>Widget</code>:<code>ClearableFilelnput(&lt;input type=&quot;file”...&gt;)</code>。<br>空值：<code>None</code>。<br>标准值：包含文件内容与文件名的<code>UploadedFile</code>对象。<br>验证：空文件或者没有选择文件。<br>验证点：<code>required</code>,<code>invalid</code>,<code>missing</code>,<code>empty</code>,<code>max_length</code>。</li><li><code>FilePathField</code><br><code>Widget</code>:<code>Select(&lt;select&gt;&lt;option ...&gt; ...&lt;/select&gt;)</code>。<br>空值：<code>None</code>。<br>标准值：字符串。<br>验证：选中的选项是否存在于下拉列表中。<br>验证点：<code>required</code>,<code>invalid_choice</code>。</li><li><code>lmageField</code><br><code>Widget</code>:<code>ClearableFilelnput(&lt;input type＝&quot;file” ...&gt;)</code>。<br>空值：<code>None</code>。<br>标准值：包含文件内容与文件名的<code>UploadedFile</code>对象。<br>验证：空文件或者没有选择文件。<br>验证点：<code>required</code>,<code>invalid</code>,<code>missiing</code>，<code>empty</code>,<code>invalid_image</code>。</li><li><code>lntegerField</code><br><code>Widget</code>：当<code>Field.localize=False</code>时对应<code>Numberlnput(&lt;inputtype=&quot;number” ...&gt;)</code>，否则对<br>应<code>Textlnput(&lt;inputtype＝”text” ...&gt;)</code>。<br>空值：<code>None</code>。<br>标准值： <code>Python integer</code> 对象。<br>验证：验证宇段值是否是一个整数。<br>验证点： <code>required</code>, <code>invalid</code>, <code>max_value</code>, <code>min_value</code> 。</li><li><code>MultipleChoiceField</code><br><code>Widget</code>: <code>SelectMultiple(&lt;select multiple=&quot;multiple”&gt; ... &lt;/select&gt;)</code> 。<br>空值： <code>[]</code>（空列表）。<br>标准值：一组字符串。<br>验证：所有选中值存在于下拉列表中。<br>验证点： <code>required</code>, <code>invalid_ choice</code>, <code>invalid_list</code> 。</li></ol><h3 id="表单通用属性"><a href="#表单通用属性" class="headerlink" title="表单通用属性"></a>表单通用属性</h3><ol><li><code>required</code><br>默认情况下，所有的表单字段都是必填字段，这样如果提交表单时没有为字段赋值，则<br>会抛出<code>ValidationError</code> 异常。<br>对于非必填宇段可以设置<code>required=False</code> 避免验证错误，例如：</li></ol><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">forms.CharField(required=<span class="literal">False</span>)</span><br></pre></td></tr></table></figure><p><code>label</code><br>为表单字段指定一个<code>label</code> 元素用于显示字段信息，如上面<code>your_name</code>字段将会额外显<br>示一个<code>label</code>:</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;label for&#x3D;&quot;your name&quot;&gt;Your name : &lt;&#x2F;label&gt;</span><br></pre></td></tr></table></figure><p><code>initial</code><br>为宇段设置初始值。</p><p><code>help_ text</code><br>为字段添加帮助性文字。</p><p><code>error_messages</code><br>重写字段的默认错误提示信息， <code>error_messages</code> 是一个字典类型。<br>例如设置当<code>CharField</code> 的<code>required</code>验证失败时显示‘请输入你的名字’：</p><ol><li><pre><code class="python">name= forms.CharField(error_messages=&#123;&#39;required&#39;:&#39;请输入你的名字可&#39;&#125;)
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">2. &#96;localize&#96;</span><br><span class="line">   设置表单宇段是否启用本地化。</span><br><span class="line"></span><br><span class="line">3. &#96;disabled&#96;</span><br><span class="line">   当设置&#96;disabled＝True&#96; 时，使用&#96;HTML disabled&#96; 属性禁用字段。</span><br><span class="line"></span><br><span class="line">### 表单字段内置属性</span><br><span class="line"></span><br><span class="line">除了上面的通用属性，每个字段都有自己的内置属性</span><br><span class="line"></span><br><span class="line">&#96;&#96;&#96;python</span><br><span class="line">Field</span><br><span class="line">    required&#x3D;True,               是否允许为空</span><br><span class="line">    widget&#x3D;None,                 HTML插件</span><br><span class="line">    label&#x3D;None,                  用于生成Label标签或显示内容</span><br><span class="line">    initial&#x3D;None,                初始值</span><br><span class="line">    help_text&#x3D;&#39;&#39;,                帮助信息(在标签旁边显示)</span><br><span class="line">    error_messages&#x3D;None,         错误信息 &#123;&#39;required&#39;: &#39;不能为空&#39;, &#39;invalid&#39;: &#39;格式错误&#39;&#125;</span><br><span class="line">    show_hidden_initial&#x3D;False,   是否在当前插件后面再加一个隐藏的且具有默认值的插件（可用于检验两次输入是否一直）</span><br><span class="line">    validators&#x3D;[],               自定义验证规则</span><br><span class="line">    localize&#x3D;False,              是否支持本地化</span><br><span class="line">    disabled&#x3D;False,              是否可以编辑</span><br><span class="line">    label_suffix&#x3D;None            Label内容后缀</span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line">CharField(Field)</span><br><span class="line">    max_length&#x3D;None,             最大长度</span><br><span class="line">    min_length&#x3D;None,             最小长度</span><br><span class="line">    strip&#x3D;True                   是否移除用户输入空白</span><br><span class="line"> </span><br><span class="line">IntegerField(Field)</span><br><span class="line">    max_value&#x3D;None,              最大值</span><br><span class="line">    min_value&#x3D;None,              最小值</span><br><span class="line"> </span><br><span class="line">FloatField(IntegerField)</span><br><span class="line">    ...</span><br><span class="line"> </span><br><span class="line">DecimalField(IntegerField)</span><br><span class="line">    max_value&#x3D;None,              最大值</span><br><span class="line">    min_value&#x3D;None,              最小值</span><br><span class="line">    max_digits&#x3D;None,             总长度</span><br><span class="line">    decimal_places&#x3D;None,         小数位长度</span><br><span class="line"> </span><br><span class="line">BaseTemporalField(Field)</span><br><span class="line">    input_formats&#x3D;None          时间格式化   </span><br><span class="line"> </span><br><span class="line">DateField(BaseTemporalField)    格式：2015-09-01</span><br><span class="line">TimeField(BaseTemporalField)    格式：11:12</span><br><span class="line">DateTimeField(BaseTemporalField)格式：2015-09-01 11:12</span><br><span class="line"> </span><br><span class="line">DurationField(Field)            时间间隔：%d %H:%M:%S.%f</span><br><span class="line">    ...</span><br><span class="line"> </span><br><span class="line">RegexField(CharField)</span><br><span class="line">    regex,                      自定制正则表达式</span><br><span class="line">    max_length&#x3D;None,            最大长度</span><br><span class="line">    min_length&#x3D;None,            最小长度</span><br><span class="line">    error_message&#x3D;None,         忽略，错误信息使用 error_messages&#x3D;&#123;&#39;invalid&#39;: &#39;...&#39;&#125;</span><br><span class="line"> </span><br><span class="line">EmailField(CharField)      </span><br><span class="line">    ...</span><br><span class="line"> </span><br><span class="line">FileField(Field)</span><br><span class="line">    allow_empty_file&#x3D;False     是否允许空文件</span><br><span class="line"> </span><br><span class="line">ImageField(FileField)      </span><br><span class="line">    ...</span><br><span class="line">    注：需要PIL模块，pip3 install Pillow</span><br><span class="line">    以上两个字典使用时，需要注意两点：</span><br><span class="line">        - form表单中 enctype&#x3D;&quot;multipart&#x2F;form-data&quot;</span><br><span class="line">        - view函数中 obj &#x3D; MyForm(request.POST, request.FILES)</span><br><span class="line"> </span><br><span class="line">URLField(Field)</span><br><span class="line">    ...</span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line">BooleanField(Field)  </span><br><span class="line">    ...</span><br><span class="line"> </span><br><span class="line">NullBooleanField(BooleanField)</span><br><span class="line">    ...</span><br><span class="line"> </span><br><span class="line">ChoiceField(Field)</span><br><span class="line">    ...</span><br><span class="line">    choices&#x3D;(),                选项，如：choices &#x3D; ((0,&#39;上海&#39;),(1,&#39;北京&#39;),)</span><br><span class="line">    required&#x3D;True,             是否必填</span><br><span class="line">    widget&#x3D;None,               插件，默认select插件</span><br><span class="line">    label&#x3D;None,                Label内容</span><br><span class="line">    initial&#x3D;None,              初始值</span><br><span class="line">    help_text&#x3D;&#39;&#39;,              帮助提示</span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line">ModelChoiceField(ChoiceField)</span><br><span class="line">    ...                        django.forms.models.ModelChoiceField</span><br><span class="line">    queryset,                  # 查询数据库中的数据</span><br><span class="line">    empty_label&#x3D;&quot;---------&quot;,   # 默认空显示内容</span><br><span class="line">    to_field_name&#x3D;None,        # HTML中value的值对应的字段</span><br><span class="line">    limit_choices_to&#x3D;None      # ModelForm中对queryset二次筛选</span><br><span class="line">     </span><br><span class="line">ModelMultipleChoiceField(ModelChoiceField)</span><br><span class="line">    ...                        django.forms.models.ModelMultipleChoiceField</span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line">     </span><br><span class="line">TypedChoiceField(ChoiceField)</span><br><span class="line">    coerce &#x3D; lambda val: val   对选中的值进行一次转换</span><br><span class="line">    empty_value&#x3D; &#39;&#39;            空值的默认值</span><br><span class="line"> </span><br><span class="line">MultipleChoiceField(ChoiceField)</span><br><span class="line">    ...</span><br><span class="line"> </span><br><span class="line">TypedMultipleChoiceField(MultipleChoiceField)</span><br><span class="line">    coerce &#x3D; lambda val: val   对选中的每一个值进行一次转换</span><br><span class="line">    empty_value&#x3D; &#39;&#39;            空值的默认值</span><br><span class="line"> </span><br><span class="line">ComboField(Field)</span><br><span class="line">    fields&#x3D;()                  使用多个验证，如下：即验证最大长度20，又验证邮箱格式</span><br><span class="line">                               fields.ComboField(fields&#x3D;[fields.CharField(max_length&#x3D;20), fields.EmailField(),])</span><br><span class="line"> </span><br><span class="line">MultiValueField(Field)</span><br><span class="line">    PS: 抽象类，子类中可以实现聚合多个字典去匹配一个值，要配合MultiWidget使用</span><br><span class="line"> </span><br><span class="line">SplitDateTimeField(MultiValueField)</span><br><span class="line">    input_date_formats&#x3D;None,   格式列表：[&#39;%Y--%m--%d&#39;, &#39;%m%d&#x2F;%Y&#39;, &#39;%m&#x2F;%d&#x2F;%y&#39;]</span><br><span class="line">    input_time_formats&#x3D;None    格式列表：[&#39;%H:%M:%S&#39;, &#39;%H:%M:%S.%f&#39;, &#39;%H:%M&#39;]</span><br><span class="line"> </span><br><span class="line">FilePathField(ChoiceField)     文件选项，目录下文件显示在页面中</span><br><span class="line">    path,                      文件夹路径</span><br><span class="line">    match&#x3D;None,                正则匹配</span><br><span class="line">    recursive&#x3D;False,           递归下面的文件夹</span><br><span class="line">    allow_files&#x3D;True,          允许文件</span><br><span class="line">    allow_folders&#x3D;False,       允许文件夹</span><br><span class="line">    required&#x3D;True,</span><br><span class="line">    widget&#x3D;None,</span><br><span class="line">    label&#x3D;None,</span><br><span class="line">    initial&#x3D;None,</span><br><span class="line">    help_text&#x3D;&#39;&#39;</span><br><span class="line"> </span><br><span class="line">GenericIPAddressField</span><br><span class="line">    protocol&#x3D;&#39;both&#39;,           both,ipv4,ipv6支持的IP格式</span><br><span class="line">    unpack_ipv4&#x3D;False          解析ipv4地址，如果是::ffff:192.0.2.1时候，可解析为192.0.2.1， PS：protocol必须为both才能启用</span><br><span class="line"> </span><br><span class="line">SlugField(CharField)           数字，字母，下划线，减号（连字符）</span><br><span class="line">    ...</span><br><span class="line"> </span><br><span class="line">UUIDField(CharField)           uuid类型</span><br><span class="line">    ...</span><br></pre></td></tr></table></figure>


</code></pre></li></ol><h3 id="自定义表单"><a href="#自定义表单" class="headerlink" title="自定义表单"></a>自定义表单</h3><h4 id="编写自定义表单"><a href="#编写自定义表单" class="headerlink" title="编写自定义表单"></a>编写自定义表单</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> django <span class="keyword">import</span> forms</span><br><span class="line"><span class="keyword">from</span> .models <span class="keyword">import</span> Student</span><br><span class="line"></span><br><span class="line">CLASSES_CHOICES = (<span class="string">&#x27;软件二班&#x27;</span>, <span class="string">&#x27;图像一班&#x27;</span>, <span class="string">&#x27;师范一班&#x27;</span>)</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">StudentForm</span>(<span class="params">forms.Form</span>):</span></span><br><span class="line">    name = forms.CharField(min_length=<span class="number">4</span>, required=<span class="literal">True</span>, label=<span class="string">&#x27;姓名&#x27;</span>)</span><br><span class="line">    age = forms.IntegerField()</span><br><span class="line">    score = forms.DecimalField()</span><br><span class="line">    classes = forms.ChoiceField(choices=CLASSES_CHOICES)</span><br></pre></td></tr></table></figure><h4 id="表单实例化"><a href="#表单实例化" class="headerlink" title="表单实例化"></a>表单实例化</h4><p>下面方法可以实例化一个空表单，但里面没有任何数据</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">form = StudentForm()</span><br></pre></td></tr></table></figure><p>用户提交的数据可以通过以下方法与表单结合，生成与数据结合过的表单(<code>Bound forms</code>)。<code>Django</code>只能对<code>Bound forms</code>进行验证。</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">form = StudentForm(data=request.POST, files=request.FILES)</span><br></pre></td></tr></table></figure><p>我们暂时的视图代码：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> django.shortcuts <span class="keyword">import</span> render, HttpResponse</span><br><span class="line"><span class="keyword">from</span> .forms <span class="keyword">import</span> StudentForm</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">index</span>(<span class="params">request</span>):</span></span><br><span class="line">    <span class="comment"># 实例化自定义表单</span></span><br><span class="line">    form = StudentForm()</span><br><span class="line">    <span class="keyword">if</span> request.method == <span class="string">&#x27;POST&#x27;</span>:</span><br><span class="line">        form = StudentForm(request.POST)</span><br><span class="line">    <span class="comment"># form传给前端做渲染</span></span><br><span class="line">    <span class="keyword">return</span> render(request, <span class="string">&#x27;index.html&#x27;</span>, &#123;<span class="string">&#x27;form&#x27;</span>:form&#125;)</span><br></pre></td></tr></table></figure><h4 id="模板使用表单"><a href="#模板使用表单" class="headerlink" title="模板使用表单"></a>模板使用表单</h4><p>模板文件中我们可以通过<code>,</code> <code>和</code>中渲染表单。如果使用<code>则默认等于使用了</code>。</p><h5 id="或"><a href="#或" class="headerlink" title=" 或"></a><code>或</code></h5><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">&#123;% extends &#x27;layout.html&#x27; %&#125;</span><br><span class="line">&#123;% block main %&#125;</span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;uk-container&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">form</span> <span class="attr">action</span>=<span class="string">&quot;&#123;% url &#x27;wechat:index&#x27; %&#125;&quot;</span> <span class="attr">method</span>=<span class="string">&quot;post&quot;</span>&gt;</span></span><br><span class="line">            &#123;% csrf_token %&#125;</span><br><span class="line">            &#123;&#123; form &#125;&#125;</span><br><span class="line">        <span class="tag">&lt;/<span class="name">form</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">&#123;% endblock %&#125;</span><br></pre></td></tr></table></figure><p>渲染后的页面为：</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">&quot;zh&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;UTF-8&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">name</span>=<span class="string">&quot;viewport&quot;</span></span></span><br><span class="line"><span class="tag">          <span class="attr">content</span>=<span class="string">&quot;width=device-width, user-scalable=no, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">http-equiv</span>=<span class="string">&quot;X-UA-Compatible&quot;</span> <span class="attr">content</span>=<span class="string">&quot;ie=edge&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">title</span>&gt;</span>Document<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">link</span> <span class="attr">rel</span>=<span class="string">&quot;stylesheet&quot;</span> <span class="attr">href</span>=<span class="string">&quot;https://cdn.jsdelivr.net/npm/uikit@3.2.2/dist/css/uikit.min.css&quot;</span>/&gt;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line"> </span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;uk-container&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">form</span> <span class="attr">action</span>=<span class="string">&quot;/wechat/index/&quot;</span> <span class="attr">method</span>=<span class="string">&quot;post&quot;</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;hidden&quot;</span> <span class="attr">name</span>=<span class="string">&quot;csrfmiddlewaretoken&quot;</span> <span class="attr">value</span>=<span class="string">&quot;j4mMZkPNIjVGEwr4wc8u1iywfuIMFOu300iU1gmOjP8FJdJmMSiNHhxxPzPP6kKZ&quot;</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">tr</span>&gt;</span><span class="tag">&lt;<span class="name">th</span>&gt;</span><span class="tag">&lt;<span class="name">label</span> <span class="attr">for</span>=<span class="string">&quot;id_name&quot;</span>&gt;</span>姓名:<span class="tag">&lt;/<span class="name">label</span>&gt;</span><span class="tag">&lt;/<span class="name">th</span>&gt;</span><span class="tag">&lt;<span class="name">td</span>&gt;</span><span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;text&quot;</span> <span class="attr">name</span>=<span class="string">&quot;name&quot;</span> <span class="attr">minlength</span>=<span class="string">&quot;4&quot;</span> <span class="attr">required</span> <span class="attr">id</span>=<span class="string">&quot;id_name&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">td</span>&gt;</span><span class="tag">&lt;/<span class="name">tr</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">tr</span>&gt;</span><span class="tag">&lt;<span class="name">th</span>&gt;</span><span class="tag">&lt;<span class="name">label</span> <span class="attr">for</span>=<span class="string">&quot;id_age&quot;</span>&gt;</span>Age:<span class="tag">&lt;/<span class="name">label</span>&gt;</span><span class="tag">&lt;/<span class="name">th</span>&gt;</span><span class="tag">&lt;<span class="name">td</span>&gt;</span><span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;number&quot;</span> <span class="attr">name</span>=<span class="string">&quot;age&quot;</span> <span class="attr">required</span> <span class="attr">id</span>=<span class="string">&quot;id_age&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">td</span>&gt;</span><span class="tag">&lt;/<span class="name">tr</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">tr</span>&gt;</span><span class="tag">&lt;<span class="name">th</span>&gt;</span><span class="tag">&lt;<span class="name">label</span> <span class="attr">for</span>=<span class="string">&quot;id_score&quot;</span>&gt;</span>Score:<span class="tag">&lt;/<span class="name">label</span>&gt;</span><span class="tag">&lt;/<span class="name">th</span>&gt;</span><span class="tag">&lt;<span class="name">td</span>&gt;</span><span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;number&quot;</span> <span class="attr">name</span>=<span class="string">&quot;score&quot;</span> <span class="attr">step</span>=<span class="string">&quot;any&quot;</span> <span class="attr">required</span> <span class="attr">id</span>=<span class="string">&quot;id_score&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">td</span>&gt;</span><span class="tag">&lt;/<span class="name">tr</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">tr</span>&gt;</span><span class="tag">&lt;<span class="name">th</span>&gt;</span><span class="tag">&lt;<span class="name">label</span> <span class="attr">for</span>=<span class="string">&quot;id_classes&quot;</span>&gt;</span>Classes:<span class="tag">&lt;/<span class="name">label</span>&gt;</span><span class="tag">&lt;/<span class="name">th</span>&gt;</span><span class="tag">&lt;<span class="name">td</span>&gt;</span><span class="tag">&lt;<span class="name">select</span> <span class="attr">name</span>=<span class="string">&quot;classes&quot;</span> <span class="attr">id</span>=<span class="string">&quot;id_classes&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">option</span> <span class="attr">value</span>=<span class="string">&quot;软件二班&quot;</span>&gt;</span>软件二班<span class="tag">&lt;/<span class="name">option</span>&gt;</span></span><br><span class="line"></span><br><span class="line">  <span class="tag">&lt;<span class="name">option</span> <span class="attr">value</span>=<span class="string">&quot;图像一班&quot;</span>&gt;</span>图像一班<span class="tag">&lt;/<span class="name">option</span>&gt;</span></span><br><span class="line"></span><br><span class="line">  <span class="tag">&lt;<span class="name">option</span> <span class="attr">value</span>=<span class="string">&quot;师范一班&quot;</span>&gt;</span>师范一班<span class="tag">&lt;/<span class="name">option</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">select</span>&gt;</span><span class="tag">&lt;/<span class="name">td</span>&gt;</span><span class="tag">&lt;/<span class="name">tr</span>&gt;</span></span><br><span class="line">            </span><br><span class="line">        <span class="tag">&lt;/<span class="name">form</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!-- UIkit JS --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">&quot;https://cdn.jsdelivr.net/npm/uikit@3.2.2/dist/js/uikit.min.js&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">&quot;https://cdn.jsdelivr.net/npm/uikit@3.2.2/dist/js/uikit-icons.min.js&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure>##### 使用`{{ form.as_p }}`渲染<p>表单部分生成的结果为：</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"> <span class="tag">&lt;<span class="name">p</span>&gt;</span><span class="tag">&lt;<span class="name">label</span> <span class="attr">for</span>=<span class="string">&quot;id_name&quot;</span>&gt;</span>姓名:<span class="tag">&lt;/<span class="name">label</span>&gt;</span> <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;text&quot;</span> <span class="attr">name</span>=<span class="string">&quot;name&quot;</span> <span class="attr">minlength</span>=<span class="string">&quot;4&quot;</span> <span class="attr">required</span> <span class="attr">id</span>=<span class="string">&quot;id_name&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">p</span>&gt;</span><span class="tag">&lt;<span class="name">label</span> <span class="attr">for</span>=<span class="string">&quot;id_age&quot;</span>&gt;</span>Age:<span class="tag">&lt;/<span class="name">label</span>&gt;</span> <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;number&quot;</span> <span class="attr">name</span>=<span class="string">&quot;age&quot;</span> <span class="attr">required</span> <span class="attr">id</span>=<span class="string">&quot;id_age&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">p</span>&gt;</span><span class="tag">&lt;<span class="name">label</span> <span class="attr">for</span>=<span class="string">&quot;id_score&quot;</span>&gt;</span>Score:<span class="tag">&lt;/<span class="name">label</span>&gt;</span> <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;number&quot;</span> <span class="attr">name</span>=<span class="string">&quot;score&quot;</span> <span class="attr">step</span>=<span class="string">&quot;any&quot;</span> <span class="attr">required</span> <span class="attr">id</span>=<span class="string">&quot;id_score&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">p</span>&gt;</span><span class="tag">&lt;<span class="name">label</span> <span class="attr">for</span>=<span class="string">&quot;id_classes&quot;</span>&gt;</span>Classes:<span class="tag">&lt;/<span class="name">label</span>&gt;</span> <span class="tag">&lt;<span class="name">select</span> <span class="attr">name</span>=<span class="string">&quot;classes&quot;</span> <span class="attr">id</span>=<span class="string">&quot;id_classes&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">option</span> <span class="attr">value</span>=<span class="string">&quot;软件二班&quot;</span>&gt;</span>软件二班<span class="tag">&lt;/<span class="name">option</span>&gt;</span></span><br><span class="line"></span><br><span class="line">  <span class="tag">&lt;<span class="name">option</span> <span class="attr">value</span>=<span class="string">&quot;图像一班&quot;</span>&gt;</span>图像一班<span class="tag">&lt;/<span class="name">option</span>&gt;</span></span><br><span class="line"></span><br><span class="line">  <span class="tag">&lt;<span class="name">option</span> <span class="attr">value</span>=<span class="string">&quot;师范一班&quot;</span>&gt;</span>师范一班<span class="tag">&lt;/<span class="name">option</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">select</span>&gt;</span><span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br></pre></td></tr></table></figure>##### 使用`{{form.as_ul}}`渲染<p>表单部分生成的结果为：</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">li</span>&gt;</span><span class="tag">&lt;<span class="name">label</span> <span class="attr">for</span>=<span class="string">&quot;id_name&quot;</span>&gt;</span>姓名:<span class="tag">&lt;/<span class="name">label</span>&gt;</span> <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;text&quot;</span> <span class="attr">name</span>=<span class="string">&quot;name&quot;</span> <span class="attr">minlength</span>=<span class="string">&quot;4&quot;</span> <span class="attr">required</span> <span class="attr">id</span>=<span class="string">&quot;id_name&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">li</span>&gt;</span><span class="tag">&lt;<span class="name">label</span> <span class="attr">for</span>=<span class="string">&quot;id_age&quot;</span>&gt;</span>Age:<span class="tag">&lt;/<span class="name">label</span>&gt;</span> <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;number&quot;</span> <span class="attr">name</span>=<span class="string">&quot;age&quot;</span> <span class="attr">required</span> <span class="attr">id</span>=<span class="string">&quot;id_age&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">li</span>&gt;</span><span class="tag">&lt;<span class="name">label</span> <span class="attr">for</span>=<span class="string">&quot;id_score&quot;</span>&gt;</span>Score:<span class="tag">&lt;/<span class="name">label</span>&gt;</span> <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;number&quot;</span> <span class="attr">name</span>=<span class="string">&quot;score&quot;</span> <span class="attr">step</span>=<span class="string">&quot;any&quot;</span> <span class="attr">required</span> <span class="attr">id</span>=<span class="string">&quot;id_score&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">li</span>&gt;</span><span class="tag">&lt;<span class="name">label</span> <span class="attr">for</span>=<span class="string">&quot;id_classes&quot;</span>&gt;</span>Classes:<span class="tag">&lt;/<span class="name">label</span>&gt;</span> <span class="tag">&lt;<span class="name">select</span> <span class="attr">name</span>=<span class="string">&quot;classes&quot;</span> <span class="attr">id</span>=<span class="string">&quot;id_classes&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">option</span> <span class="attr">value</span>=<span class="string">&quot;软件二班&quot;</span>&gt;</span>软件二班<span class="tag">&lt;/<span class="name">option</span>&gt;</span></span><br><span class="line"></span><br><span class="line">  <span class="tag">&lt;<span class="name">option</span> <span class="attr">value</span>=<span class="string">&quot;图像一班&quot;</span>&gt;</span>图像一班<span class="tag">&lt;/<span class="name">option</span>&gt;</span></span><br><span class="line"></span><br><span class="line">  <span class="tag">&lt;<span class="name">option</span> <span class="attr">value</span>=<span class="string">&quot;师范一班&quot;</span>&gt;</span>师范一班<span class="tag">&lt;/<span class="name">option</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">select</span>&gt;</span><span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br></pre></td></tr></table></figure><p>如果你想详细控制每个<code>field</code>的格式，你可以采取以下方式。</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">&#123;% extends &#x27;layout.html&#x27; %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% block main %&#125;</span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;uk-container&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">form</span> <span class="attr">action</span>=<span class="string">&quot;&#123;% url &#x27;wechat:index&#x27; %&#125;&quot;</span> <span class="attr">method</span>=<span class="string">&quot;post&quot;</span> <span class="attr">novalidate</span>&gt;</span></span><br><span class="line">            &#123;% csrf_token %&#125;</span><br><span class="line">            &#123;% for field in form %&#125;</span><br><span class="line">                <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;uk-margin&quot;</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">label</span> <span class="attr">class</span>=<span class="string">&quot;uk-form-label&quot;</span> <span class="attr">for</span>=<span class="string">&quot;form-horizontal-text&quot;</span>&gt;</span>&#123;&#123; field.label &#125;&#125;<span class="tag">&lt;/<span class="name">label</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;uk-form-controls&quot;</span>&gt;</span></span><br><span class="line">                        &#123;&#123; field &#125;&#125;</span><br><span class="line">                    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">                    &#123;% if field.help_text %&#125;</span><br><span class="line">                        <span class="tag">&lt;<span class="name">p</span> <span class="attr">class</span>=<span class="string">&quot;help&quot;</span>&gt;</span>&#123;&#123; field.help_text|safe &#125;&#125;<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">                    &#123;% endif %&#125;</span><br><span class="line">                    &#123;&#123; field.errors &#125;&#125;</span><br><span class="line">                <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">            &#123;% endfor %&#125;</span><br><span class="line">        <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;uk-margin&quot;</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">button</span> <span class="attr">class</span>=<span class="string">&quot;uk-button uk-button-primary &quot;</span> <span class="attr">type</span>=<span class="string">&quot;submit&quot;</span>&gt;</span>提交<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">form</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">&#123;% endblock %&#125;</span><br></pre></td></tr></table></figure><p>发起<code>post</code>请求后渲染出的表单部分为：</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;uk-margin&quot;</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">label</span> <span class="attr">class</span>=<span class="string">&quot;uk-form-label&quot;</span> <span class="attr">for</span>=<span class="string">&quot;form-horizontal-text&quot;</span>&gt;</span>姓名<span class="tag">&lt;/<span class="name">label</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;uk-form-controls&quot;</span>&gt;</span></span><br><span class="line">                        <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;text&quot;</span> <span class="attr">name</span>=<span class="string">&quot;name&quot;</span> <span class="attr">minlength</span>=<span class="string">&quot;4&quot;</span> <span class="attr">required</span> <span class="attr">id</span>=<span class="string">&quot;id_name&quot;</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">                    </span><br><span class="line">                    <span class="tag">&lt;<span class="name">ul</span> <span class="attr">class</span>=<span class="string">&quot;errorlist&quot;</span>&gt;</span><span class="tag">&lt;<span class="name">li</span>&gt;</span>这个字段是必填项。<span class="tag">&lt;/<span class="name">li</span>&gt;</span><span class="tag">&lt;/<span class="name">ul</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">            </span><br><span class="line">                <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;uk-margin&quot;</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">label</span> <span class="attr">class</span>=<span class="string">&quot;uk-form-label&quot;</span> <span class="attr">for</span>=<span class="string">&quot;form-horizontal-text&quot;</span>&gt;</span>Age<span class="tag">&lt;/<span class="name">label</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;uk-form-controls&quot;</span>&gt;</span></span><br><span class="line">                        <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;number&quot;</span> <span class="attr">name</span>=<span class="string">&quot;age&quot;</span> <span class="attr">value</span>=<span class="string">&quot;23&quot;</span> <span class="attr">required</span> <span class="attr">id</span>=<span class="string">&quot;id_age&quot;</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">                    </span><br><span class="line">                    </span><br><span class="line">                <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">            </span><br><span class="line">                <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;uk-margin&quot;</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">label</span> <span class="attr">class</span>=<span class="string">&quot;uk-form-label&quot;</span> <span class="attr">for</span>=<span class="string">&quot;form-horizontal-text&quot;</span>&gt;</span>Score<span class="tag">&lt;/<span class="name">label</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;uk-form-controls&quot;</span>&gt;</span></span><br><span class="line">                        <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;number&quot;</span> <span class="attr">name</span>=<span class="string">&quot;score&quot;</span> <span class="attr">step</span>=<span class="string">&quot;any&quot;</span> <span class="attr">required</span> <span class="attr">id</span>=<span class="string">&quot;id_score&quot;</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">                    </span><br><span class="line">                    <span class="tag">&lt;<span class="name">ul</span> <span class="attr">class</span>=<span class="string">&quot;errorlist&quot;</span>&gt;</span><span class="tag">&lt;<span class="name">li</span>&gt;</span>这个字段是必填项。<span class="tag">&lt;/<span class="name">li</span>&gt;</span><span class="tag">&lt;/<span class="name">ul</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">            </span><br><span class="line">                <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;uk-margin&quot;</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">label</span> <span class="attr">class</span>=<span class="string">&quot;uk-form-label&quot;</span> <span class="attr">for</span>=<span class="string">&quot;form-horizontal-text&quot;</span>&gt;</span>Classes<span class="tag">&lt;/<span class="name">label</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;uk-form-controls&quot;</span>&gt;</span></span><br><span class="line">                        <span class="tag">&lt;<span class="name">select</span> <span class="attr">name</span>=<span class="string">&quot;classes&quot;</span> <span class="attr">id</span>=<span class="string">&quot;id_classes&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">option</span> <span class="attr">value</span>=<span class="string">&quot;软件二班&quot;</span> <span class="attr">selected</span>&gt;</span>软件二班<span class="tag">&lt;/<span class="name">option</span>&gt;</span></span><br><span class="line"></span><br><span class="line">  <span class="tag">&lt;<span class="name">option</span> <span class="attr">value</span>=<span class="string">&quot;图像一班&quot;</span>&gt;</span>图像一班<span class="tag">&lt;/<span class="name">option</span>&gt;</span></span><br><span class="line"></span><br><span class="line">  <span class="tag">&lt;<span class="name">option</span> <span class="attr">value</span>=<span class="string">&quot;师范一班&quot;</span>&gt;</span>师范一班<span class="tag">&lt;/<span class="name">option</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure><h4 id="示例"><a href="#示例" class="headerlink" title="示例"></a>示例</h4><p>我们通常将自定义表单写入到<code>forms.py</code>中，当然你也可以不用新建<code>forms.py</code>而直接在<code>html</code>模板里写表单，但我并不建议这么做。用<code>forms.py</code>的好处显而易见:</p><ul><li>所有的表单在一个文件里，非常便于后期维护，比如增添或修订字段。</li><li><code>forms.py</code>可通过<code>clean</code>方法自定义表单验证，非常便捷（见后文）。</li></ul><p>继续刚才我们的视图，我们对用户提交的数据进行验证。</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> django.shortcuts <span class="keyword">import</span> render, HttpResponse</span><br><span class="line"><span class="keyword">from</span> .forms <span class="keyword">import</span> StudentForm</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">index</span>(<span class="params">request</span>):</span></span><br><span class="line">    <span class="comment"># 实例化自定义表单</span></span><br><span class="line">    form = StudentForm()</span><br><span class="line">    <span class="keyword">if</span> request.method == <span class="string">&#x27;POST&#x27;</span>:</span><br><span class="line">        form = StudentForm(request.POST)</span><br><span class="line">        <span class="keyword">if</span> form.is_valid():</span><br><span class="line">            name = form.cleaned_data[<span class="string">&#x27;name&#x27;</span>]</span><br><span class="line">            age = form.cleaned_data[<span class="string">&#x27;age&#x27;</span>]</span><br><span class="line">            score = form.cleaned_data[<span class="string">&#x27;score&#x27;</span>]</span><br><span class="line">            classes = form.cleaned_data[<span class="string">&#x27;classes&#x27;</span>]</span><br><span class="line">            stu_obj = Student.objects.create(name=name, age=age, score=score, classes=classes)</span><br><span class="line">            <span class="keyword">return</span> HttpResponse(<span class="string">&#x27;学生《%s》创建成功&#x27;</span> % name)</span><br><span class="line">    <span class="comment"># form传给前端做渲染</span></span><br><span class="line">    <span class="keyword">return</span> render(request, <span class="string">&#x27;index.html&#x27;</span>, &#123;<span class="string">&#x27;form&#x27;</span>:form&#125;)</span><br></pre></td></tr></table></figure><p>我们来理下<code>StudentForm</code>整个流程:</p><ul><li>当用户通过<code>POST</code>方法提交表单，我们将提交的数据与<code>StudentForm</code>结合，然后验证表单<code>StudentForm</code>的数据是否有效。</li><li>如果表单数据有效，我们创建<code>student</code>对象。用户通过一张表单提交数据。</li><li>如果添加学员成功，我们通过<code>HttpResponse</code>返回页面学生添加成功提示</li><li>如果用户没有提交表单或不是通过POST方法提交表单，我们转到添加页面，生成一张空的<code>StudentForm</code></li></ul><h4 id="表单验证"><a href="#表单验证" class="headerlink" title="表单验证"></a>表单验证</h4><p>每个<code>forms</code>类可以通过<code>clean</code>方法自定义表单验证。如果你只想对某些字段进行验证，你可以通过<code>clean_字段名</code>方式自定义表单验证。如果用户提交的数据未通过验证，会返回<code>ValidationError</code>，并呈现给用户。如果用户提交的数据有效<code>form.is_valid()</code>，则会将数据存储在<code>cleaned_data</code>里。</p><p>在上述添加学员的案例里，我们在<code>StudentForm``通过``clean</code>方法添加了姓名验证，年龄验证和分数验证。代码如下。</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> django <span class="keyword">import</span> forms</span><br><span class="line"><span class="keyword">from</span> .models <span class="keyword">import</span> Student</span><br><span class="line"></span><br><span class="line">CLASSES_CHOICES = (</span><br><span class="line">                   (<span class="string">&#x27;软件二班&#x27;</span>, <span class="string">&#x27;软件二班&#x27;</span>),</span><br><span class="line">                   (<span class="string">&#x27;图像一班&#x27;</span>, <span class="string">&#x27;图像一班&#x27;</span>),</span><br><span class="line">                   (<span class="string">&#x27;师范一班&#x27;</span>, <span class="string">&#x27;师范一班&#x27;</span>)</span><br><span class="line">                   )</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">StudentForm</span>(<span class="params">forms.Form</span>):</span></span><br><span class="line">    name = forms.CharField(label=<span class="string">&#x27;姓名&#x27;</span>)</span><br><span class="line">    age = forms.IntegerField()</span><br><span class="line">    score = forms.DecimalField()</span><br><span class="line">    classes = forms.ChoiceField(choices=CLASSES_CHOICES)</span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">clean_name</span>(<span class="params">self</span>):</span></span><br><span class="line">        name = self.cleaned_data.get(<span class="string">&#x27;name&#x27;</span>)</span><br><span class="line"></span><br><span class="line">        <span class="comment"># 判断姓名长度及是否存在</span></span><br><span class="line">        <span class="keyword">if</span> len(name)&lt;<span class="number">2</span>:</span><br><span class="line">            <span class="keyword">raise</span> forms.ValidationError(<span class="string">&#x27;你的名字也太短了，蒙我的吧！&#x27;</span>)</span><br><span class="line">        <span class="keyword">elif</span> len(name)&gt;<span class="number">10</span>:</span><br><span class="line">            <span class="keyword">raise</span> forms.ValidationError(<span class="string">&#x27;这么长的名字？滚犊子！&#x27;</span>)</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            stu_obj = Student.objects.filter(name__exact=name)</span><br><span class="line">            <span class="keyword">if</span> len(stu_obj)&gt;<span class="number">0</span>:</span><br><span class="line">                <span class="keyword">raise</span> forms.ValidationError(<span class="string">&#x27;这学生报过名了，你走开！&#x27;</span>)</span><br><span class="line">        <span class="keyword">return</span> name</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">clean_age</span>(<span class="params">self</span>):</span></span><br><span class="line">        age = self.cleaned_data.get(<span class="string">&#x27;age&#x27;</span>)</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> age&lt;<span class="number">1</span> <span class="keyword">or</span> age&gt;<span class="number">120</span>:</span><br><span class="line">            <span class="keyword">raise</span>  forms.ValidationError(<span class="string">&#x27;你这年龄绝了，拒绝！&#x27;</span>)</span><br><span class="line">        <span class="keyword">return</span> age</span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">clean_score</span>(<span class="params">self</span>):</span></span><br><span class="line">        score = self.cleaned_data.get(<span class="string">&#x27;score&#x27;</span>)</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> score&lt;<span class="number">0</span> <span class="keyword">or</span> score&gt;<span class="number">120</span>:</span><br><span class="line">            <span class="keyword">raise</span> forms.ValidationError(<span class="string">&#x27;啥情况啊，分页能飞啊！&#x27;</span>)</span><br><span class="line">        <span class="keyword">return</span> score</span><br></pre></td></tr></table></figure><h4 id="自定义widget"><a href="#自定义widget" class="headerlink" title="自定义widget"></a>自定义<code>widget</code></h4><p><code>Django forms</code>的每个字段你都可以选择你喜欢的输入<code>widget</code>，比如多选，复选框。你还可以定义每个<code>widget</code>的<code>css</code>属性。如果你不指定，<code>Django</code>会使用默认的<code>widget</code>，有时比较丑。</p><p>比如下面这段代码定义了表单姓名字段的输入控件为<code>Textarea</code>，还指定了其样式<code>css</code>。</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">StudentForm</span>(<span class="params">forms.Form</span>):</span></span><br><span class="line">    name = forms.CharField(label=<span class="string">&#x27;姓名&#x27;</span>, widget=forms.Textarea(</span><br><span class="line">        attrs=&#123;</span><br><span class="line">            <span class="string">&#x27;class&#x27;</span>:<span class="string">&#x27;uk-textarea&#x27;</span></span><br><span class="line">        &#125;</span><br><span class="line">    ))</span><br></pre></td></tr></table></figure><p>模板渲染出来的结果为：</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">textarea</span> <span class="attr">name</span>=<span class="string">&quot;name&quot;</span> <span class="attr">cols</span>=<span class="string">&quot;40&quot;</span> <span class="attr">rows</span>=<span class="string">&quot;10&quot;</span> <span class="attr">class</span>=<span class="string">&quot;uk-textarea&quot;</span> <span class="attr">required</span> <span class="attr">id</span>=<span class="string">&quot;id_name&quot;</span>&gt;</span></span><br></pre></td></tr></table></figure><p>设置<code>widget</code>可以是你的表单大大美化，方便用户选择输入。比如下面案例里对年份使用了<code>SelectDateWidget</code>，颜色则使用了复选框<code>CheckboxSelectMultiple</code>。单选可以用<code>RadioSelect</code>和<code>Select</code>。常见文本输入可以用<code>TextInput</code>和<code>TextArea</code>。</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">BIRTH_YEAR_CHOICES = (<span class="string">&#x27;1980&#x27;</span>, <span class="string">&#x27;1981&#x27;</span>, <span class="string">&#x27;1982&#x27;</span>)</span><br><span class="line">COLORS_CHOICES = (</span><br><span class="line">    (<span class="string">&#x27;blue&#x27;</span>, <span class="string">&#x27;Blue&#x27;</span>),</span><br><span class="line">    (<span class="string">&#x27;green&#x27;</span>, <span class="string">&#x27;Green&#x27;</span>),</span><br><span class="line">    (<span class="string">&#x27;black&#x27;</span>, <span class="string">&#x27;Black&#x27;</span>),</span><br><span class="line">)</span><br><span class="line">GENDER_CHOICES = (</span><br><span class="line">    (<span class="string">&#x27;male&#x27;</span>, <span class="string">&#x27;男&#x27;</span>),</span><br><span class="line">    (<span class="string">&#x27;female&#x27;</span>, <span class="string">&#x27;女&#x27;</span>)</span><br><span class="line">)</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">SimpleForm</span>(<span class="params">forms.Form</span>):</span></span><br><span class="line">    birth_year = forms.DateField(widget=forms.SelectDateWidget(years=BIRTH_YEAR_CHOICES))</span><br><span class="line">    favorite_colors = forms.MultipleChoiceField(</span><br><span class="line">        required=<span class="literal">False</span>,</span><br><span class="line">        widget=forms.CheckboxSelectMultiple(</span><br><span class="line">            attrs=&#123;</span><br><span class="line">                <span class="string">&#x27;class&#x27;</span>:<span class="string">&#x27;uk-checkbox&#x27;</span></span><br><span class="line">            &#125;</span><br><span class="line">        ),</span><br><span class="line">        choices=COLORS_CHOICES,</span><br><span class="line">    )</span><br><span class="line">    gender = forms.CharField(widget=forms.RadioSelect(</span><br><span class="line">        choices=GENDER_CHOICES,</span><br><span class="line">        attrs=&#123;</span><br><span class="line">            <span class="string">&#x27;class&#x27;</span>: <span class="string">&#x27;uk-radio&#x27;</span></span><br><span class="line">        &#125;</span><br><span class="line">    ))</span><br></pre></td></tr></table></figure><p>渲染结果：</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line">     <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;uk-margin&quot;</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">label</span> <span class="attr">class</span>=<span class="string">&quot;uk-form-label&quot;</span> <span class="attr">for</span>=<span class="string">&quot;form-horizontal-text&quot;</span>&gt;</span>Birth year<span class="tag">&lt;/<span class="name">label</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;uk-form-controls&quot;</span>&gt;</span></span><br><span class="line">                        <span class="tag">&lt;<span class="name">select</span> <span class="attr">name</span>=<span class="string">&quot;birth_year_year&quot;</span> <span class="attr">required</span> <span class="attr">id</span>=<span class="string">&quot;id_birth_year_year&quot;</span>&gt;</span><span class="tag">&lt;<span class="name">option</span> <span class="attr">value</span>=<span class="string">&quot;1980&quot;</span>&gt;</span>1980<span class="tag">&lt;/<span class="name">option</span>&gt;</span><span class="tag">&lt;<span class="name">option</span> <span class="attr">value</span>=<span class="string">&quot;1981&quot;</span>&gt;</span>1981<span class="tag">&lt;/<span class="name">option</span>&gt;</span><span class="tag">&lt;<span class="name">option</span> <span class="attr">value</span>=<span class="string">&quot;1982&quot;</span>&gt;</span>1982<span class="tag">&lt;/<span class="name">option</span>&gt;</span><span class="tag">&lt;/<span class="name">select</span>&gt;</span><span class="tag">&lt;<span class="name">select</span> <span class="attr">name</span>=<span class="string">&quot;birth_year_month&quot;</span> <span class="attr">required</span> <span class="attr">id</span>=<span class="string">&quot;id_birth_year_month&quot;</span>&gt;</span><span class="tag">&lt;<span class="name">option</span> <span class="attr">value</span>=<span class="string">&quot;1&quot;</span>&gt;</span>一月<span class="tag">&lt;/<span class="name">option</span>&gt;</span><span class="tag">&lt;<span class="name">option</span> <span class="attr">value</span>=<span class="string">&quot;2&quot;</span>&gt;</span>二月<span class="tag">&lt;/<span class="name">option</span>&gt;</span><span class="tag">&lt;<span class="name">option</span> <span class="attr">value</span>=<span class="string">&quot;3&quot;</span>&gt;</span>三月<span class="tag">&lt;/<span class="name">option</span>&gt;</span><span class="tag">&lt;<span class="name">option</span> <span class="attr">value</span>=<span class="string">&quot;4&quot;</span>&gt;</span>四月<span class="tag">&lt;/<span class="name">option</span>&gt;</span><span class="tag">&lt;<span class="name">option</span> <span class="attr">value</span>=<span class="string">&quot;5&quot;</span>&gt;</span>五月<span class="tag">&lt;/<span class="name">option</span>&gt;</span><span class="tag">&lt;<span class="name">option</span> <span class="attr">value</span>=<span class="string">&quot;6&quot;</span>&gt;</span>六月<span class="tag">&lt;/<span class="name">option</span>&gt;</span><span class="tag">&lt;<span class="name">option</span> <span class="attr">value</span>=<span class="string">&quot;7&quot;</span>&gt;</span>七月<span class="tag">&lt;/<span class="name">option</span>&gt;</span><span class="tag">&lt;<span class="name">option</span> <span class="attr">value</span>=<span class="string">&quot;8&quot;</span>&gt;</span>八月<span class="tag">&lt;/<span class="name">option</span>&gt;</span><span class="tag">&lt;<span class="name">option</span> <span class="attr">value</span>=<span class="string">&quot;9&quot;</span>&gt;</span>九月<span class="tag">&lt;/<span class="name">option</span>&gt;</span><span class="tag">&lt;<span class="name">option</span> <span class="attr">value</span>=<span class="string">&quot;10&quot;</span>&gt;</span>十月<span class="tag">&lt;/<span class="name">option</span>&gt;</span><span class="tag">&lt;<span class="name">option</span> <span class="attr">value</span>=<span class="string">&quot;11&quot;</span>&gt;</span>十一月<span class="tag">&lt;/<span class="name">option</span>&gt;</span><span class="tag">&lt;<span class="name">option</span> <span class="attr">value</span>=<span class="string">&quot;12&quot;</span>&gt;</span>十二月<span class="tag">&lt;/<span class="name">option</span>&gt;</span><span class="tag">&lt;/<span class="name">select</span>&gt;</span><span class="tag">&lt;<span class="name">select</span> <span class="attr">name</span>=<span class="string">&quot;birth_year_day&quot;</span> <span class="attr">required</span> <span class="attr">id</span>=<span class="string">&quot;id_birth_year_day&quot;</span>&gt;</span><span class="tag">&lt;<span class="name">option</span> <span class="attr">value</span>=<span class="string">&quot;1&quot;</span>&gt;</span>1<span class="tag">&lt;/<span class="name">option</span>&gt;</span><span class="tag">&lt;<span class="name">option</span> <span class="attr">value</span>=<span class="string">&quot;2&quot;</span>&gt;</span>2<span class="tag">&lt;/<span class="name">option</span>&gt;</span><span class="tag">&lt;<span class="name">option</span> <span class="attr">value</span>=<span class="string">&quot;3&quot;</span>&gt;</span>3<span class="tag">&lt;/<span class="name">option</span>&gt;</span><span class="tag">&lt;<span class="name">option</span> <span class="attr">value</span>=<span class="string">&quot;4&quot;</span>&gt;</span>4<span class="tag">&lt;/<span class="name">option</span>&gt;</span><span class="tag">&lt;<span class="name">option</span> <span class="attr">value</span>=<span class="string">&quot;5&quot;</span>&gt;</span>5<span class="tag">&lt;/<span class="name">option</span>&gt;</span><span class="tag">&lt;<span class="name">option</span> <span class="attr">value</span>=<span class="string">&quot;6&quot;</span>&gt;</span>6<span class="tag">&lt;/<span class="name">option</span>&gt;</span><span class="tag">&lt;<span class="name">option</span> <span class="attr">value</span>=<span class="string">&quot;7&quot;</span>&gt;</span>7<span class="tag">&lt;/<span class="name">option</span>&gt;</span><span class="tag">&lt;<span class="name">option</span> <span class="attr">value</span>=<span class="string">&quot;8&quot;</span>&gt;</span>8<span class="tag">&lt;/<span class="name">option</span>&gt;</span><span class="tag">&lt;<span class="name">option</span> <span class="attr">value</span>=<span class="string">&quot;9&quot;</span>&gt;</span>9<span class="tag">&lt;/<span class="name">option</span>&gt;</span><span class="tag">&lt;<span class="name">option</span> <span class="attr">value</span>=<span class="string">&quot;10&quot;</span>&gt;</span>10<span class="tag">&lt;/<span class="name">option</span>&gt;</span><span class="tag">&lt;<span class="name">option</span> <span class="attr">value</span>=<span class="string">&quot;11&quot;</span>&gt;</span>11<span class="tag">&lt;/<span class="name">option</span>&gt;</span><span class="tag">&lt;<span class="name">option</span> <span class="attr">value</span>=<span class="string">&quot;12&quot;</span>&gt;</span>12<span class="tag">&lt;/<span class="name">option</span>&gt;</span><span class="tag">&lt;<span class="name">option</span> <span class="attr">value</span>=<span class="string">&quot;13&quot;</span>&gt;</span>13<span class="tag">&lt;/<span class="name">option</span>&gt;</span><span class="tag">&lt;<span class="name">option</span> <span class="attr">value</span>=<span class="string">&quot;14&quot;</span>&gt;</span>14<span class="tag">&lt;/<span class="name">option</span>&gt;</span><span class="tag">&lt;<span class="name">option</span> <span class="attr">value</span>=<span class="string">&quot;15&quot;</span>&gt;</span>15<span class="tag">&lt;/<span class="name">option</span>&gt;</span><span class="tag">&lt;<span class="name">option</span> <span class="attr">value</span>=<span class="string">&quot;16&quot;</span>&gt;</span>16<span class="tag">&lt;/<span class="name">option</span>&gt;</span><span class="tag">&lt;<span class="name">option</span> <span class="attr">value</span>=<span class="string">&quot;17&quot;</span>&gt;</span>17<span class="tag">&lt;/<span class="name">option</span>&gt;</span><span class="tag">&lt;<span class="name">option</span> <span class="attr">value</span>=<span class="string">&quot;18&quot;</span>&gt;</span>18<span class="tag">&lt;/<span class="name">option</span>&gt;</span><span class="tag">&lt;<span class="name">option</span> <span class="attr">value</span>=<span class="string">&quot;19&quot;</span>&gt;</span>19<span class="tag">&lt;/<span class="name">option</span>&gt;</span><span class="tag">&lt;<span class="name">option</span> <span class="attr">value</span>=<span class="string">&quot;20&quot;</span>&gt;</span>20<span class="tag">&lt;/<span class="name">option</span>&gt;</span><span class="tag">&lt;<span class="name">option</span> <span class="attr">value</span>=<span class="string">&quot;21&quot;</span>&gt;</span>21<span class="tag">&lt;/<span class="name">option</span>&gt;</span><span class="tag">&lt;<span class="name">option</span> <span class="attr">value</span>=<span class="string">&quot;22&quot;</span>&gt;</span>22<span class="tag">&lt;/<span class="name">option</span>&gt;</span><span class="tag">&lt;<span class="name">option</span> <span class="attr">value</span>=<span class="string">&quot;23&quot;</span>&gt;</span>23<span class="tag">&lt;/<span class="name">option</span>&gt;</span><span class="tag">&lt;<span class="name">option</span> <span class="attr">value</span>=<span class="string">&quot;24&quot;</span>&gt;</span>24<span class="tag">&lt;/<span class="name">option</span>&gt;</span><span class="tag">&lt;<span class="name">option</span> <span class="attr">value</span>=<span class="string">&quot;25&quot;</span>&gt;</span>25<span class="tag">&lt;/<span class="name">option</span>&gt;</span><span class="tag">&lt;<span class="name">option</span> <span class="attr">value</span>=<span class="string">&quot;26&quot;</span>&gt;</span>26<span class="tag">&lt;/<span class="name">option</span>&gt;</span><span class="tag">&lt;<span class="name">option</span> <span class="attr">value</span>=<span class="string">&quot;27&quot;</span>&gt;</span>27<span class="tag">&lt;/<span class="name">option</span>&gt;</span><span class="tag">&lt;<span class="name">option</span> <span class="attr">value</span>=<span class="string">&quot;28&quot;</span>&gt;</span>28<span class="tag">&lt;/<span class="name">option</span>&gt;</span><span class="tag">&lt;<span class="name">option</span> <span class="attr">value</span>=<span class="string">&quot;29&quot;</span>&gt;</span>29<span class="tag">&lt;/<span class="name">option</span>&gt;</span><span class="tag">&lt;<span class="name">option</span> <span class="attr">value</span>=<span class="string">&quot;30&quot;</span>&gt;</span>30<span class="tag">&lt;/<span class="name">option</span>&gt;</span><span class="tag">&lt;<span class="name">option</span> <span class="attr">value</span>=<span class="string">&quot;31&quot;</span>&gt;</span>31<span class="tag">&lt;/<span class="name">option</span>&gt;</span><span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">                    </span><br><span class="line">                    </span><br><span class="line">                <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">            </span><br><span class="line">                <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;uk-margin&quot;</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">label</span> <span class="attr">class</span>=<span class="string">&quot;uk-form-label&quot;</span> <span class="attr">for</span>=<span class="string">&quot;form-horizontal-text&quot;</span>&gt;</span>Favorite colors<span class="tag">&lt;/<span class="name">label</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;uk-form-controls&quot;</span>&gt;</span></span><br><span class="line">                        <span class="tag">&lt;<span class="name">ul</span> <span class="attr">id</span>=<span class="string">&quot;id_favorite_colors&quot;</span> <span class="attr">class</span>=<span class="string">&quot;uk-checkbox&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">li</span>&gt;</span><span class="tag">&lt;<span class="name">label</span> <span class="attr">for</span>=<span class="string">&quot;id_favorite_colors_0&quot;</span>&gt;</span><span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;checkbox&quot;</span> <span class="attr">name</span>=<span class="string">&quot;favorite_colors&quot;</span> <span class="attr">value</span>=<span class="string">&quot;blue&quot;</span> <span class="attr">class</span>=<span class="string">&quot;uk-checkbox&quot;</span> <span class="attr">id</span>=<span class="string">&quot;id_favorite_colors_0&quot;</span>&gt;</span></span><br><span class="line"> Blue<span class="tag">&lt;/<span class="name">label</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">li</span>&gt;</span><span class="tag">&lt;<span class="name">label</span> <span class="attr">for</span>=<span class="string">&quot;id_favorite_colors_1&quot;</span>&gt;</span><span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;checkbox&quot;</span> <span class="attr">name</span>=<span class="string">&quot;favorite_colors&quot;</span> <span class="attr">value</span>=<span class="string">&quot;green&quot;</span> <span class="attr">class</span>=<span class="string">&quot;uk-checkbox&quot;</span> <span class="attr">id</span>=<span class="string">&quot;id_favorite_colors_1&quot;</span>&gt;</span></span><br><span class="line"> Green<span class="tag">&lt;/<span class="name">label</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">li</span>&gt;</span><span class="tag">&lt;<span class="name">label</span> <span class="attr">for</span>=<span class="string">&quot;id_favorite_colors_2&quot;</span>&gt;</span><span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;checkbox&quot;</span> <span class="attr">name</span>=<span class="string">&quot;favorite_colors&quot;</span> <span class="attr">value</span>=<span class="string">&quot;black&quot;</span> <span class="attr">class</span>=<span class="string">&quot;uk-checkbox&quot;</span> <span class="attr">id</span>=<span class="string">&quot;id_favorite_colors_2&quot;</span>&gt;</span></span><br><span class="line"> Black<span class="tag">&lt;/<span class="name">label</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">ul</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">                    </span><br><span class="line">                    </span><br><span class="line">                <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">            </span><br><span class="line">                <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;uk-margin&quot;</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">label</span> <span class="attr">class</span>=<span class="string">&quot;uk-form-label&quot;</span> <span class="attr">for</span>=<span class="string">&quot;form-horizontal-text&quot;</span>&gt;</span>Gender<span class="tag">&lt;/<span class="name">label</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;uk-form-controls&quot;</span>&gt;</span></span><br><span class="line">                        <span class="tag">&lt;<span class="name">ul</span> <span class="attr">id</span>=<span class="string">&quot;id_gender&quot;</span> <span class="attr">class</span>=<span class="string">&quot;uk-radio&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">li</span>&gt;</span><span class="tag">&lt;<span class="name">label</span> <span class="attr">for</span>=<span class="string">&quot;id_gender_0&quot;</span>&gt;</span><span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;radio&quot;</span> <span class="attr">name</span>=<span class="string">&quot;gender&quot;</span> <span class="attr">value</span>=<span class="string">&quot;male&quot;</span> <span class="attr">class</span>=<span class="string">&quot;uk-radio&quot;</span> <span class="attr">required</span> <span class="attr">id</span>=<span class="string">&quot;id_gender_0&quot;</span>&gt;</span></span><br><span class="line"> 男<span class="tag">&lt;/<span class="name">label</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">li</span>&gt;</span><span class="tag">&lt;<span class="name">label</span> <span class="attr">for</span>=<span class="string">&quot;id_gender_1&quot;</span>&gt;</span><span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;radio&quot;</span> <span class="attr">name</span>=<span class="string">&quot;gender&quot;</span> <span class="attr">value</span>=<span class="string">&quot;female&quot;</span> <span class="attr">class</span>=<span class="string">&quot;uk-radio&quot;</span> <span class="attr">required</span> <span class="attr">id</span>=<span class="string">&quot;id_gender_1&quot;</span>&gt;</span></span><br><span class="line"> 女<span class="tag">&lt;/<span class="name">label</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">ul</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure><h4 id="自定义属性和错误信息"><a href="#自定义属性和错误信息" class="headerlink" title="自定义属性和错误信息"></a>自定义属性和错误信息</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> django <span class="keyword">import</span> forms</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">LoginForm</span>(<span class="params">forms.Form</span>):</span>  </span><br><span class="line">    username = forms.CharField(</span><br><span class="line">        required=<span class="literal">True</span>,</span><br><span class="line">        max_length=<span class="number">20</span>,</span><br><span class="line">        min_length=<span class="number">6</span>,</span><br><span class="line">        error_messages=&#123;</span><br><span class="line">            <span class="string">&#x27;required&#x27;</span>: <span class="string">&#x27;用户名不能为空&#x27;</span>,</span><br><span class="line">            <span class="string">&#x27;max_length&#x27;</span>: <span class="string">&#x27;用户名长度不得超过20个字符&#x27;</span>,</span><br><span class="line">            <span class="string">&#x27;min_length&#x27;</span>: <span class="string">&#x27;用户名长度不得少于6个字符&#x27;</span>,</span><br><span class="line">        &#125;</span><br><span class="line">    )</span><br><span class="line">    password = forms.CharField(</span><br><span class="line">        required=<span class="literal">True</span>,</span><br><span class="line">        max_length=<span class="number">20</span>,</span><br><span class="line">        min_length=<span class="number">6</span>,</span><br><span class="line">        error_messages=&#123;</span><br><span class="line">            <span class="string">&#x27;required&#x27;</span>: <span class="string">&#x27;密码不能为空&#x27;</span>,</span><br><span class="line">            <span class="string">&#x27;max_length&#x27;</span>: <span class="string">&#x27;密码长度不得超过20个字符&#x27;</span>,</span><br><span class="line">            <span class="string">&#x27;min_length&#x27;</span>: <span class="string">&#x27;密码长度不得少于6个字符&#x27;</span>,</span><br><span class="line">        &#125;</span><br><span class="line">    )</span><br></pre></td></tr></table></figure><h4 id="表单数据初始化"><a href="#表单数据初始化" class="headerlink" title="表单数据初始化**"></a>表单数据初始化**</h4><p>有时我们需要对表单设置一些初始数据，我们可以通过initial方法，如下所示。</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">index</span>(<span class="params">request</span>):</span></span><br><span class="line">    <span class="comment"># 实例化自定义表单</span></span><br><span class="line">    form = StudentForm(initial=&#123;</span><br><span class="line">        <span class="string">&#x27;name&#x27;</span>:<span class="string">&#x27;默认叫张三吧&#x27;</span></span><br><span class="line">    &#125;)</span><br></pre></td></tr></table></figure><p>渲染结果：</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">textarea</span> <span class="attr">name</span>=<span class="string">&quot;name&quot;</span> <span class="attr">cols</span>=<span class="string">&quot;40&quot;</span> <span class="attr">rows</span>=<span class="string">&quot;10&quot;</span> <span class="attr">class</span>=<span class="string">&quot;uk-textarea&quot;</span> <span class="attr">required</span> <span class="attr">id</span>=<span class="string">&quot;id_name&quot;</span>&gt;</span></span><br><span class="line">默认叫张三吧<span class="tag">&lt;/<span class="name">textarea</span>&gt;</span></span><br></pre></td></tr></table></figure><h3 id="模型表单"><a href="#模型表单" class="headerlink" title="模型表单"></a>模型表单</h3><p>自定义表单时我们简单提了一下模型表单，跟自定义表单最大的区别就是定义表单的部分，视图及模板没有任何改变。</p><h4 id="定义模型表单"><a href="#定义模型表单" class="headerlink" title="定义模型表单"></a>定义模型表单</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> django <span class="keyword">import</span> forms</span><br><span class="line"><span class="keyword">from</span> .models <span class="keyword">import</span> Student</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">StudentForm</span>(<span class="params">forms.ModelForm</span>):</span></span><br><span class="line">    <span class="class"><span class="keyword">class</span> <span class="title">Meta</span>:</span></span><br><span class="line">        <span class="comment"># 绑定的模型</span></span><br><span class="line">        model = Student</span><br><span class="line">        <span class="comment"># 要显示的字段</span></span><br><span class="line">        fields = (<span class="string">&#x27;name&#x27;</span>, <span class="string">&#x27;age&#x27;</span>, <span class="string">&#x27;score&#x27;</span>, <span class="string">&#x27;classes&#x27;</span>)</span><br><span class="line">        widgets = &#123;</span><br><span class="line">            <span class="string">&#x27;name&#x27;</span>:forms.TextInput(attrs=&#123;</span><br><span class="line">                <span class="string">&#x27;class&#x27;</span>:<span class="string">&#x27;你好&#x27;</span></span><br><span class="line">            &#125;)</span><br><span class="line">        &#125;</span><br><span class="line">        error_messages = &#123;</span><br><span class="line">            <span class="string">&#x27;name&#x27;</span>:&#123;</span><br><span class="line">                <span class="string">&#x27;max_length&#x27;</span>:<span class="string">&#x27;太长了&#x27;</span></span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br></pre></td></tr></table></figure><p>视图和模板我们不做任何改变，正常渲染结果</p><p><img data-src="https://20200324picgo-1251846158.cos.ap-shanghai.myqcloud.com/img/20200424143202.png" alt="img"></p><h4 id="Meta选项"><a href="#Meta选项" class="headerlink" title="Meta选项"></a>Meta选项</h4><p>我们 在class Meta 中使用了一些元数据项，比如说 exclude、labels 以及 fields，当然还有些其他的选项，在 Django 官方网站 ModelForm 的定义如下所示</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">fields_for_model</span>(<span class="params">model, fields=None, exclude=None, widgets=None,</span></span></span><br><span class="line"><span class="function"><span class="params">                     formfield_callback=None, localized_fields=None,</span></span></span><br><span class="line"><span class="function"><span class="params">                     labels=None, help_texts=None, error_messages=None,</span></span></span><br><span class="line"><span class="function"><span class="params">                     field_classes=None, *, apply_limit_choices_to=True</span>):</span></span><br></pre></td></tr></table></figure><h5 id="1-fields"><a href="#1-fields" class="headerlink" title="1) fields"></a>1) fields</h5><p>其为列表或元组类型，与 exclude 相反，它指定当前的表单应该包含哪些字段，如果要所有的 Model 字段都包含在表单中，可以设定 fields=’<strong>all</strong>‘。ModelForm 的定义中必须要包含 fields 或 exclude 选项，否则将会抛出异常，同时给出错误提示：</p><blockquote><p>Creating a ModelForm without either the’fields’attribute or the’exclude’attribute is prohibited。</p></blockquote><h5 id="2-labels"><a href="#2-labels" class="headerlink" title="2) labels"></a>2) labels</h5><p>其为字典类型，用于定义表单字段的名称（输入框左边显示的名称）。表单字段的名称首先会使用 Model 字段定义设置的 verbose_name，如果没有设置，则直接使用字段名。因此当没有定义 verbo se_name 时，就可以使用 labels 选项来指定字段名。例如：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">labels=&#123;<span class="string">&#x27;title&#x27;</span>：<span class="string">&#x27;标题&#x27;</span>, <span class="string">&#x27;price&#x27;</span>:<span class="string">&#x27;价格&#x27;</span>&#125;</span><br></pre></td></tr></table></figure><h5 id="3-help-texts"><a href="#3-help-texts" class="headerlink" title="3) help_texts"></a>3) help_texts</h5><p>其为字典类型，用于给表单字段添加帮助信息。目前页面中表单字段的帮助信息（输入框下方显示的内容）来自 Model字段的 help_texts 定义，如果没有定义则什么都不显示。help_texts 的定义方式与 labels 选项类似，例如：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">help_texts=&#123;<span class="string">&quot;title&quot;</span>:<span class="string">&quot;书籍的名称&quot;</span>, <span class="string">&quot;price&#x27;:&quot;</span>书籍价格<span class="string">&quot;&#125;</span></span><br></pre></td></tr></table></figure><h5 id="4-widgets"><a href="#4-widgets" class="headerlink" title="4) widgets"></a>4) widgets</h5><p>其为字典类型，用于定义表单字段选用的控件。默认情况下，ModelForm 会根据Model字段的类型映射表单 Field 类，因此会应用 Field 类中默认定义的 widgets。这个选项用于自定义控件类型，例如：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">widgets = &#123;</span><br><span class="line">            <span class="string">&#x27;type&#x27;</span>: forms.SelectMultiple(attrs=&#123;</span><br><span class="line">                <span class="string">&#x27;class&#x27;</span>: <span class="string">&#x27;form-control&#x27;</span></span><br><span class="line">            &#125;)</span><br><span class="line">        &#125;</span><br></pre></td></tr></table></figure><h5 id="5-field-classes"><a href="#5-field-classes" class="headerlink" title="5) field_classes"></a>5) field_classes</h5><p>字典类型，用于指定表单字段使用的 Field 类型。默认情况下，对于 title 字段，ModelForm 会将它映射为 fields.CharField 类型。可以根据需要改变这种默认行为，例如，将 title 设置为如下类型：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">field_calss=&#123;<span class="string">&quot;title&quot;</span>:forms.URLField&#125;</span><br></pre></td></tr></table></figure><h5 id="6-error-messages"><a href="#6-error-messages" class="headerlink" title="6) error_messages"></a>6) error_messages</h5><p>字典类型，用来指定表单字段校验规则，即验证失败时的报错信息。</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">error_messages = &#123;</span><br><span class="line">            <span class="string">&#x27;type&#x27;</span>: &#123;</span><br><span class="line">                <span class="string">&#x27;required&#x27;</span>: <span class="string">&#x27;移民类型至少选一个&#x27;</span></span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br></pre></td></tr></table></figure><h4 id="表单数据初始化-1"><a href="#表单数据初始化-1" class="headerlink" title="表单数据初始化"></a>表单数据初始化</h4><p>除了跟自定义表单中视图示例初始化使用<code>initial</code>外，我们还可以初始化一个学员对象，比如我们编辑的时候就经常会显示原来数据。</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> django.shortcuts <span class="keyword">import</span> render, HttpResponse</span><br><span class="line"><span class="keyword">from</span> .forms <span class="keyword">import</span> StudentForm</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">index</span>(<span class="params">request</span>):</span></span><br><span class="line">    stu_obj = Student.objects.first()</span><br><span class="line">    <span class="comment"># 实例化自定义表单</span></span><br><span class="line">    form = StudentForm(instance=stu_obj)</span><br><span class="line">    <span class="keyword">return</span> render(request, <span class="string">&#x27;index.html&#x27;</span>, &#123;<span class="string">&#x27;form&#x27;</span>:form&#125;)</span><br></pre></td></tr></table></figure><p>模板渲染结果：</p><p><img data-src="https://20200324picgo-1251846158.cos.ap-shanghai.myqcloud.com/img/20200424143834.png" alt="img"></p><h3 id="FormSet"><a href="#FormSet" class="headerlink" title="FormSet"></a><code>FormSet</code></h3><p><code>Formset</code>(表单集)是多个表单的集合。<code>Formset</code>在<code>Web</code>开发中应用很普遍，它可以让用户在同一个页面上提交多张表单，一键添加多个数据，比如一个页面上添加多个学员。</p><h4 id="Formset的分类"><a href="#Formset的分类" class="headerlink" title="Formset的分类"></a><strong><code>Formset</code>的分类</strong></h4><p><code>Django</code>针对不同的<code>formset</code>提供了3种方法: <code>formset_factory</code>, <code>modelformset_factory</code>和<code>inlineformset_factory</code>。我们接下来分别看下如何使用它们。</p><h5 id="formset-factory"><a href="#formset-factory" class="headerlink" title="formset_factory"></a><code>formset_factory</code></h5><p>对于继承<code>forms.Form</code>的自定义表单，我们可以使用<code>formset_factory</code>。我们可以通过设置<code>extra</code>和<code>max_num</code>属性来确定我们想要展示的表单数量。注意: <code>max_num</code>优先级高于<code>extra</code>。比如下例中，我们想要显示3个空表单(extra=3)，但最后只会显示2个空表单，因为<code>max_num=2</code>。</p><p><code>forms.py</code>自定义表单文件：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> django <span class="keyword">import</span> forms</span><br><span class="line"><span class="keyword">from</span> .models <span class="keyword">import</span> Student</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">StudentForm</span>(<span class="params">forms.ModelForm</span>):</span></span><br><span class="line">    <span class="class"><span class="keyword">class</span> <span class="title">Meta</span>:</span></span><br><span class="line">        model = Student</span><br><span class="line">        fields = (<span class="string">&#x27;name&#x27;</span>,)</span><br><span class="line">        widgets = &#123;</span><br><span class="line">            <span class="string">&#x27;name&#x27;</span>:forms.TextInput(attrs=&#123;</span><br><span class="line">                <span class="string">&#x27;class&#x27;</span>:<span class="string">&#x27;你好&#x27;</span></span><br><span class="line">            &#125;)</span><br><span class="line">        &#125;</span><br><span class="line">        error_messages = &#123;</span><br><span class="line">            <span class="string">&#x27;name&#x27;</span>:&#123;</span><br><span class="line">                <span class="string">&#x27;max_length&#x27;</span>:<span class="string">&#x27;太长了&#x27;</span></span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line"><span class="comment"># extra: 额外的空表单数量</span></span><br><span class="line"><span class="comment"># max_num: 包含表单数量（不含空表单)</span></span><br><span class="line">StudentFormSet = forms.formset_factory(</span><br><span class="line">    form=StudentForm,</span><br><span class="line">    extra=<span class="number">3</span>,</span><br><span class="line">    max_num=<span class="number">2</span></span><br><span class="line">)</span><br></pre></td></tr></table></figure><p>view视图文件：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> django.shortcuts <span class="keyword">import</span> render, HttpResponse</span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> .models <span class="keyword">import</span> Student</span><br><span class="line"><span class="keyword">from</span> .forms <span class="keyword">import</span> StudentFormSet</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">index</span>(<span class="params">request</span>):</span></span><br><span class="line">    formset = StudentFormSet()</span><br><span class="line">    <span class="keyword">if</span> request.method == <span class="string">&#x27;POST&#x27;</span>:</span><br><span class="line">        formset = StudentFormSet(request.POST)</span><br><span class="line">        <span class="comment"># 判断表单验证是否通过</span></span><br><span class="line">        <span class="keyword">if</span> formset.is_valid():</span><br><span class="line">            <span class="comment"># 循环每个form数据</span></span><br><span class="line">            <span class="keyword">for</span> form_data <span class="keyword">in</span> formset.cleaned_data:</span><br><span class="line">                <span class="comment"># 依次打散添加至数据库</span></span><br><span class="line">                Student.objects.create(**form_data)</span><br><span class="line">            <span class="keyword">return</span> HttpResponse(<span class="string">&#x27;都添加成功了&#x27;</span>)</span><br><span class="line">        <span class="keyword">return</span> render(request, <span class="string">&#x27;index.html&#x27;</span>, &#123;<span class="string">&#x27;formset&#x27;</span>:formset&#125;)</span><br><span class="line">    <span class="comment"># formset传给前端做渲染</span></span><br><span class="line">    <span class="keyword">return</span> render(request, <span class="string">&#x27;index.html&#x27;</span>, &#123;<span class="string">&#x27;formset&#x27;</span>:formset&#125;)</span><br></pre></td></tr></table></figure><p>template模板文件：</p><p>方式一：</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">&#123;% extends &#x27;layout.html&#x27; %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% block main %&#125;</span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;uk-container&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">form</span> <span class="attr">action</span>=<span class="string">&quot;&#123;% url &#x27;wechat:index&#x27; %&#125;&quot;</span> <span class="attr">method</span>=<span class="string">&quot;post&quot;</span> <span class="attr">novalidate</span>&gt;</span></span><br><span class="line">            &#123;&#123; formset.management_form &#125;&#125;</span><br><span class="line">            &#123;% csrf_token %&#125;</span><br><span class="line">            &#123;&#123; formset &#125;&#125;</span><br><span class="line">            <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;uk-margin&quot;</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">button</span> <span class="attr">class</span>=<span class="string">&quot;uk-button uk-button-primary &quot;</span> <span class="attr">type</span>=<span class="string">&quot;submit&quot;</span>&gt;</span>提交<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">form</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">&#123;% endblock %&#125;</span><br></pre></td></tr></table></figure><p>方式二：</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">&#123;% extends &#x27;layout.html&#x27; %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% block main %&#125;</span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;uk-container&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">form</span> <span class="attr">action</span>=<span class="string">&quot;&#123;% url &#x27;wechat:index&#x27; %&#125;&quot;</span> <span class="attr">method</span>=<span class="string">&quot;post&quot;</span> <span class="attr">novalidate</span>&gt;</span></span><br><span class="line">            &#123;&#123; formset.management_form &#125;&#125;</span><br><span class="line">            &#123;% csrf_token %&#125;</span><br><span class="line">            &#123;% for form in formset %&#125;</span><br><span class="line">               &#123;&#123; form &#125;&#125;</span><br><span class="line">                <span class="tag">&lt;<span class="name">hr</span>&gt;</span></span><br><span class="line">            &#123;% endfor %&#125;</span><br><span class="line">            <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;uk-margin&quot;</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">button</span> <span class="attr">class</span>=<span class="string">&quot;uk-button uk-button-primary &quot;</span> <span class="attr">type</span>=<span class="string">&quot;submit&quot;</span>&gt;</span>提交<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">form</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">&#123;% endblock %&#125;</span><br></pre></td></tr></table></figure><p>方式三：</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line">&#123;% extends &#x27;layout.html&#x27; %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% block main %&#125;</span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;uk-container&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">form</span> <span class="attr">action</span>=<span class="string">&quot;&#123;% url &#x27;wechat:index&#x27; %&#125;&quot;</span> <span class="attr">method</span>=<span class="string">&quot;post&quot;</span> <span class="attr">novalidate</span>&gt;</span></span><br><span class="line">            &#123;&#123; formset.management_form &#125;&#125;</span><br><span class="line">            &#123;% csrf_token %&#125;</span><br><span class="line">            &#123;% for form in formset %&#125;</span><br><span class="line"></span><br><span class="line">                &#123;% for field in form %&#125;</span><br><span class="line">                    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;uk-margin&quot;</span>&gt;</span></span><br><span class="line">                        <span class="tag">&lt;<span class="name">label</span> <span class="attr">class</span>=<span class="string">&quot;uk-form-label&quot;</span> <span class="attr">for</span>=<span class="string">&quot;form-horizontal-text&quot;</span>&gt;</span>&#123;&#123; field.label &#125;&#125;<span class="tag">&lt;/<span class="name">label</span>&gt;</span></span><br><span class="line">                        <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;uk-form-controls&quot;</span>&gt;</span></span><br><span class="line">                            &#123;&#123; field &#125;&#125;</span><br><span class="line">                        <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">                        &#123;% if field.help_text %&#125;</span><br><span class="line">                            <span class="tag">&lt;<span class="name">p</span> <span class="attr">class</span>=<span class="string">&quot;help&quot;</span>&gt;</span>&#123;&#123; field.help_text|safe &#125;&#125;<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">                        &#123;% endif %&#125;</span><br><span class="line">                        &#123;&#123; field.errors &#125;&#125;</span><br><span class="line">                    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">                &#123;% endfor %&#125;</span><br><span class="line">                <span class="tag">&lt;<span class="name">hr</span>&gt;</span></span><br><span class="line">            &#123;% endfor %&#125;</span><br><span class="line">            <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;uk-margin&quot;</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">button</span> <span class="attr">class</span>=<span class="string">&quot;uk-button uk-button-primary &quot;</span> <span class="attr">type</span>=<span class="string">&quot;submit&quot;</span>&gt;</span>提交<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">form</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">&#123;% endblock %&#125;</span><br></pre></td></tr></table></figure><p>提交后的渲染结果：</p><p><img data-src="https://20200324picgo-1251846158.cos.ap-shanghai.myqcloud.com/img/20200426104924.png" alt="img"></p><h5 id="modelformset-factory"><a href="#modelformset-factory" class="headerlink" title="modelformset_factory"></a><code>modelformset_factory</code></h5><p><code>Formset</code>也可以直接由模型<code>model</code>创建，这时你需要使用<code>modelformset_factory</code>。你可以指定需要显示的字段和表单数量。</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> django <span class="keyword">import</span> forms</span><br><span class="line"><span class="keyword">from</span> .models <span class="keyword">import</span> Student</span><br><span class="line"></span><br><span class="line">StudentFormSet = forms.modelformset_factory(</span><br><span class="line">    model=Student,</span><br><span class="line">    fields=(<span class="string">&#x27;name&#x27;</span>, <span class="string">&#x27;age&#x27;</span>),</span><br><span class="line">    extra=<span class="number">3</span>,</span><br><span class="line">    max_num=<span class="number">2</span></span><br><span class="line">)</span><br></pre></td></tr></table></figure><p>当然上面方法并不推荐，因为对单个表单添加验证方法非常不方便。我更喜欢的方式先创建自定义的<code>ModelForm</code>，添加单个表单验证，然后再利用<code>modelformset_factory</code>创建<code>formset</code>。</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> django <span class="keyword">import</span> forms</span><br><span class="line"><span class="keyword">from</span> .models <span class="keyword">import</span> Student</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">StudentForm</span>(<span class="params">forms.ModelForm</span>):</span></span><br><span class="line">    <span class="class"><span class="keyword">class</span> <span class="title">Meta</span>:</span></span><br><span class="line">        model = Student</span><br><span class="line">        fields = (<span class="string">&#x27;name&#x27;</span>,)</span><br><span class="line">        widgets = &#123;</span><br><span class="line">            <span class="string">&#x27;name&#x27;</span>:forms.TextInput(attrs=&#123;</span><br><span class="line">                <span class="string">&#x27;class&#x27;</span>:<span class="string">&#x27;你好&#x27;</span></span><br><span class="line">            &#125;)</span><br><span class="line">        &#125;</span><br><span class="line">        error_messages = &#123;</span><br><span class="line">            <span class="string">&#x27;name&#x27;</span>:&#123;</span><br><span class="line">                <span class="string">&#x27;max_length&#x27;</span>:<span class="string">&#x27;太长了&#x27;</span></span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line"><span class="comment"># extra: 额外的空表单数量</span></span><br><span class="line"><span class="comment"># max_num: 包含表单数量（不含空表单)</span></span><br><span class="line">StudentFormSet = forms.modelformset_factory(</span><br><span class="line">    model=Student,</span><br><span class="line">  	form = StudentForm,</span><br><span class="line">    extra=<span class="number">3</span>,</span><br><span class="line">    max_num=<span class="number">2</span></span><br><span class="line">)</span><br></pre></td></tr></table></figure><h5 id="inlineformset-factory"><a href="#inlineformset-factory" class="headerlink" title="inlineformset_factory"></a><code>inlineformset_factory</code></h5><p>试想我们有如下<code>province</code>模型，<code>province</code>与<code>city</code>是单对多的关系。一般的<code>formset</code>只允许我们一次性提交多个<code>province</code>或多个<code>city</code>。但如果我们希望同一个页面上添加一个省份(<code>province</code>)和多个城市(<code>city</code>)，这时我们就需要用使用<code>inlineformset</code>了。</p><h6 id="模型models-py"><a href="#模型models-py" class="headerlink" title="模型models.py"></a>模型<code>models.py</code></h6><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Province</span>(<span class="params">models.Model</span>):</span></span><br><span class="line">    id = models.AutoField(primary_key = <span class="literal">True</span>)</span><br><span class="line">    name = models.CharField(max_length=<span class="number">10</span>, verbose_name=<span class="string">&#x27;省份&#x27;</span>)</span><br><span class="line">    desc = models.CharField(max_length=<span class="number">255</span>, verbose_name=<span class="string">&#x27;介绍&#x27;</span>)</span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__str__</span>(<span class="params">self</span>):</span></span><br><span class="line">        <span class="keyword">return</span> self.name</span><br><span class="line">    <span class="class"><span class="keyword">class</span> <span class="title">Meta</span>:</span></span><br><span class="line">        verbose_name = <span class="string">&#x27;省份&#x27;</span></span><br><span class="line">        verbose_name_plural = verbose_name</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">City</span>(<span class="params">models.Model</span>):</span></span><br><span class="line">    id = models.AutoField(primary_key = <span class="literal">True</span>)</span><br><span class="line">    name = models.CharField(max_length=<span class="number">20</span>, verbose_name=<span class="string">&#x27;城市&#x27;</span>)</span><br><span class="line">    desc = models.CharField(max_length=<span class="number">255</span>, verbose_name=<span class="string">&#x27;介绍&#x27;</span>)</span><br><span class="line">    province = models.ForeignKey(to=Province, verbose_name=<span class="string">&#x27;省份&#x27;</span>, on_delete=models.CASCADE)</span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__str__</span>(<span class="params">self</span>):</span></span><br><span class="line">        <span class="keyword">return</span> self.name</span><br><span class="line">    <span class="class"><span class="keyword">class</span> <span class="title">Meta</span>:</span></span><br><span class="line">        verbose_name = <span class="string">&#x27;城市&#x27;</span></span><br><span class="line">        verbose_name_plural = verbose_name</span><br></pre></td></tr></table></figure><h6 id="自定义表单form-py"><a href="#自定义表单form-py" class="headerlink" title="自定义表单form.py"></a>自定义表单<code>form.py</code></h6><p>利用<code>inlineformset_factory</code>创建<code>formset</code>的方法如下所示。该方法的第一个参数和第二个参数都是模型，其中第一个参数必需是<code>ForeignKey</code>。</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> django <span class="keyword">import</span> forms</span><br><span class="line"><span class="keyword">from</span> .models <span class="keyword">import</span> Province</span><br><span class="line"><span class="keyword">from</span> .models <span class="keyword">import</span> City</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">ProvinceForm</span>(<span class="params">forms.ModelForm</span>):</span></span><br><span class="line">    <span class="class"><span class="keyword">class</span> <span class="title">Meta</span>:</span></span><br><span class="line">        model = Province</span><br><span class="line">        fields = (<span class="string">&#x27;name&#x27;</span>, <span class="string">&#x27;desc&#x27;</span>)</span><br><span class="line">        widgets = &#123;</span><br><span class="line">            <span class="string">&#x27;name&#x27;</span>:forms.TextInput(attrs=&#123;</span><br><span class="line">                <span class="string">&#x27;class&#x27;</span>:<span class="string">&#x27;你好&#x27;</span></span><br><span class="line">            &#125;)</span><br><span class="line">        &#125;</span><br><span class="line">        error_messages = &#123;</span><br><span class="line">            <span class="string">&#x27;name&#x27;</span>:&#123;</span><br><span class="line">                <span class="string">&#x27;max_length&#x27;</span>:<span class="string">&#x27;太长了&#x27;</span></span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">CityFormSet = forms.inlineformset_factory(</span><br><span class="line">    parent_model=Province,</span><br><span class="line">    model=City,</span><br><span class="line">    fields=(<span class="string">&#x27;name&#x27;</span>, ),</span><br><span class="line">    extra=<span class="number">3</span>,</span><br><span class="line">    max_num=<span class="number">2</span>,</span><br><span class="line">    can_delete=<span class="literal">False</span></span><br><span class="line">)</span><br></pre></td></tr></table></figure><h6 id="视图views-py"><a href="#视图views-py" class="headerlink" title="视图views.py"></a>视图<code>views.py</code></h6><p><code>views.py</code>中使用<code>formset</code>创建和更新<code>province</code>的代码如下。在对<code>IngredientFormSet</code>进行实例化的时候，必需指定province的实例。</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> django.shortcuts <span class="keyword">import</span> render, HttpResponse</span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> .models <span class="keyword">import</span> Province</span><br><span class="line"><span class="keyword">from</span> .models <span class="keyword">import</span> City</span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> .forms <span class="keyword">import</span> ProvinceForm</span><br><span class="line"><span class="keyword">from</span> .forms <span class="keyword">import</span> CityFormSet</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">index</span>(<span class="params">request</span>):</span></span><br><span class="line">    form = ProvinceForm()</span><br><span class="line">    city_formset = CityFormSet()</span><br><span class="line">    <span class="keyword">if</span> request.method == <span class="string">&#x27;POST&#x27;</span>:</span><br><span class="line">        form = ProvinceForm(request.POST)</span><br><span class="line">        <span class="comment"># 判断省份验证是否通过</span></span><br><span class="line">        <span class="keyword">if</span> form.is_valid():</span><br><span class="line">            <span class="comment"># 保存提交的省份数据，返回添加的省份对象</span></span><br><span class="line">            province = form.save()</span><br><span class="line">            city_formset = CityFormSet(request.POST, instance = province)</span><br><span class="line">            <span class="comment"># 判断城市验证是否通过</span></span><br><span class="line">            <span class="keyword">if</span> city_formset.is_valid():</span><br><span class="line">                <span class="comment"># 保存城市</span></span><br><span class="line">                city_formset.save()</span><br><span class="line">        <span class="keyword">return</span> render(request, <span class="string">&#x27;index.html&#x27;</span>, &#123;<span class="string">&#x27;form&#x27;</span>:form, <span class="string">&#x27;city_formset&#x27;</span>:city_formset&#125;)</span><br><span class="line">    <span class="comment"># form传给前端做渲染</span></span><br><span class="line">    <span class="keyword">return</span> render(request, <span class="string">&#x27;index.html&#x27;</span>, &#123;<span class="string">&#x27;form&#x27;</span>:form, <span class="string">&#x27;city_formset&#x27;</span>:city_formset&#125;)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">update</span>(<span class="params">request</span>):</span></span><br><span class="line">    <span class="comment"># 取出pk等于3的省份对象</span></span><br><span class="line">    province_obj = Province.objects.get(pk=<span class="number">3</span>)</span><br><span class="line">    <span class="comment"># 实例化自定义表单和formset，指定示例</span></span><br><span class="line">    form = ProvinceForm(instance=province_obj)</span><br><span class="line">    city_formset = CityFormSet(instance=province_obj)</span><br><span class="line">    <span class="keyword">if</span> request.method == <span class="string">&#x27;POST&#x27;</span>:</span><br><span class="line">        form = ProvinceForm(request.POST, instance=province_obj)</span><br><span class="line">        <span class="comment"># 判断省份验证是否通过</span></span><br><span class="line">        <span class="keyword">if</span> form.is_valid():</span><br><span class="line">            <span class="comment"># 保存提交的省份数据，返回添加的省份对象</span></span><br><span class="line">            province = form.save()</span><br><span class="line">            city_formset = CityFormSet(request.POST, instance = province)</span><br><span class="line">            <span class="comment"># 判断城市验证是否通过</span></span><br><span class="line">            <span class="keyword">if</span> city_formset.is_valid():</span><br><span class="line">                <span class="comment"># 保存城市</span></span><br><span class="line">                city_formset.save()</span><br><span class="line">        <span class="keyword">return</span> render(request, <span class="string">&#x27;index.html&#x27;</span>, &#123;<span class="string">&#x27;form&#x27;</span>:form, <span class="string">&#x27;city_formset&#x27;</span>:city_formset&#125;)</span><br><span class="line">    <span class="comment"># form传给前端做渲染</span></span><br><span class="line">    <span class="keyword">return</span> render(request, <span class="string">&#x27;index.html&#x27;</span>, &#123;<span class="string">&#x27;form&#x27;</span>:form, <span class="string">&#x27;city_formset&#x27;</span>:city_formset&#125;)</span><br></pre></td></tr></table></figure><h6 id="模板templates"><a href="#模板templates" class="headerlink" title="模板templates"></a>模板templates</h6><p><code>action</code>添加和更新请修改<code>url</code>路由</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">&#123;% extends <span class="string">&#x27;layout.html&#x27;</span> %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% block main %&#125;</span><br><span class="line">    &lt;div class=&quot;uk-container&quot;&gt;</span><br><span class="line">        &lt;form action=<span class="string">&quot;&#123;% url &#x27;wechat:index&#x27; %&#125;&quot;</span> method=<span class="string">&quot;post&quot;</span> novalidate&gt;</span><br><span class="line">            &#123;% csrf_token %&#125;</span><br><span class="line">           &#123;&#123; form.as_p &#125;&#125;</span><br><span class="line">            &lt;hr&gt;</span><br><span class="line">            &lt;legend&gt;添加城市&lt;/legend&gt;</span><br><span class="line">            &#123;&#123; city_formset.management_form &#125;&#125;</span><br><span class="line">            &#123;&#123; city_formset.non_form_errors &#125;&#125;</span><br><span class="line">            &#123;% <span class="keyword">for</span> city_form <span class="keyword">in</span> city_formset %&#125;</span><br><span class="line">                &#123;&#123; city_form &#125;&#125;</span><br><span class="line">                &lt;hr&gt;</span><br><span class="line">            &#123;% endfor %&#125;</span><br><span class="line">            &lt;div class=&quot;uk-margin&quot;&gt;</span><br><span class="line">                &lt;button class=&quot;uk-button uk-button-primary &quot; type=&quot;submit&quot;&gt;提交&lt;/button&gt;</span><br><span class="line">            &lt;/div&gt;</span><br><span class="line">        &lt;/form&gt;</span><br><span class="line">    &lt;/div&gt;</span><br><span class="line">&#123;% endblock %&#125;</span><br></pre></td></tr></table></figure><p>渲染效果：</p><p><img data-src="https://20200324picgo-1251846158.cos.ap-shanghai.myqcloud.com/img/20200426134329.png" alt="img"></p></div><footer class="post-footer"><div class="reward-container"><div>打赏个鸡腿</div><button onclick='document.querySelector(".post-reward").classList.toggle("active")'>赞赏</button><div class="post-reward"><div><img src="/images/wechatpay.jpg" alt="托小尼 微信"> <span>微信</span></div><div><img src="/images/alipay.jpg" alt="托小尼 支付宝"> <span>支付宝</span></div></div></div><div class="post-tags"><a href="/tags/Django%E4%B9%8Bforms%E7%BB%84%E4%BB%B6/" rel="tag"><i class="fa fa-tag"></i> Django之forms组件</a> <a href="/tags/forms/" rel="tag"><i class="fa fa-tag"></i> forms</a> <a href="/tags/forms%E7%BB%84%E4%BB%B6/" rel="tag"><i class="fa fa-tag"></i> forms组件</a> <a href="/tags/formset/" rel="tag"><i class="fa fa-tag"></i> formset</a> <a href="/tags/forms-Form/" rel="tag"><i class="fa fa-tag"></i> forms.Form</a> <a href="/tags/forms-ModelForm/" rel="tag"><i class="fa fa-tag"></i> forms.ModelForm</a></div><div class="post-nav"><div class="post-nav-item"><a href="/10a5db73.html" rel="prev" title="Django之分页器组件"><i class="fa fa-chevron-left"></i> Django之分页器组件</a></div><div class="post-nav-item"><a href="/41d3eaa2.html" rel="next" title="Django之cookie与session组件">Django之cookie与session组件 <i class="fa fa-chevron-right"></i></a></div></div></footer></article><div class="comments"><div id="SOHUCS"></div></div><script>window.addEventListener('tabs:register', () => {
    let { activeClass } = CONFIG.comments;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      const activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      const commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }</script></div></main><footer class="footer"><div class="footer-inner"><div class="beian"><span class="exturl" data-url="aHR0cHM6Ly9iZWlhbi5taWl0Lmdvdi5jbg==">豫ICP备17028303号-1 </span><img src="http://www.beian.gov.cn/portal/download" style="display:inline-block"><span class="exturl" data-url="aHR0cDovL3d3dy5iZWlhbi5nb3YuY24vcG9ydGFsL3JlZ2lzdGVyU3lzdGVtSW5mbz9yZWNvcmRjb2RlPTE3MDI4MzAz">豫公网安备 41102402000095号</span></div><div class="copyright">&copy; <span itemprop="copyrightYear">2020</span> <span class="with-love"><i class="fa fa-user"></i> </span><span class="author" itemprop="copyrightHolder">Tony Yu</span></div><div class="wordcount"><span class="post-meta-item"><span class="post-meta-item-icon"><i class="fa fa-chart-line"></i> </span><span title="站点总字数">1.2m</span> </span><span class="post-meta-item"><span class="post-meta-item-icon"><i class="fa fa-coffee"></i> </span><span title="站点阅读时长">17:43</span></span></div></div></footer><script src="//cdn.jsdelivr.net/npm/animejs@3.2.0/lib/anime.min.js"></script><script src="//cdn.jsdelivr.net/npm/medium-zoom@1.0.6/dist/medium-zoom.min.js"></script><script src="//cdn.jsdelivr.net/npm/lozad@1.15.0/dist/lozad.min.js"></script><script src="/js/utils.js"></script><script src="/js/motion.js"></script><script src="/js/next-boot.js"></script><script src="/js/local-search.js"></script><script>NexT.utils.loadComments('#SOHUCS', () => {
    NexT.utils.getScript('https://changyan.sohu.com/upload/changyan.js', () => {
      window.changyan.api.config({
        appid: 'cyu11Umgd',
        conf : '0f296687f6a61e82028fd7c6ddf32ab9'
      });
    });
  });</script><script src="https://assets.changyan.sohu.com/upload/plugins/plugins.count.js"></script></body></html>